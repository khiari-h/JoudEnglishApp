# Test E2E : Parcours utilisateur principal
# Couvre : Dashboard ‚Üí Level ‚Üí Exercise ‚Üí Vocabulary Exercise ‚Üí Mise √† jour des m√©triques

appId: com.joudenglish.app
name: "Parcours utilisateur principal - Vocabulaire"
tags:
  - "user-journey"
  - "vocabulary"
  - "progress-update"

# Configuration globale
env:
  TIMEOUT: 10000
  RETRY_COUNT: 3

# Test principal
---
- runFlow:
    when:
      true: ${ENV:TEST_TYPE == "full" || !ENV:TEST_TYPE}
    commands:
      # =================== PHASE 1: DASHBOARD INITIAL ===================
      - launchApp
      - assertVisible: "Accueil" # V√©rifier qu'on est sur le dashboard
      
      # V√©rifier les composants du dashboard
      - assertVisible: "üìä Aujourd'hui" # SimpleMetrics
      - assertVisible: "‚ö° Actions rapides" # QuickActions
      - assertVisible: "üèÜ Progression g√©n√©rale" # LearningProgress
      
      # Capturer les m√©triques initiales
      - tapOn: "üìö Mots aujourd'hui"
      - assertVisible: "0" # ou la valeur actuelle
      
      # =================== PHASE 2: NAVIGATION VERS NIVEAU ===================
      - tapOn: "Niveaux" # Onglet footer
      - assertVisible: "Niveaux"
      - assertVisible: "Choisissez votre niveau"
      
      # S√©lectionner le niveau 1
      - tapOn: "level-1-button"
      - assertVisible: "Niveau 1"
      
      # =================== PHASE 3: S√âLECTION EXERCICE ===================
      - assertVisible: "Choisissez votre exercice"
      - assertVisible: "Vocabulaire"
      
      # V√©rifier la progression initiale
      - assertVisible: "0%" # Progression vocabulaire
      
      # Lancer l'exercice de vocabulaire
      - tapOn: "vocabulary-button"
      - assertVisible: "Vocabulaire"
      
      # =================== PHASE 4: EXERCICE VOCABULAIRE ===================
      - assertVisible: "Progression"
      - assertVisible: "0/15" # ou le nombre total de mots
      
      # Faire quelques mots
      - repeat:
          times: 3
          commands:
            - assertVisible: "Traduire"
            - tapOn: "Traduire" # R√©v√©ler la traduction
            - assertVisible: "Suivant"
            - tapOn: "Suivant" # Passer au mot suivant
            
      # V√©rifier que la progress bar s'est mise √† jour
      - assertVisible: "3/15" # ou la progression actuelle
      
      # Continuer jusqu'√† la fin (optionnel)
      - repeat:
          times: 12
          commands:
            - tapOn: "Traduire"
            - tapOn: "Suivant"
            
      # =================== PHASE 5: RETOUR ET V√âRIFICATION ===================
      # Retour √† la s√©lection d'exercices
      - assertVisible: "Niveau 1"
      - assertVisible: "Vocabulaire"
      
      # V√©rifier que la progression s'est mise √† jour
      - assertVisible: "15%" # ou la progression calcul√©e
      
      # Retour √† la s√©lection de niveaux
      - tapOn: "Niveaux" # Bouton retour
      - assertVisible: "Niveaux"
      
      # V√©rifier que le niveau 1 a progress√©
      - assertVisible: "level-1-button"
      - assertVisible: "15%" # Progression du niveau
      
      # Retour au dashboard
      - tapOn: "Accueil" # Onglet footer
      - assertVisible: "Accueil"
      
      # =================== PHASE 6: V√âRIFICATION DASHBOARD ===================
      # V√©rifier que SimpleMetrics s'est mis √† jour
      - assertVisible: "üìö Mots aujourd'hui"
      - assertVisible: "15" # ou le nombre de mots appris
      
      # V√©rifier que QuickActions s'est mis √† jour
      - assertVisible: "‚ö° Actions rapides"
      - assertVisible: "15 mots disponibles" # Pour la r√©vision
      
      # V√©rifier que LearningProgress s'est mis √† jour
      - assertVisible: "üèÜ Progression g√©n√©rale"
      - assertVisible: "15%" # Progression du niveau actuel
      
      # V√©rifier que "Continue Learning" s'est mis √† jour
      - assertVisible: "Continuez votre apprentissage"
      
      # =================== PHASE 7: TEST R√âVISION ===================
      # Tester la r√©vision (maintenant disponible)
      - tapOn: "üîÑ R√©vision"
      - assertVisible: "R√©vision"
      - assertVisible: "15 mots disponibles"
      
      # Retour au dashboard
      - tapOn: "Accueil"
      - assertVisible: "Accueil"

# Test de navigation footer
---
- runFlow:
    when:
      true: ${ENV:TEST_TYPE == "navigation" || !ENV:TEST_TYPE}
    commands:
      - launchApp
      
      # Test navigation Dashboard
      - tapOn: "Accueil"
      - assertVisible: "üìä Aujourd'hui"
      
      # Test navigation Niveaux
      - tapOn: "Niveaux"
      - assertVisible: "Choisissez votre niveau"
      
      # Test navigation Exercices
      - tapOn: "Exercices"
      - assertVisible: "Choisissez votre exercice"
      
      # Test navigation R√©glages
      - tapOn: "R√©glages"
      - assertVisible: "Param√®tres"
      - assertVisible: "üîÑ R√©visions automatiques"
      
      # Retour au dashboard
      - tapOn: "Accueil"
      - assertVisible: "Accueil"

# Test des param√®tres de r√©vision
---
- runFlow:
    when:
      true: ${ENV:TEST_TYPE == "settings" || !ENV:TEST_TYPE}
    commands:
      - launchApp
      - tapOn: "R√©glages"
      - assertVisible: "üîÑ R√©visions automatiques"
      
      # V√©rifier l'√©tat initial
      - assertVisible: "R√©visions automatiques"
      - assertVisible: "Tous les 50 mots (standard)"
      
      # Changer la fr√©quence
      - tapOn: "Tous les 25 mots (l√©ger)"
      - assertVisible: "‚úì"
      
      # D√©sactiver les r√©visions
      - tapOn: "R√©visions automatiques" # Toggle
      - assertVisible: "‚ö†Ô∏è R√©visions d√©sactiv√©es"
      
      # R√©activer les r√©visions
      - tapOn: "R√©visions automatiques" # Toggle
      - assertVisible: "Tous les 25 mots (l√©ger)"
      
      # Retour au dashboard
      - tapOn: "Accueil"
      - assertVisible: "Accueil"
