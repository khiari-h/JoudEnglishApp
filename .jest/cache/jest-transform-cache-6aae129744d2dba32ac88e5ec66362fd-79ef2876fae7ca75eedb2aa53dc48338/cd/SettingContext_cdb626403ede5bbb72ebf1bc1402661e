86e5fed1aefae4f6d47509b7326f803a
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SettingsProvider = exports.SettingsContext = void 0;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var _storageUtils = require("../utils/storageUtils");
var _constants = require("../utils/constants");
var _jsxRuntime = require("react/jsx-runtime");
var SettingsContext = exports.SettingsContext = (0, _react.createContext)();
var SettingsProvider = exports.SettingsProvider = function SettingsProvider(_ref) {
  var children = _ref.children;
  var _useState = (0, _react.useState)(_constants.DEFAULT_SETTINGS),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    settings = _useState2[0],
    setSettings = _useState2[1];
  var _useState3 = (0, _react.useState)(true),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    isLoading = _useState4[0],
    setIsLoading = _useState4[1];
  (0, _react.useEffect)(function () {
    var loadSettings = function () {
      var _ref2 = (0, _asyncToGenerator2.default)(function* () {
        try {
          setIsLoading(true);
          var savedSettings = yield (0, _storageUtils.getData)('userSettings');
          if (savedSettings) {
            setSettings(Object.assign({}, _constants.DEFAULT_SETTINGS, savedSettings));
          } else {
            setSettings(_constants.DEFAULT_SETTINGS);
          }
        } catch (error) {} finally {
          setIsLoading(false);
        }
      });
      return function loadSettings() {
        return _ref2.apply(this, arguments);
      };
    }();
    loadSettings();
  }, []);
  (0, _react.useEffect)(function () {
    if (!isLoading) {
      (0, _storageUtils.storeData)('userSettings', settings);
    }
  }, [settings, isLoading]);
  var updateSetting = function updateSetting(key, value) {
    if (settings[key] === undefined) {
      return;
    }
    setSettings(function (prevSettings) {
      return Object.assign({}, prevSettings, (0, _defineProperty2.default)({}, key, value));
    });
  };
  var updateSettings = function updateSettings(newSettings) {
    setSettings(function (prevSettings) {
      return Object.assign({}, prevSettings, newSettings);
    });
  };
  var resetSettings = function resetSettings() {
    setSettings(_constants.DEFAULT_SETTINGS);
  };
  var areNotificationsEnabled = function areNotificationsEnabled() {
    return settings.notifications;
  };
  var getDailyGoal = function getDailyGoal() {
    return settings.dailyGoal;
  };
  var setDailyGoal = function setDailyGoal(minutes) {
    updateSetting('dailyGoal', Math.max(1, Math.min(120, minutes)));
  };
  var contextValue = {
    settings: settings,
    updateSetting: updateSetting,
    updateSettings: updateSettings,
    resetSettings: resetSettings,
    areNotificationsEnabled: areNotificationsEnabled,
    getDailyGoal: getDailyGoal,
    setDailyGoal: setDailyGoal,
    isLoading: isLoading
  };
  return (0, _jsxRuntime.jsx)(SettingsContext.Provider, {
    value: contextValue,
    children: children
  });
};
var _default = exports.default = SettingsContext;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3N0b3JhZ2VVdGlscyIsIl9jb25zdGFudHMiLCJfanN4UnVudGltZSIsIlNldHRpbmdzQ29udGV4dCIsImV4cG9ydHMiLCJjcmVhdGVDb250ZXh0IiwiU2V0dGluZ3NQcm92aWRlciIsIl9yZWYiLCJjaGlsZHJlbiIsIl91c2VTdGF0ZSIsInVzZVN0YXRlIiwiREVGQVVMVF9TRVRUSU5HUyIsIl91c2VTdGF0ZTIiLCJfc2xpY2VkVG9BcnJheTIiLCJkZWZhdWx0Iiwic2V0dGluZ3MiLCJzZXRTZXR0aW5ncyIsIl91c2VTdGF0ZTMiLCJfdXNlU3RhdGU0IiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwidXNlRWZmZWN0IiwibG9hZFNldHRpbmdzIiwiX3JlZjIiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJzYXZlZFNldHRpbmdzIiwiZ2V0RGF0YSIsIk9iamVjdCIsImFzc2lnbiIsImVycm9yIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJzdG9yZURhdGEiLCJ1cGRhdGVTZXR0aW5nIiwia2V5IiwidmFsdWUiLCJ1bmRlZmluZWQiLCJwcmV2U2V0dGluZ3MiLCJfZGVmaW5lUHJvcGVydHkyIiwidXBkYXRlU2V0dGluZ3MiLCJuZXdTZXR0aW5ncyIsInJlc2V0U2V0dGluZ3MiLCJhcmVOb3RpZmljYXRpb25zRW5hYmxlZCIsIm5vdGlmaWNhdGlvbnMiLCJnZXREYWlseUdvYWwiLCJkYWlseUdvYWwiLCJzZXREYWlseUdvYWwiLCJtaW51dGVzIiwiTWF0aCIsIm1heCIsIm1pbiIsImNvbnRleHRWYWx1ZSIsImpzeCIsIlByb3ZpZGVyIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyJTZXR0aW5nQ29udGV4dC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvY29udGV4dHMvU2V0dGluZ3NDb250ZXh0LmpzXG5pbXBvcnQgeyBjcmVhdGVDb250ZXh0LCB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgc3RvcmVEYXRhLCBnZXREYXRhIH0gZnJvbSAnLi4vdXRpbHMvc3RvcmFnZVV0aWxzJztcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICcuLi91dGlscy9jb25zdGFudHMnO1xuXG4vLyBDcsOpZXIgbGUgY29udGV4dGVcbmV4cG9ydCBjb25zdCBTZXR0aW5nc0NvbnRleHQgPSBjcmVhdGVDb250ZXh0KCk7XG5cbi8qKlxuICogRm91cm5pc3NldXIgZGUgY29udGV4dGUgcG91ciBnw6lyZXIgbGVzIHBhcmFtw6h0cmVzIGRlIGwnYXBwbGljYXRpb25cbiAqL1xuZXhwb3J0IGNvbnN0IFNldHRpbmdzUHJvdmlkZXIgPSAoeyBjaGlsZHJlbiB9KSA9PiB7XG4gIC8vIMOJdGF0IGRlcyBwYXJhbcOodHJlc1xuICBjb25zdCBbc2V0dGluZ3MsIHNldFNldHRpbmdzXSA9IHVzZVN0YXRlKERFRkFVTFRfU0VUVElOR1MpO1xuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XG5cbiAgLy8gQ2hhcmdlciBsZXMgcGFyYW3DqHRyZXMgYXUgZMOpbWFycmFnZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IGxvYWRTZXR0aW5ncyA9IGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICAgICAgY29uc3Qgc2F2ZWRTZXR0aW5ncyA9IGF3YWl0IGdldERhdGEoJ3VzZXJTZXR0aW5ncycpO1xuXG4gICAgICAgIGlmIChzYXZlZFNldHRpbmdzKSB7XG4gICAgICAgICAgLy8gRnVzaW9ubmVyIGF2ZWMgbGVzIHBhcmFtw6h0cmVzIHBhciBkw6lmYXV0IHBvdXIgcydhc3N1cmVyIHF1ZSB0b3VzIGxlcyBjaGFtcHMgc29udCBwcsOpc2VudHNcbiAgICAgICAgICBzZXRTZXR0aW5ncyh7IC4uLkRFRkFVTFRfU0VUVElOR1MsIC4uLnNhdmVkU2V0dGluZ3MgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gSWYgbm8gc2F2ZWQgc2V0dGluZ3MsIHVzZSBkZWZhdWx0XG4gICAgICAgICAgc2V0U2V0dGluZ3MoREVGQVVMVF9TRVRUSU5HUyk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIElnbm9yZWQgb24gcHVycG9zZVxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgbG9hZFNldHRpbmdzKCk7XG4gIH0sIFtdKTtcblxuICAvLyBTYXV2ZWdhcmRlciBsZXMgcGFyYW3DqHRyZXMgbG9yc3F1J2lscyBjaGFuZ2VudFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghaXNMb2FkaW5nKSB7XG4gICAgICBzdG9yZURhdGEoJ3VzZXJTZXR0aW5ncycsIHNldHRpbmdzKTtcbiAgICB9XG4gIH0sIFtzZXR0aW5ncywgaXNMb2FkaW5nXSk7XG5cbiAgLy8gTWV0dHJlIMOgIGpvdXIgdW4gcGFyYW3DqHRyZSBzcMOpY2lmaXF1ZVxuICBjb25zdCB1cGRhdGVTZXR0aW5nID0gKGtleSwgdmFsdWUpID0+IHtcbiAgICBpZiAoc2V0dGluZ3Nba2V5XSA9PT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzZXRTZXR0aW5ncyhwcmV2U2V0dGluZ3MgPT4gKHtcbiAgICAgIC4uLnByZXZTZXR0aW5ncyxcbiAgICAgIFtrZXldOiB2YWx1ZVxuICAgIH0pKTtcbiAgfTtcblxuICAvLyBNZXR0cmUgw6Agam91ciBwbHVzaWV1cnMgcGFyYW3DqHRyZXMgw6AgbGEgZm9pc1xuICBjb25zdCB1cGRhdGVTZXR0aW5ncyA9IChuZXdTZXR0aW5ncykgPT4ge1xuICAgIHNldFNldHRpbmdzKHByZXZTZXR0aW5ncyA9PiAoe1xuICAgICAgLi4ucHJldlNldHRpbmdzLFxuICAgICAgLi4ubmV3U2V0dGluZ3NcbiAgICB9KSk7XG4gIH07XG5cbiAgLy8gUsOpaW5pdGlhbGlzZXIgdG91cyBsZXMgcGFyYW3DqHRyZXNcbiAgY29uc3QgcmVzZXRTZXR0aW5ncyA9ICgpID0+IHtcbiAgICBzZXRTZXR0aW5ncyhERUZBVUxUX1NFVFRJTkdTKTtcbiAgfTtcblxuICAvLyBWw6lyaWZpZXIgc2kgbGVzIG5vdGlmaWNhdGlvbnMgc29udCBhY3RpdsOpZXNcbiAgY29uc3QgYXJlTm90aWZpY2F0aW9uc0VuYWJsZWQgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHNldHRpbmdzLm5vdGlmaWNhdGlvbnM7XG4gIH07XG5cbiAgLy8gT2J0ZW5pciBsZSBkw6lsYWkgam91cm5hbGllclxuICBjb25zdCBnZXREYWlseUdvYWwgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHNldHRpbmdzLmRhaWx5R29hbDtcbiAgfTtcblxuICAvLyBEw6lmaW5pciBsZSBkw6lsYWkgam91cm5hbGllclxuICBjb25zdCBzZXREYWlseUdvYWwgPSAobWludXRlcykgPT4ge1xuICAgIHVwZGF0ZVNldHRpbmcoJ2RhaWx5R29hbCcsIE1hdGgubWF4KDEsIE1hdGgubWluKDEyMCwgbWludXRlcykpKTsgLy8gRW50cmUgMSBldCAxMjAgbWludXRlc1xuICB9O1xuXG4gIC8vIFZhbGV1ciBmb3VybmllIHBhciBsZSBjb250ZXh0ZVxuICBjb25zdCBjb250ZXh0VmFsdWUgPSB7XG4gICAgc2V0dGluZ3MsXG4gICAgdXBkYXRlU2V0dGluZyxcbiAgICB1cGRhdGVTZXR0aW5ncyxcbiAgICByZXNldFNldHRpbmdzLFxuICAgIGFyZU5vdGlmaWNhdGlvbnNFbmFibGVkLFxuICAgIGdldERhaWx5R29hbCxcbiAgICBzZXREYWlseUdvYWwsXG4gICAgaXNMb2FkaW5nLFxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPFNldHRpbmdzQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17Y29udGV4dFZhbHVlfT5cbiAgICAgIHtjaGlsZHJlbn1cbiAgICA8L1NldHRpbmdzQ29udGV4dC5Qcm92aWRlcj5cbiAgKTtcbn07XG5cbmV4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