119afdfa1a8c5f3a8927fb68e93f57f0
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.LegacyEventEmitter = void 0;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _invariant = _interopRequireDefault(require("invariant"));
var _reactNative = require("react-native");
var nativeEmitterSubscriptionKey = '@@nativeEmitterSubscription@@';
var LegacyEventEmitter = exports.LegacyEventEmitter = function () {
  function LegacyEventEmitter(nativeModule) {
    (0, _classCallCheck2.default)(this, LegacyEventEmitter);
    this._listenerCount = 0;
    if (nativeModule.__expo_module_name__) {
      return nativeModule;
    }
    this._nativeModule = nativeModule;
    this._eventEmitter = new _reactNative.NativeEventEmitter(nativeModule);
  }
  return (0, _createClass2.default)(LegacyEventEmitter, [{
    key: "addListener",
    value: function addListener(eventName, listener) {
      var _this = this;
      if (!this._listenerCount && _reactNative.Platform.OS !== 'ios' && this._nativeModule.startObserving) {
        this._nativeModule.startObserving();
      }
      this._listenerCount++;
      var nativeEmitterSubscription = this._eventEmitter.addListener(eventName, listener);
      var subscription = (0, _defineProperty2.default)((0, _defineProperty2.default)({}, nativeEmitterSubscriptionKey, nativeEmitterSubscription), "remove", function remove() {
        _this.removeSubscription(subscription);
      });
      return subscription;
    }
  }, {
    key: "removeAllListeners",
    value: function removeAllListeners(eventName) {
      var removedListenerCount = this._eventEmitter.listenerCount ? this._eventEmitter.listenerCount(eventName) : this._eventEmitter.listeners(eventName).length;
      this._eventEmitter.removeAllListeners(eventName);
      this._listenerCount -= removedListenerCount;
      (0, _invariant.default)(this._listenerCount >= 0, `EventEmitter must have a non-negative number of listeners`);
      if (!this._listenerCount && _reactNative.Platform.OS !== 'ios' && this._nativeModule.stopObserving) {
        this._nativeModule.stopObserving();
      }
    }
  }, {
    key: "removeSubscription",
    value: function removeSubscription(subscription) {
      var nativeEmitterSubscription = subscription[nativeEmitterSubscriptionKey];
      if (!nativeEmitterSubscription) {
        return;
      }
      if ('remove' in nativeEmitterSubscription) {
        nativeEmitterSubscription.remove();
      }
      this._listenerCount--;
      delete subscription[nativeEmitterSubscriptionKey];
      subscription.remove = function () {};
      if (!this._listenerCount && _reactNative.Platform.OS !== 'ios' && this._nativeModule.stopObserving) {
        this._nativeModule.stopObserving();
      }
    }
  }, {
    key: "emit",
    value: function emit(eventName) {
      var _this$_eventEmitter;
      for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        params[_key - 1] = arguments[_key];
      }
      (_this$_eventEmitter = this._eventEmitter).emit.apply(_this$_eventEmitter, [eventName].concat(params));
    }
  }]);
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW52YXJpYW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfcmVhY3ROYXRpdmUiLCJuYXRpdmVFbWl0dGVyU3Vic2NyaXB0aW9uS2V5IiwiTGVnYWN5RXZlbnRFbWl0dGVyIiwiZXhwb3J0cyIsIm5hdGl2ZU1vZHVsZSIsIl9jbGFzc0NhbGxDaGVjazIiLCJkZWZhdWx0IiwiX2xpc3RlbmVyQ291bnQiLCJfX2V4cG9fbW9kdWxlX25hbWVfXyIsIl9uYXRpdmVNb2R1bGUiLCJfZXZlbnRFbWl0dGVyIiwiTmF0aXZlRXZlbnRFbWl0dGVyIiwiX2NyZWF0ZUNsYXNzMiIsImtleSIsInZhbHVlIiwiYWRkTGlzdGVuZXIiLCJldmVudE5hbWUiLCJsaXN0ZW5lciIsIl90aGlzIiwiUGxhdGZvcm0iLCJPUyIsInN0YXJ0T2JzZXJ2aW5nIiwibmF0aXZlRW1pdHRlclN1YnNjcmlwdGlvbiIsInN1YnNjcmlwdGlvbiIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJyZW1vdmUiLCJyZW1vdmVTdWJzY3JpcHRpb24iLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJyZW1vdmVkTGlzdGVuZXJDb3VudCIsImxpc3RlbmVyQ291bnQiLCJsaXN0ZW5lcnMiLCJsZW5ndGgiLCJpbnZhcmlhbnQiLCJzdG9wT2JzZXJ2aW5nIiwiZW1pdCIsIl90aGlzJF9ldmVudEVtaXR0ZXIiLCJfbGVuIiwiYXJndW1lbnRzIiwicGFyYW1zIiwiQXJyYXkiLCJfa2V5IiwiYXBwbHkiLCJjb25jYXQiXSwic291cmNlcyI6WyJMZWdhY3lFdmVudEVtaXR0ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGludmFyaWFudCBmcm9tICdpbnZhcmlhbnQnO1xuaW1wb3J0IHsgTmF0aXZlRXZlbnRFbWl0dGVyLCBQbGF0Zm9ybSB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5cbmltcG9ydCB7IEV2ZW50U3Vic2NyaXB0aW9uIH0gZnJvbSAnLi9FdmVudEVtaXR0ZXInO1xuXG5jb25zdCBuYXRpdmVFbWl0dGVyU3Vic2NyaXB0aW9uS2V5ID0gJ0BAbmF0aXZlRW1pdHRlclN1YnNjcmlwdGlvbkBAJztcblxudHlwZSBOYXRpdmVNb2R1bGUgPSB7XG4gIF9fZXhwb19tb2R1bGVfbmFtZV9fPzogc3RyaW5nO1xuICBzdGFydE9ic2VydmluZz86ICgpID0+IHZvaWQ7XG4gIHN0b3BPYnNlcnZpbmc/OiAoKSA9PiB2b2lkO1xuXG4gIC8vIEVyYXNlIHRoZXNlIHR5cGVzIGFzIHRoZXkgd291bGQgY29uZmxpY3Qgd2l0aCB0aGUgbmV3IE5hdGl2ZU1vZHVsZSB0eXBlLlxuICAvLyBUaGlzIEV2ZW50RW1pdHRlciBpcyBkZXByZWNhdGVkIGFueXdheS5cbiAgYWRkTGlzdGVuZXI/OiBhbnk7XG4gIHJlbW92ZUxpc3RlbmVycz86IGFueTtcbn07XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgRGVwcmVjYXRlZCBpbiBmYXZvciBvZiBgRXZlbnRFbWl0dGVyYC5cbiAqL1xuZXhwb3J0IGNsYXNzIExlZ2FjeUV2ZW50RW1pdHRlciB7XG4gIF9saXN0ZW5lckNvdW50ID0gMDtcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gIF9uYXRpdmVNb2R1bGU6IE5hdGl2ZU1vZHVsZTtcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gIF9ldmVudEVtaXR0ZXI6IE5hdGl2ZUV2ZW50RW1pdHRlcjtcblxuICBjb25zdHJ1Y3RvcihuYXRpdmVNb2R1bGU6IE5hdGl2ZU1vZHVsZSkge1xuICAgIC8vIElmIHRoZSBuYXRpdmUgbW9kdWxlIGlzIGEgbmV3IG1vZHVsZSwganVzdCByZXR1cm4gaXQgYmFjayBhcyBpdCdzIGFscmVhZHkgYW4gZXZlbnQgZW1pdHRlci5cbiAgICAvLyBUaGlzIGlzIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB1bnRpbCB3ZSBzdG9wIHVzaW5nIHRoaXMgbGVnYWN5IGNsYXNzIGluIG90aGVyIHBhY2thZ2VzLlxuICAgIGlmIChuYXRpdmVNb2R1bGUuX19leHBvX21vZHVsZV9uYW1lX18pIHtcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgICAgIHJldHVybiBuYXRpdmVNb2R1bGU7XG4gICAgfVxuICAgIHRoaXMuX25hdGl2ZU1vZHVsZSA9IG5hdGl2ZU1vZHVsZTtcbiAgICB0aGlzLl9ldmVudEVtaXR0ZXIgPSBuZXcgTmF0aXZlRXZlbnRFbWl0dGVyKG5hdGl2ZU1vZHVsZSBhcyBhbnkpO1xuICB9XG5cbiAgYWRkTGlzdGVuZXI8VD4oZXZlbnROYW1lOiBzdHJpbmcsIGxpc3RlbmVyOiAoZXZlbnQ6IFQpID0+IHZvaWQpOiBFdmVudFN1YnNjcmlwdGlvbiB7XG4gICAgaWYgKCF0aGlzLl9saXN0ZW5lckNvdW50ICYmIFBsYXRmb3JtLk9TICE9PSAnaW9zJyAmJiB0aGlzLl9uYXRpdmVNb2R1bGUuc3RhcnRPYnNlcnZpbmcpIHtcbiAgICAgIHRoaXMuX25hdGl2ZU1vZHVsZS5zdGFydE9ic2VydmluZygpO1xuICAgIH1cblxuICAgIHRoaXMuX2xpc3RlbmVyQ291bnQrKztcbiAgICBjb25zdCBuYXRpdmVFbWl0dGVyU3Vic2NyaXB0aW9uID0gdGhpcy5fZXZlbnRFbWl0dGVyLmFkZExpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuZXIpO1xuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHtcbiAgICAgIFtuYXRpdmVFbWl0dGVyU3Vic2NyaXB0aW9uS2V5XTogbmF0aXZlRW1pdHRlclN1YnNjcmlwdGlvbixcbiAgICAgIHJlbW92ZTogKCkgPT4ge1xuICAgICAgICB0aGlzLnJlbW92ZVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24pO1xuICAgICAgfSxcbiAgICB9O1xuICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gIH1cblxuICByZW1vdmVBbGxMaXN0ZW5lcnMoZXZlbnROYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAvLyBAdHMtaWdub3JlOiB0aGUgRXZlbnRFbWl0dGVyIGludGVyZmFjZSBoYXMgYmVlbiBjaGFuZ2VkIGluIHJlYWN0LW5hdGl2ZUAwLjY0LjBcbiAgICBjb25zdCByZW1vdmVkTGlzdGVuZXJDb3VudCA9IHRoaXMuX2V2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50XG4gICAgICA/IC8vIEB0cy1pZ25vcmU6IHRoaXMgaXMgYXZhaWxhYmxlIHNpbmNlIDAuNjRcbiAgICAgICAgdGhpcy5fZXZlbnRFbWl0dGVyLmxpc3RlbmVyQ291bnQoZXZlbnROYW1lKVxuICAgICAgOiAvLyBAdHMtaWdub3JlOiB0aGlzIGlzIGF2YWlsYWJsZSBpbiBvbGRlciB2ZXJzaW9uc1xuICAgICAgICB0aGlzLl9ldmVudEVtaXR0ZXIubGlzdGVuZXJzKGV2ZW50TmFtZSkubGVuZ3RoO1xuICAgIHRoaXMuX2V2ZW50RW1pdHRlci5yZW1vdmVBbGxMaXN0ZW5lcnMoZXZlbnROYW1lKTtcbiAgICB0aGlzLl9saXN0ZW5lckNvdW50IC09IHJlbW92ZWRMaXN0ZW5lckNvdW50O1xuICAgIGludmFyaWFudChcbiAgICAgIHRoaXMuX2xpc3RlbmVyQ291bnQgPj0gMCxcbiAgICAgIGBFdmVudEVtaXR0ZXIgbXVzdCBoYXZlIGEgbm9uLW5lZ2F0aXZlIG51bWJlciBvZiBsaXN0ZW5lcnNgXG4gICAgKTtcblxuICAgIGlmICghdGhpcy5fbGlzdGVuZXJDb3VudCAmJiBQbGF0Zm9ybS5PUyAhPT0gJ2lvcycgJiYgdGhpcy5fbmF0aXZlTW9kdWxlLnN0b3BPYnNlcnZpbmcpIHtcbiAgICAgIHRoaXMuX25hdGl2ZU1vZHVsZS5zdG9wT2JzZXJ2aW5nKCk7XG4gICAgfVxuICB9XG5cbiAgcmVtb3ZlU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbjogRXZlbnRTdWJzY3JpcHRpb24pOiB2b2lkIHtcbiAgICBjb25zdCBuYXRpdmVFbWl0dGVyU3Vic2NyaXB0aW9uID0gc3Vic2NyaXB0aW9uW25hdGl2ZUVtaXR0ZXJTdWJzY3JpcHRpb25LZXldO1xuICAgIGlmICghbmF0aXZlRW1pdHRlclN1YnNjcmlwdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICgncmVtb3ZlJyBpbiBuYXRpdmVFbWl0dGVyU3Vic2NyaXB0aW9uKSB7XG4gICAgICBuYXRpdmVFbWl0dGVyU3Vic2NyaXB0aW9uLnJlbW92ZSgpO1xuICAgIH1cbiAgICB0aGlzLl9saXN0ZW5lckNvdW50LS07XG5cbiAgICAvLyBFbnN1cmUgdGhhdCB0aGUgZW1pdHRlcidzIGludGVybmFsIHN0YXRlIHJlbWFpbnMgY29ycmVjdCBldmVuIGlmIGByZW1vdmVTdWJzY3JpcHRpb25gIGlzXG4gICAgLy8gY2FsbGVkIGFnYWluIHdpdGggdGhlIHNhbWUgc3Vic2NyaXB0aW9uXG4gICAgZGVsZXRlIHN1YnNjcmlwdGlvbltuYXRpdmVFbWl0dGVyU3Vic2NyaXB0aW9uS2V5XTtcblxuICAgIC8vIFJlbGVhc2UgY2xvc2VkLW92ZXIgcmVmZXJlbmNlcyB0byB0aGUgZW1pdHRlclxuICAgIHN1YnNjcmlwdGlvbi5yZW1vdmUgPSAoKSA9PiB7fTtcblxuICAgIGlmICghdGhpcy5fbGlzdGVuZXJDb3VudCAmJiBQbGF0Zm9ybS5PUyAhPT0gJ2lvcycgJiYgdGhpcy5fbmF0aXZlTW9kdWxlLnN0b3BPYnNlcnZpbmcpIHtcbiAgICAgIHRoaXMuX25hdGl2ZU1vZHVsZS5zdG9wT2JzZXJ2aW5nKCk7XG4gICAgfVxuICB9XG5cbiAgZW1pdChldmVudE5hbWU6IHN0cmluZywgLi4ucGFyYW1zOiBhbnlbXSk6IHZvaWQge1xuICAgIHRoaXMuX2V2ZW50RW1pdHRlci5lbWl0KGV2ZW50TmFtZSwgLi4ucGFyYW1zKTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLElBQUFBLFVBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFlBQUEsR0FBQUQsT0FBQTtBQUlBLElBQU1FLDRCQUE0QixHQUFHLCtCQUErQjtBQUFDLElBZ0J4REMsa0JBQWtCLEdBQUFDLE9BQUEsQ0FBQUQsa0JBQUE7RUFTN0IsU0FBQUEsbUJBQVlFLFlBQTBCLEVBQUU7SUFBQSxJQUFBQyxnQkFBQSxDQUFBQyxPQUFBLFFBQUFKLGtCQUFBO0lBQUEsS0FSeENLLGNBQWMsR0FBRyxDQUFDO0lBV2hCLElBQUlILFlBQVksQ0FBQ0ksb0JBQW9CLEVBQUU7TUFFckMsT0FBT0osWUFBWTtJQUNyQjtJQUNBLElBQUksQ0FBQ0ssYUFBYSxHQUFHTCxZQUFZO0lBQ2pDLElBQUksQ0FBQ00sYUFBYSxHQUFHLElBQUlDLCtCQUFrQixDQUFDUCxZQUFtQixDQUFDO0VBQ2xFO0VBQUMsV0FBQVEsYUFBQSxDQUFBTixPQUFBLEVBQUFKLGtCQUFBO0lBQUFXLEdBQUE7SUFBQUMsS0FBQSxFQUVELFNBQUFDLFdBQVdBLENBQUlDLFNBQWlCLEVBQUVDLFFBQTRCLEVBQXFCO01BQUEsSUFBQUMsS0FBQTtNQUNqRixJQUFJLENBQUMsSUFBSSxDQUFDWCxjQUFjLElBQUlZLHFCQUFRLENBQUNDLEVBQUUsS0FBSyxLQUFLLElBQUksSUFBSSxDQUFDWCxhQUFhLENBQUNZLGNBQWMsRUFBRTtRQUN0RixJQUFJLENBQUNaLGFBQWEsQ0FBQ1ksY0FBYyxDQUFDLENBQUM7TUFDckM7TUFFQSxJQUFJLENBQUNkLGNBQWMsRUFBRTtNQUNyQixJQUFNZSx5QkFBeUIsR0FBRyxJQUFJLENBQUNaLGFBQWEsQ0FBQ0ssV0FBVyxDQUFDQyxTQUFTLEVBQUVDLFFBQVEsQ0FBQztNQUNyRixJQUFNTSxZQUFZLE9BQUFDLGdCQUFBLENBQUFsQixPQUFBLE1BQUFrQixnQkFBQSxDQUFBbEIsT0FBQSxNQUNmTCw0QkFBNEIsRUFBR3FCLHlCQUF5QixhQUNqRCxTQUFSRyxNQUFNQSxDQUFBLEVBQVE7UUFDWlAsS0FBSSxDQUFDUSxrQkFBa0IsQ0FBQ0gsWUFBWSxDQUFDO01BQ3ZDLENBQUMsQ0FDRjtNQUNELE9BQU9BLFlBQVk7SUFDckI7RUFBQztJQUFBVixHQUFBO0lBQUFDLEtBQUEsRUFFRCxTQUFBYSxrQkFBa0JBLENBQUNYLFNBQWlCLEVBQVE7TUFFMUMsSUFBTVksb0JBQW9CLEdBQUcsSUFBSSxDQUFDbEIsYUFBYSxDQUFDbUIsYUFBYSxHQUV6RCxJQUFJLENBQUNuQixhQUFhLENBQUNtQixhQUFhLENBQUNiLFNBQVMsQ0FBQyxHQUUzQyxJQUFJLENBQUNOLGFBQWEsQ0FBQ29CLFNBQVMsQ0FBQ2QsU0FBUyxDQUFDLENBQUNlLE1BQU07TUFDbEQsSUFBSSxDQUFDckIsYUFBYSxDQUFDaUIsa0JBQWtCLENBQUNYLFNBQVMsQ0FBQztNQUNoRCxJQUFJLENBQUNULGNBQWMsSUFBSXFCLG9CQUFvQjtNQUMzQyxJQUFBSSxrQkFBUyxFQUNQLElBQUksQ0FBQ3pCLGNBQWMsSUFBSSxDQUFDLEVBQ3hCLDJEQUNGLENBQUM7TUFFRCxJQUFJLENBQUMsSUFBSSxDQUFDQSxjQUFjLElBQUlZLHFCQUFRLENBQUNDLEVBQUUsS0FBSyxLQUFLLElBQUksSUFBSSxDQUFDWCxhQUFhLENBQUN3QixhQUFhLEVBQUU7UUFDckYsSUFBSSxDQUFDeEIsYUFBYSxDQUFDd0IsYUFBYSxDQUFDLENBQUM7TUFDcEM7SUFDRjtFQUFDO0lBQUFwQixHQUFBO0lBQUFDLEtBQUEsRUFFRCxTQUFBWSxrQkFBa0JBLENBQUNILFlBQStCLEVBQVE7TUFDeEQsSUFBTUQseUJBQXlCLEdBQUdDLFlBQVksQ0FBQ3RCLDRCQUE0QixDQUFDO01BQzVFLElBQUksQ0FBQ3FCLHlCQUF5QixFQUFFO1FBQzlCO01BQ0Y7TUFFQSxJQUFJLFFBQVEsSUFBSUEseUJBQXlCLEVBQUU7UUFDekNBLHlCQUF5QixDQUFDRyxNQUFNLENBQUMsQ0FBQztNQUNwQztNQUNBLElBQUksQ0FBQ2xCLGNBQWMsRUFBRTtNQUlyQixPQUFPZ0IsWUFBWSxDQUFDdEIsNEJBQTRCLENBQUM7TUFHakRzQixZQUFZLENBQUNFLE1BQU0sR0FBRyxZQUFNLENBQUMsQ0FBQztNQUU5QixJQUFJLENBQUMsSUFBSSxDQUFDbEIsY0FBYyxJQUFJWSxxQkFBUSxDQUFDQyxFQUFFLEtBQUssS0FBSyxJQUFJLElBQUksQ0FBQ1gsYUFBYSxDQUFDd0IsYUFBYSxFQUFFO1FBQ3JGLElBQUksQ0FBQ3hCLGFBQWEsQ0FBQ3dCLGFBQWEsQ0FBQyxDQUFDO01BQ3BDO0lBQ0Y7RUFBQztJQUFBcEIsR0FBQTtJQUFBQyxLQUFBLEVBRUQsU0FBQW9CLElBQUlBLENBQUNsQixTQUFpQixFQUEwQjtNQUFBLElBQUFtQixtQkFBQTtNQUFBLFNBQUFDLElBQUEsR0FBQUMsU0FBQSxDQUFBTixNQUFBLEVBQXJCTyxNQUFNLE9BQUFDLEtBQUEsQ0FBQUgsSUFBQSxPQUFBQSxJQUFBLFdBQUFJLElBQUEsTUFBQUEsSUFBQSxHQUFBSixJQUFBLEVBQUFJLElBQUE7UUFBTkYsTUFBTSxDQUFBRSxJQUFBLFFBQUFILFNBQUEsQ0FBQUcsSUFBQTtNQUFBO01BQy9CLENBQUFMLG1CQUFBLE9BQUksQ0FBQ3pCLGFBQWEsRUFBQ3dCLElBQUksQ0FBQU8sS0FBQSxDQUFBTixtQkFBQSxHQUFDbkIsU0FBUyxFQUFBMEIsTUFBQSxDQUFLSixNQUFNLEVBQUM7SUFDL0M7RUFBQztBQUFBIiwiaWdub3JlTGlzdCI6W119