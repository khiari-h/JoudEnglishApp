{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_propTypes","_interopRequireDefault","_styles","_StyledText","_jsxRuntime","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","CategoryPill","React","memo","_ref","category","selected","onSelectCategory","animatedScale","useRef","Animated","Value","current","handlePressIn","useCallback","timing","toValue","duration","useNativeDriver","start","handlePressOut","handlePress","id","jsx","View","testID","style","styles","categoryPill","categoryPillSelected","transform","scale","children","Pressable","onPressIn","onPressOut","onPress","pressable","accessible","accessibilityRole","accessibilityLabel","name","accessibilityState","jsxs","StyledText","categoryPillText","propTypes","PropTypes","shape","string","isRequired","bool","func","areEqual","exports","prevProps","nextProps","CategorySelector","_ref2","categories","selectedCategory","scrollViewRef","isAnimatingRef","useEffect","selectedIndex","findIndex","cat","scrollTo","x","y","animated","handleSelectCategory","categoryId","setTimeout","container","ScrollView","ref","horizontal","showsHorizontalScrollIndicator","contentContainerStyle","scrollViewContent","map","arrayOf","StyleSheet","create","paddingVertical","metrics","small","paddingHorizontal","large","borderWidth","borderColor","colors","gray","borderRadius","tiny","marginRight","backgroundColor","primary","padding","color","dark","fontWeight","_default"],"sources":["CategorySelector.test.js"],"sourcesContent":["// src/components/exercise-common/CategorySelector/index.js\nimport React, { useRef, useCallback, useEffect } from 'react';\nimport { StyleSheet, View, ScrollView, Animated, Pressable } from 'react-native';\nimport PropTypes from 'prop-types';\n\nimport { colors, device, metrics } from '../../../../styles';\nimport { StyledText } from '../StyledText';\n\n// Le composant individuel pour la pilule de catégorie\nconst CategoryPill = React.memo(({ category, selected, onSelectCategory }) => {\n  const animatedScale = useRef(new Animated.Value(1)).current;\n\n  const handlePressIn = useCallback(() => {\n    Animated.timing(animatedScale, {\n      toValue: 0.95,\n      duration: 150,\n      useNativeDriver: true,\n    }).start();\n  }, [animatedScale]);\n\n  const handlePressOut = useCallback(() => {\n    Animated.timing(animatedScale, {\n      toValue: 1,\n      duration: 150,\n      useNativeDriver: true,\n    }).start();\n  }, [animatedScale]);\n\n  const handlePress = useCallback(() => {\n    onSelectCategory?.(category.id);\n  }, [category.id, onSelectCategory]);\n\n  return (\n    <Animated.View\n      testID={`category-pill-${category.id}`}\n      style={[\n        styles.categoryPill,\n        selected && styles.categoryPillSelected,\n        { transform: [{ scale: animatedScale }] },\n      ]}\n    >\n      <Pressable\n        onPressIn={handlePressIn}\n        onPressOut={handlePressOut}\n        onPress={handlePress}\n        style={styles.pressable}\n        accessible={true}\n        accessibilityRole=\"button\"\n        accessibilityLabel={category.name}\n        accessibilityState={{ selected }}\n      >\n        <StyledText\n          style={styles.categoryPillText}\n        >\n          {category.name}\n          {selected && ' ✨'}\n        </StyledText>\n      </Pressable>\n    </Animated.View>\n  );\n});\n\nCategoryPill.propTypes = {\n  category: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n  }).isRequired,\n  selected: PropTypes.bool.isRequired,\n  onSelectCategory: PropTypes.func,\n};\n\n// La fonction de comparaison pour React.memo\nexport const areEqual = (prevProps, nextProps) => {\n  return (\n    prevProps.selected === nextProps.selected &&\n    prevProps.category.id === nextProps.category.id\n  );\n};\n\n// Le composant principal\nconst CategorySelector = ({ categories, selectedCategory, onSelectCategory }) => {\n  const scrollViewRef = useRef(null);\n  const isAnimatingRef = useRef(false);\n\n  useEffect(() => {\n    if (selectedCategory) {\n      const selectedIndex = categories.findIndex((cat) => cat.id === selectedCategory);\n      if (selectedIndex !== -1) {\n        // Simuler le défilement vers l'élément sélectionné\n        // La logique réelle dépend de la position et de la taille de chaque élément\n        // Dans un vrai composant, il faudrait utiliser onLayout pour obtenir la position\n        // Pour les tests, le mock de ScrollView gère cela\n        if (scrollViewRef.current) {\n          scrollViewRef.current.scrollTo({ x: selectedIndex * 100, y: 0, animated: true });\n        }\n      }\n    }\n  }, [categories, selectedCategory]);\n\n  const handleSelectCategory = useCallback((categoryId) => {\n    // Vérifier si une animation est en cours\n    if (!isAnimatingRef.current) {\n      isAnimatingRef.current = true;\n      // Appel de la prop onSelectCategory s'il elle existe\n      onSelectCategory?.(categoryId);\n\n      // Réinitialiser la ref après un court délai pour permettre la fin de l'animation\n      setTimeout(() => {\n        isAnimatingRef.current = false;\n      }, 500); // 500 ms est une valeur de sécurité\n    }\n  }, [onSelectCategory]);\n\n  return (\n    <View style={styles.container}>\n      <ScrollView\n        ref={scrollViewRef}\n        testID=\"category-selector-scroll-view\"\n        horizontal\n        showsHorizontalScrollIndicator={false}\n        contentContainerStyle={styles.scrollViewContent}\n      >\n        {categories.map((category) => (\n          <CategoryPill\n            key={category.id}\n            category={category}\n            selected={category.id === selectedCategory}\n            onSelectCategory={handleSelectCategory}\n          />\n        ))}\n      </ScrollView>\n    </View>\n  );\n};\n\nCategorySelector.propTypes = {\n  categories: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      name: PropTypes.string.isRequired,\n    })\n  ).isRequired,\n  selectedCategory: PropTypes.string,\n  onSelectCategory: PropTypes.func,\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    paddingVertical: metrics.small,\n  },\n  scrollViewContent: {\n    paddingHorizontal: metrics.large,\n  },\n  categoryPill: {\n    borderWidth: 1,\n    borderColor: colors.gray,\n    borderRadius: 20,\n    paddingHorizontal: metrics.small,\n    paddingVertical: metrics.tiny,\n    marginRight: metrics.small,\n  },\n  categoryPillSelected: {\n    backgroundColor: colors.primary,\n    borderColor: colors.primary,\n  },\n  pressable: {\n    padding: metrics.small,\n  },\n  categoryPillText: {\n    color: colors.dark,\n    fontWeight: 'bold',\n  },\n});\n\nexport default React.memo(CategorySelector, areEqual);"],"mappings":"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","ignoreList":[]}