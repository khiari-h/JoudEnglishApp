{"version":3,"names":["_getJestObj","mock","RN","jest","requireActual","Object","assign","Animated","Value","mockAnimatedValue","timing","mockTiming","parallel","mockParallel","multiply","mockMultiply","View","ScrollView","TouchableOpacity","Text","LinearGradient","_ref","children","_require","require","_jsxRuntime","jsx","_interopRequireDefault","_asyncToGenerator2","_react","_reactNative","_CategorySelector","_require2","fn","start","cb","finished","interpolate","a","b","describe","categories","id","name","beforeEach","clearAllMocks","it","default","_render","render","selectedCategory","onSelectCategory","rerender","mockClear","act","expect","toHaveBeenCalledTimes","_render2"],"sources":["CategorySelector.test.js"],"sourcesContent":["// __tests__/components/exercise-common/CategorySelector.test.js\nimport React from \"react\";\nimport { render, act } from \"@testing-library/react-native\";\nimport CategorySelector from \"../../../src/components/exercise-common/CategorySelector\";\n\n// ðŸ”§ Mocks Animated API\nconst mockTiming = jest.fn(() => ({ start: jest.fn(cb => cb && cb({ finished: true })) }));\nconst mockParallel = jest.fn(() => ({ start: jest.fn(cb => cb && cb({ finished: true })) }));\nconst mockAnimatedValue = jest.fn(() => ({ interpolate: jest.fn() }));\nconst mockMultiply = jest.fn((a, b) => a || b);\n\njest.mock(\"react-native\", () => {\n  const RN = jest.requireActual(\"react-native\");\n  return {\n    ...RN,\n    Animated: {\n      ...RN.Animated,\n      Value: mockAnimatedValue,\n      timing: mockTiming,\n      parallel: mockParallel,\n      multiply: mockMultiply,\n      View: RN.Animated.View,\n    },\n    ScrollView: RN.ScrollView,\n    TouchableOpacity: RN.TouchableOpacity,\n    Text: RN.Text,\n    View: RN.View,\n  };\n});\n\n// Mock other dependencies\njest.mock('expo-linear-gradient', () => ({\n  LinearGradient: ({ children }) => {\n    const { View } = require('react-native');\n    return <View>{children}</View>;\n  },\n}));\n\ndescribe(\"CategorySelector - Animations\", () => {\n  const categories = [\n    { id: \"1\", name: \"Category 1\" },\n    { id: \"2\", name: \"Category 2\" },\n  ];\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it(\"triggers parallel animations when selectedCategory changes\", async () => {\n    const { rerender } = render(\n      <CategorySelector\n        categories={categories}\n        selectedCategory=\"1\"\n        onSelectCategory={jest.fn()}\n      />\n    );\n    \n    // Le composant est rendu initialement, on efface les appels initiaux.\n    mockParallel.mockClear();\n    mockTiming.mockClear();\n    \n    // Changing props inside `act` will trigger useEffect and animations\n    await act(async () => {\n      rerender(\n        <CategorySelector\n          categories={categories}\n          selectedCategory=\"2\"\n          onSelectCategory={jest.fn()}\n        />\n      );\n    });\n    \n    // Now, assert that the animations were called\n    expect(mockParallel).toHaveBeenCalledTimes(1);\n    expect(mockTiming).toHaveBeenCalledTimes(2);\n  });\n\n  it(\"prevents animation conflicts with isAnimatingRef\", async () => {\n    const { rerender } = render(\n      <CategorySelector\n        categories={categories}\n        selectedCategory=\"1\"\n        onSelectCategory={jest.fn()}\n      />\n    );\n    \n    // Clear initial calls\n    mockParallel.mockClear();\n    mockTiming.mockClear();\n\n    // First transition: should trigger an animation\n    await act(async () => {\n      rerender(\n        <CategorySelector\n          categories={categories}\n          selectedCategory=\"2\"\n          onSelectCategory={jest.fn()}\n        />\n      );\n    });\n\n    expect(mockParallel).toHaveBeenCalledTimes(1);\n    \n    // Second, immediate transition: should be prevented by isAnimatingRef\n    await act(async () => {\n      rerender(\n        <CategorySelector\n          categories={categories}\n          selectedCategory=\"1\"\n          onSelectCategory={jest.fn()}\n        />\n      );\n    });\n\n    // mockParallel should not have increased\n    expect(mockParallel).toHaveBeenCalledTimes(1);\n  });\n});"],"mappings":"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","ignoreList":[]}