2975aaea7f07a9f4891bd762465cfba5
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var Blob = function () {
  function Blob() {
    var parts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    var options = arguments.length > 1 ? arguments[1] : undefined;
    (0, _classCallCheck2.default)(this, Blob);
    var BlobManager = require('./BlobManager');
    this.data = BlobManager.createFromParts(parts, options).data;
  }
  return (0, _createClass2.default)(Blob, [{
    key: "data",
    get: function get() {
      if (!this._data) {
        throw new Error('Blob has been closed and is no longer available');
      }
      return this._data;
    },
    set: function set(data) {
      this._data = data;
    }
  }, {
    key: "slice",
    value: function slice(start, end) {
      var contentType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
      var BlobManager = require('./BlobManager');
      var _this$data = this.data,
        offset = _this$data.offset,
        size = _this$data.size;
      if (typeof start === 'number') {
        if (start > size) {
          start = size;
        }
        offset += start;
        size -= start;
        if (typeof end === 'number') {
          if (end < 0) {
            end = this.size + end;
          }
          if (end > this.size) {
            end = this.size;
          }
          size = end - start;
        }
      }
      return BlobManager.createFromOptions({
        blobId: this.data.blobId,
        offset: offset,
        size: size,
        type: contentType,
        __collector: this.data.__collector
      });
    }
  }, {
    key: "close",
    value: function close() {
      var BlobManager = require('./BlobManager');
      BlobManager.release(this.data.blobId);
      this.data = null;
    }
  }, {
    key: "size",
    get: function get() {
      return this.data.size;
    }
  }, {
    key: "type",
    get: function get() {
      return this.data.type || '';
    }
  }]);
}();
module.exports = Blob;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiQmxvYiIsInBhcnRzIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwib3B0aW9ucyIsImRlZmF1bHQiLCJCbG9iTWFuYWdlciIsImRhdGEiLCJjcmVhdGVGcm9tUGFydHMiLCJrZXkiLCJnZXQiLCJfZGF0YSIsIkVycm9yIiwic2V0IiwidmFsdWUiLCJzbGljZSIsInN0YXJ0IiwiZW5kIiwiY29udGVudFR5cGUiLCJfdGhpcyRkYXRhIiwib2Zmc2V0Iiwic2l6ZSIsImNyZWF0ZUZyb21PcHRpb25zIiwiYmxvYklkIiwidHlwZSIsIl9fY29sbGVjdG9yIiwiY2xvc2UiLCJyZWxlYXNlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIkJsb2IuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93IHN0cmljdC1sb2NhbFxuICogQGZvcm1hdFxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuaW1wb3J0IHR5cGUge0Jsb2JEYXRhLCBCbG9iT3B0aW9uc30gZnJvbSAnLi9CbG9iVHlwZXMnO1xuXG4vKipcbiAqIE9wYXF1ZSBKUyByZXByZXNlbnRhdGlvbiBvZiBzb21lIGJpbmFyeSBkYXRhIGluIG5hdGl2ZS5cbiAqXG4gKiBUaGUgQVBJIGlzIG1vZGVsZWQgYWZ0ZXIgdGhlIFczQyBCbG9iIEFQSSwgd2l0aCBvbmUgY2F2ZWF0XG4gKiByZWdhcmRpbmcgZXhwbGljaXQgZGVhbGxvY2F0aW9uLiBSZWZlciB0byB0aGUgYGNsb3NlKClgXG4gKiBtZXRob2QgZm9yIGZ1cnRoZXIgZGV0YWlscy5cbiAqXG4gKiBFeGFtcGxlIHVzYWdlIGluIGEgUmVhY3QgY29tcG9uZW50OlxuICpcbiAqICAgY2xhc3MgV2ViU29ja2V0SW1hZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICogICAgICBzdGF0ZSA9IHtibG9iOiBudWxsfTtcbiAqICAgICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gKiAgICAgICAgbGV0IHdzID0gdGhpcy53cyA9IG5ldyBXZWJTb2NrZXQoLi4uKTtcbiAqICAgICAgICB3cy5iaW5hcnlUeXBlID0gJ2Jsb2InO1xuICogICAgICAgIHdzLm9ubWVzc2FnZSA9IChldmVudCkgPT4ge1xuICogICAgICAgICAgaWYgKHRoaXMuc3RhdGUuYmxvYikge1xuICogICAgICAgICAgICB0aGlzLnN0YXRlLmJsb2IuY2xvc2UoKTtcbiAqICAgICAgICAgIH1cbiAqICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Jsb2I6IGV2ZW50LmRhdGF9KTtcbiAqICAgICAgICB9O1xuICogICAgICB9XG4gKiAgICAgIGNvbXBvbmVudFVubW91bnQoKSB7XG4gKiAgICAgICAgaWYgKHRoaXMuc3RhdGUuYmxvYikge1xuICogICAgICAgICAgdGhpcy5zdGF0ZS5ibG9iLmNsb3NlKCk7XG4gKiAgICAgICAgfVxuICogICAgICAgIHRoaXMud3MuY2xvc2UoKTtcbiAqICAgICAgfVxuICogICAgICByZW5kZXIoKSB7XG4gKiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmJsb2IpIHtcbiAqICAgICAgICAgIHJldHVybiA8VmlldyAvPjtcbiAqICAgICAgICB9XG4gKiAgICAgICAgcmV0dXJuIDxJbWFnZSBzb3VyY2U9e3t1cmk6IFVSTC5jcmVhdGVPYmplY3RVUkwodGhpcy5zdGF0ZS5ibG9iKX19IC8+O1xuICogICAgICB9XG4gKiAgIH1cbiAqXG4gKiBSZWZlcmVuY2U6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9CbG9iXG4gKi9cbmNsYXNzIEJsb2Ige1xuICBfZGF0YTogP0Jsb2JEYXRhO1xuXG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RvciBmb3IgSlMgY29uc3VtZXJzLlxuICAgKiBDdXJyZW50bHkgd2Ugb25seSBzdXBwb3J0IGNyZWF0aW5nIEJsb2JzIGZyb20gb3RoZXIgQmxvYnMuXG4gICAqIFJlZmVyZW5jZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0Jsb2IvQmxvYlxuICAgKi9cbiAgY29uc3RydWN0b3IocGFydHM6IEFycmF5PEJsb2IgfCBzdHJpbmc+ID0gW10sIG9wdGlvbnM/OiBCbG9iT3B0aW9ucykge1xuICAgIGNvbnN0IEJsb2JNYW5hZ2VyID0gcmVxdWlyZSgnLi9CbG9iTWFuYWdlcicpO1xuICAgIHRoaXMuZGF0YSA9IEJsb2JNYW5hZ2VyLmNyZWF0ZUZyb21QYXJ0cyhwYXJ0cywgb3B0aW9ucykuZGF0YTtcbiAgfVxuXG4gIC8qXG4gICAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gY3JlYXRlIGEgbmV3IEJsb2Igb2JqZWN0IGNvbnRhaW5pbmdcbiAgICogdGhlIGRhdGEgaW4gdGhlIHNwZWNpZmllZCByYW5nZSBvZiBieXRlcyBvZiB0aGUgc291cmNlIEJsb2IuXG4gICAqIFJlZmVyZW5jZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0Jsb2Ivc2xpY2VcbiAgICovXG4gIC8vICRGbG93Rml4TWVbdW5zYWZlLWdldHRlcnMtc2V0dGVyc11cbiAgc2V0IGRhdGEoZGF0YTogP0Jsb2JEYXRhKSB7XG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gIH1cblxuICAvLyAkRmxvd0ZpeE1lW3Vuc2FmZS1nZXR0ZXJzLXNldHRlcnNdXG4gIGdldCBkYXRhKCk6IEJsb2JEYXRhIHtcbiAgICBpZiAoIXRoaXMuX2RhdGEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQmxvYiBoYXMgYmVlbiBjbG9zZWQgYW5kIGlzIG5vIGxvbmdlciBhdmFpbGFibGUnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgfVxuXG4gIHNsaWNlKHN0YXJ0PzogbnVtYmVyLCBlbmQ/OiBudW1iZXIsIGNvbnRlbnRUeXBlOiBzdHJpbmcgPSAnJyk6IEJsb2Ige1xuICAgIGNvbnN0IEJsb2JNYW5hZ2VyID0gcmVxdWlyZSgnLi9CbG9iTWFuYWdlcicpO1xuICAgIGxldCB7b2Zmc2V0LCBzaXplfSA9IHRoaXMuZGF0YTtcblxuICAgIGlmICh0eXBlb2Ygc3RhcnQgPT09ICdudW1iZXInKSB7XG4gICAgICBpZiAoc3RhcnQgPiBzaXplKSB7XG4gICAgICAgIC8vICRGbG93Rml4TWVbcmVhc3NpZ24tY29uc3RdXG4gICAgICAgIHN0YXJ0ID0gc2l6ZTtcbiAgICAgIH1cbiAgICAgIG9mZnNldCArPSBzdGFydDtcbiAgICAgIHNpemUgLT0gc3RhcnQ7XG5cbiAgICAgIGlmICh0eXBlb2YgZW5kID09PSAnbnVtYmVyJykge1xuICAgICAgICBpZiAoZW5kIDwgMCkge1xuICAgICAgICAgIC8vICRGbG93Rml4TWVbcmVhc3NpZ24tY29uc3RdXG4gICAgICAgICAgZW5kID0gdGhpcy5zaXplICsgZW5kO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbmQgPiB0aGlzLnNpemUpIHtcbiAgICAgICAgICAvLyAkRmxvd0ZpeE1lW3JlYXNzaWduLWNvbnN0XVxuICAgICAgICAgIGVuZCA9IHRoaXMuc2l6ZTtcbiAgICAgICAgfVxuICAgICAgICBzaXplID0gZW5kIC0gc3RhcnQ7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBCbG9iTWFuYWdlci5jcmVhdGVGcm9tT3B0aW9ucyh7XG4gICAgICBibG9iSWQ6IHRoaXMuZGF0YS5ibG9iSWQsXG4gICAgICBvZmZzZXQsXG4gICAgICBzaXplLFxuICAgICAgdHlwZTogY29udGVudFR5cGUsXG4gICAgICAvKiBTaW5jZSBgYmxvYi5zbGljZSgpYCBjcmVhdGVzIGEgbmV3IHZpZXcgb250byB0aGUgc2FtZSBiaW5hcnlcbiAgICAgICAqIGRhdGEgYXMgdGhlIG9yaWdpbmFsIGJsb2IsIHdlIHNob3VsZCByZS11c2UgdGhlIHNhbWUgY29sbGVjdG9yXG4gICAgICAgKiBvYmplY3Qgc28gdGhhdCB0aGUgdW5kZXJseWluZyByZXNvdXJjZSBnZXRzIGRlYWxsb2NhdGVkIHdoZW5cbiAgICAgICAqIHRoZSBsYXN0IHZpZXcgaW50byB0aGUgZGF0YSBpcyByZWxlYXNlZCwgbm90IHRoZSBmaXJzdC5cbiAgICAgICAqL1xuICAgICAgX19jb2xsZWN0b3I6IHRoaXMuZGF0YS5fX2NvbGxlY3RvcixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIG1ldGhvZCBpcyBpbiB0aGUgc3RhbmRhcmQsIGJ1dCBub3QgYWN0dWFsbHkgaW1wbGVtZW50ZWQgYnlcbiAgICogYW55IGJyb3dzZXJzIGF0IHRoaXMgcG9pbnQuIEl0J3MgaW1wb3J0YW50IGZvciBob3cgQmxvYnMgd29yayBpblxuICAgKiBSZWFjdCBOYXRpdmUsIGhvd2V2ZXIsIHNpbmNlIHdlIGNhbm5vdCBkZS1hbGxvY2F0ZSByZXNvdXJjZXMgYXV0b21hdGljYWxseSxcbiAgICogc28gY29uc3VtZXJzIG5lZWQgdG8gZXhwbGljaXRseSBkZS1hbGxvY2F0ZSB0aGVtLlxuICAgKlxuICAgKiBOb3RlIHRoYXQgdGhlIHNlbWFudGljcyBhcm91bmQgQmxvYnMgY3JlYXRlZCB2aWEgYGJsb2Iuc2xpY2UoKWBcbiAgICogYW5kIGBuZXcgQmxvYihbYmxvYl0pYCBhcmUgZGlmZmVyZW50LiBgYmxvYi5zbGljZSgpYCBjcmVhdGVzIGFcbiAgICogbmV3ICp2aWV3KiBvbnRvIHRoZSBzYW1lIGJpbmFyeSBkYXRhLCBzbyBjYWxsaW5nIGBjbG9zZSgpYCBvbiBhbnlcbiAgICogb2YgdGhvc2Ugdmlld3MgaXMgZW5vdWdoIHRvIGRlYWxsb2NhdGUgdGhlIGRhdGEsIHdoZXJlYXNcbiAgICogYG5ldyBCbG9iKFtibG9iLCAuLi5dKWAgYWN0dWFsbHkgY29waWVzIHRoZSBkYXRhIGluIG1lbW9yeS5cbiAgICovXG4gIGNsb3NlKCkge1xuICAgIGNvbnN0IEJsb2JNYW5hZ2VyID0gcmVxdWlyZSgnLi9CbG9iTWFuYWdlcicpO1xuICAgIEJsb2JNYW5hZ2VyLnJlbGVhc2UodGhpcy5kYXRhLmJsb2JJZCk7XG4gICAgdGhpcy5kYXRhID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBTaXplIG9mIHRoZSBkYXRhIGNvbnRhaW5lZCBpbiB0aGUgQmxvYiBvYmplY3QsIGluIGJ5dGVzLlxuICAgKi9cbiAgLy8gJEZsb3dGaXhNZVt1bnNhZmUtZ2V0dGVycy1zZXR0ZXJzXVxuICBnZXQgc2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmRhdGEuc2l6ZTtcbiAgfVxuXG4gIC8qXG4gICAqIFN0cmluZyBpbmRpY2F0aW5nIHRoZSBNSU1FIHR5cGUgb2YgdGhlIGRhdGEgY29udGFpbmVkIGluIHRoZSBCbG9iLlxuICAgKiBJZiB0aGUgdHlwZSBpcyB1bmtub3duLCB0aGlzIHN0cmluZyBpcyBlbXB0eS5cbiAgICovXG4gIC8vICRGbG93Rml4TWVbdW5zYWZlLWdldHRlcnMtc2V0dGVyc11cbiAgZ2V0IHR5cGUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhLnR5cGUgfHwgJyc7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBCbG9iO1xuIl0sIm1hcHBpbmdzIjoiQUFVQSxZQUFZOztBQUFDLElBQUFBLHNCQUFBLEdBQUFDLE9BQUE7QUFBQSxJQUFBQyxnQkFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUFBQUUsYUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUF5Q1BHLElBQUk7RUFRUixTQUFBQSxLQUFBLEVBQXFFO0lBQUEsSUFBekRDLEtBQTJCLEdBQUFDLFNBQUEsQ0FBQUMsTUFBQSxRQUFBRCxTQUFBLFFBQUFF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