c81cc0fe477dd8ce90aef088e324f34c
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.NativeReanimated = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _checkCppVersion = require("../platform-specific/checkCppVersion");
var _jsVersion = require("../platform-specific/jsVersion");
var _valueUnpacker = require("../valueUnpacker");
var _PlatformChecker = require("../PlatformChecker");
var _fabricUtils = require("../fabricUtils");
var _NativeReanimatedModule = _interopRequireDefault(require("../specs/NativeReanimatedModule"));
var _errors = require("../errors");
function assertSingleReanimatedInstance() {
  if (global._REANIMATED_VERSION_JS !== undefined && global._REANIMATED_VERSION_JS !== _jsVersion.jsVersion) {
    throw new _errors.ReanimatedError(`Another instance of Reanimated was detected.
See \`https://docs.swmansion.com/react-native-reanimated/docs/guides/troubleshooting#another-instance-of-reanimated-was-detected\` for more details. Previous: ${global._REANIMATED_VERSION_JS}, current: ${_jsVersion.jsVersion}.`);
  }
}
var NativeReanimated = exports.NativeReanimated = function () {
  function NativeReanimated() {
    (0, _classCallCheck2.default)(this, NativeReanimated);
    if (__DEV__) {
      assertSingleReanimatedInstance();
    }
    global._REANIMATED_VERSION_JS = _jsVersion.jsVersion;
    if (global.__reanimatedModuleProxy === undefined) {
      var valueUnpackerCode = (0, _valueUnpacker.getValueUnpackerCode)();
      _NativeReanimatedModule.default == null || _NativeReanimatedModule.default.installTurboModule(valueUnpackerCode);
    }
    if (global.__reanimatedModuleProxy === undefined) {
      throw new _errors.ReanimatedError(`Native part of Reanimated doesn't seem to be initialized.
See https://docs.swmansion.com/react-native-reanimated/docs/guides/troubleshooting#native-part-of-reanimated-doesnt-seem-to-be-initialized for more details.`);
    }
    if (__DEV__) {
      (0, _checkCppVersion.checkCppVersion)();
    }
    this.InnerNativeModule = global.__reanimatedModuleProxy;
  }
  return (0, _createClass2.default)(NativeReanimated, [{
    key: "makeShareableClone",
    value: function makeShareableClone(value, shouldPersistRemote, nativeStateSource) {
      return this.InnerNativeModule.makeShareableClone(value, shouldPersistRemote, nativeStateSource);
    }
  }, {
    key: "scheduleOnUI",
    value: function scheduleOnUI(shareable) {
      return this.InnerNativeModule.scheduleOnUI(shareable);
    }
  }, {
    key: "executeOnUIRuntimeSync",
    value: function executeOnUIRuntimeSync(shareable) {
      return this.InnerNativeModule.executeOnUIRuntimeSync(shareable);
    }
  }, {
    key: "createWorkletRuntime",
    value: function createWorkletRuntime(name, initializer) {
      return this.InnerNativeModule.createWorkletRuntime(name, initializer);
    }
  }, {
    key: "scheduleOnRuntime",
    value: function scheduleOnRuntime(workletRuntime, shareableWorklet) {
      return this.InnerNativeModule.scheduleOnRuntime(workletRuntime, shareableWorklet);
    }
  }, {
    key: "registerSensor",
    value: function registerSensor(sensorType, interval, iosReferenceFrame, handler) {
      return this.InnerNativeModule.registerSensor(sensorType, interval, iosReferenceFrame, handler);
    }
  }, {
    key: "unregisterSensor",
    value: function unregisterSensor(sensorId) {
      return this.InnerNativeModule.unregisterSensor(sensorId);
    }
  }, {
    key: "registerEventHandler",
    value: function registerEventHandler(eventHandler, eventName, emitterReactTag) {
      return this.InnerNativeModule.registerEventHandler(eventHandler, eventName, emitterReactTag);
    }
  }, {
    key: "unregisterEventHandler",
    value: function unregisterEventHandler(id) {
      return this.InnerNativeModule.unregisterEventHandler(id);
    }
  }, {
    key: "getViewProp",
    value: function getViewProp(viewTag, propName, component, callback) {
      var shadowNodeWrapper;
      if ((0, _PlatformChecker.isFabric)()) {
        shadowNodeWrapper = (0, _fabricUtils.getShadowNodeWrapperFromRef)(component);
        return this.InnerNativeModule.getViewProp(shadowNodeWrapper, propName, callback);
      }
      return this.InnerNativeModule.getViewProp(viewTag, propName, callback);
    }
  }, {
    key: "configureLayoutAnimationBatch",
    value: function configureLayoutAnimationBatch(layoutAnimationsBatch) {
      this.InnerNativeModule.configureLayoutAnimationBatch(layoutAnimationsBatch);
    }
  }, {
    key: "setShouldAnimateExitingForTag",
    value: function setShouldAnimateExitingForTag(viewTag, shouldAnimate) {
      this.InnerNativeModule.setShouldAnimateExitingForTag(viewTag, shouldAnimate);
    }
  }, {
    key: "enableLayoutAnimations",
    value: function enableLayoutAnimations(flag) {
      this.InnerNativeModule.enableLayoutAnimations(flag);
    }
  }, {
    key: "configureProps",
    value: function configureProps(uiProps, nativeProps) {
      this.InnerNativeModule.configureProps(uiProps, nativeProps);
    }
  }, {
    key: "subscribeForKeyboardEvents",
    value: function subscribeForKeyboardEvents(handler, isStatusBarTranslucent, isNavigationBarTranslucent) {
      return this.InnerNativeModule.subscribeForKeyboardEvents(handler, isStatusBarTranslucent, isNavigationBarTranslucent);
    }
  }, {
    key: "unsubscribeFromKeyboardEvents",
    value: function unsubscribeFromKeyboardEvents(listenerId) {
      this.InnerNativeModule.unsubscribeFromKeyboardEvents(listenerId);
    }
  }]);
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiTmF0aXZlUmVhbmltYXRlZCIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiX2NoZWNrQ3BwVmVyc2lvbiIsIl9qc1ZlcnNpb24iLCJfdmFsdWVVbnBhY2tlciIsIl9QbGF0Zm9ybUNoZWNrZXIiLCJfZmFicmljVXRpbHMiLCJfTmF0aXZlUmVhbmltYXRlZE1vZHVsZSIsIl9lcnJvcnMiLCJhc3NlcnRTaW5nbGVSZWFuaW1hdGVkSW5zdGFuY2UiLCJnbG9iYWwiLCJfUkVBTklNQVRFRF9WRVJTSU9OX0pTIiwidW5kZWZpbmVkIiwianNWZXJzaW9uIiwiUmVhbmltYXRlZEVycm9yIiwiZGVmYXVsdCIsIl9fREVWX18iLCJfX3JlYW5pbWF0ZWRNb2R1bGVQcm94eSIsInZhbHVlVW5wYWNrZXJDb2RlIiwiZ2V0VmFsdWVVbnBhY2tlckNvZGUiLCJSZWFuaW1hdGVkTW9kdWxlIiwiaW5zdGFsbFR1cmJvTW9kdWxlIiwiY2hlY2tDcHBWZXJzaW9uIiwiSW5uZXJOYXRpdmVNb2R1bGUiLCJrZXkiLCJtYWtlU2hhcmVhYmxlQ2xvbmUiLCJzaG91bGRQZXJzaXN0UmVtb3RlIiwibmF0aXZlU3RhdGVTb3VyY2UiLCJzY2hlZHVsZU9uVUkiLCJzaGFyZWFibGUiLCJleGVjdXRlT25VSVJ1bnRpbWVTeW5jIiwiY3JlYXRlV29ya2xldFJ1bnRpbWUiLCJuYW1lIiwiaW5pdGlhbGl6ZXIiLCJzY2hlZHVsZU9uUnVudGltZSIsIndvcmtsZXRSdW50aW1lIiwic2hhcmVhYmxlV29ya2xldCIsInJlZ2lzdGVyU2Vuc29yIiwic2Vuc29yVHlwZSIsImludGVydmFsIiwiaW9zUmVmZXJlbmNlRnJhbWUiLCJoYW5kbGVyIiwidW5yZWdpc3RlclNlbnNvciIsInNlbnNvcklkIiwicmVnaXN0ZXJFdmVudEhhbmRsZXIiLCJldmVudEhhbmRsZXIiLCJldmVudE5hbWUiLCJlbWl0dGVyUmVhY3RUYWciLCJ1bnJlZ2lzdGVyRXZlbnRIYW5kbGVyIiwiaWQiLCJnZXRWaWV3UHJvcCIsInZpZXdUYWciLCJwcm9wTmFtZSIsImNvbXBvbmVudCIsImNhbGxiYWNrIiwic2hhZG93Tm9kZVdyYXBwZXIiLCJpc0ZhYnJpYyIsImdldFNoYWRvd05vZGVXcmFwcGVyRnJvbVJlZiIsImNvbmZpZ3VyZUxheW91dEFuaW1hdGlvbkJhdGNoIiwibGF5b3V0QW5pbWF0aW9uc0JhdGNoIiwic2V0U2hvdWxkQW5pbWF0ZUV4aXRpbmdGb3JUYWciLCJzaG91bGRBbmltYXRlIiwiZW5hYmxlTGF5b3V0QW5pbWF0aW9ucyIsImZsYWciLCJjb25maWd1cmVQcm9wcyIsInVpUHJvcHMiLCJuYXRpdmVQcm9wcyIsInN1YnNjcmliZUZvcktleWJvYXJkRXZlbnRzIiwiaXNTdGF0dXNCYXJUcmFuc2x1Y2VudCIsImlzTmF2aWdhdGlvbkJhclRyYW5zbHVjZW50IiwidW5zdWJzY3JpYmVGcm9tS2V5Ym9hcmRFdmVudHMiLCJsaXN0ZW5lcklkIl0sInNvdXJjZXMiOlsiTmF0aXZlUmVhbmltYXRlZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5pbXBvcnQgdHlwZSB7XG4gIFNoYWRvd05vZGVXcmFwcGVyLFxuICBWYWx1ZTNELFxuICBWYWx1ZVJvdGF0aW9uLFxuICBTaGFyZWFibGVSZWYsXG59IGZyb20gJy4uL2NvbW1vblR5cGVzJztcbmltcG9ydCB7IGNoZWNrQ3BwVmVyc2lvbiB9IGZyb20gJy4uL3BsYXRmb3JtLXNwZWNpZmljL2NoZWNrQ3BwVmVyc2lvbic7XG5pbXBvcnQgeyBqc1ZlcnNpb24gfSBmcm9tICcuLi9wbGF0Zm9ybS1zcGVjaWZpYy9qc1ZlcnNpb24nO1xuaW1wb3J0IHR5cGUgeyBXb3JrbGV0UnVudGltZSB9IGZyb20gJy4uL3J1bnRpbWVzJztcbmltcG9ydCB7IGdldFZhbHVlVW5wYWNrZXJDb2RlIH0gZnJvbSAnLi4vdmFsdWVVbnBhY2tlcic7XG5pbXBvcnQgeyBpc0ZhYnJpYyB9IGZyb20gJy4uL1BsYXRmb3JtQ2hlY2tlcic7XG5pbXBvcnQgdHlwZSBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBnZXRTaGFkb3dOb2RlV3JhcHBlckZyb21SZWYgfSBmcm9tICcuLi9mYWJyaWNVdGlscyc7XG5pbXBvcnQgdHlwZSB7IExheW91dEFuaW1hdGlvbkJhdGNoSXRlbSB9IGZyb20gJy4uL2xheW91dFJlYW5pbWF0aW9uL2FuaW1hdGlvbkJ1aWxkZXIvY29tbW9uVHlwZXMnO1xuaW1wb3J0IFJlYW5pbWF0ZWRNb2R1bGUgZnJvbSAnLi4vc3BlY3MvTmF0aXZlUmVhbmltYXRlZE1vZHVsZSc7XG5pbXBvcnQgeyBSZWFuaW1hdGVkRXJyb3IgfSBmcm9tICcuLi9lcnJvcnMnO1xuXG4vLyB0aGlzIGlzIHRoZSB0eXBlIG9mIGBfX3JlYW5pbWF0ZWRNb2R1bGVQcm94eWAgd2hpY2ggaXMgaW5qZWN0ZWQgdXNpbmcgSlNJXG5leHBvcnQgaW50ZXJmYWNlIE5hdGl2ZVJlYW5pbWF0ZWRNb2R1bGUge1xuICBtYWtlU2hhcmVhYmxlQ2xvbmU8VD4oXG4gICAgdmFsdWU6IFQsXG4gICAgc2hvdWxkUGVyc2lzdFJlbW90ZTogYm9vbGVhbixcbiAgICBuYXRpdmVTdGF0ZVNvdXJjZT86IG9iamVjdFxuICApOiBTaGFyZWFibGVSZWY8VD47XG4gIHNjaGVkdWxlT25VSTxUPihzaGFyZWFibGU6IFNoYXJlYWJsZVJlZjxUPik6IHZvaWQ7XG4gIGV4ZWN1dGVPblVJUnVudGltZVN5bmM8VCwgUj4oc2hhcmVhYmxlOiBTaGFyZWFibGVSZWY8VD4pOiBSO1xuICBjcmVhdGVXb3JrbGV0UnVudGltZShcbiAgICBuYW1lOiBzdHJpbmcsXG4gICAgaW5pdGlhbGl6ZXI6IFNoYXJlYWJsZVJlZjwoKSA9PiB2b2lkPlxuICApOiBXb3JrbGV0UnVudGltZTtcbiAgc2NoZWR1bGVPblJ1bnRpbWU8VD4oXG4gICAgd29ya2xldFJ1bnRpbWU6IFdvcmtsZXRSdW50aW1lLFxuICAgIHdvcmtsZXQ6IFNoYXJlYWJsZVJlZjxUPlxuICApOiB2b2lkO1xuICByZWdpc3RlckV2ZW50SGFuZGxlcjxUPihcbiAgICBldmVudEhhbmRsZXI6IFNoYXJlYWJsZVJlZjxUPixcbiAgICBldmVudE5hbWU6IHN0cmluZyxcbiAgICBlbWl0dGVyUmVhY3RUYWc6IG51bWJlclxuICApOiBudW1iZXI7XG4gIHVucmVnaXN0ZXJFdmVudEhhbmRsZXIoaWQ6IG51bWJlcik6IHZvaWQ7XG4gIGdldFZpZXdQcm9wPFQ+KFxuICAgIHZpZXdUYWdPclNoYWRvd05vZGVXcmFwcGVyOiBudW1iZXIgfCBTaGFkb3dOb2RlV3JhcHBlcixcbiAgICBwcm9wTmFtZTogc3RyaW5nLFxuICAgIGNhbGxiYWNrPzogKHJlc3VsdDogVCkgPT4gdm9pZFxuICApOiBQcm9taXNlPFQ+O1xuICBlbmFibGVMYXlvdXRBbmltYXRpb25zKGZsYWc6IGJvb2xlYW4pOiB2b2lkO1xuICByZWdpc3RlclNlbnNvcihcbiAgICBzZW5zb3JUeXBlOiBudW1iZXIsXG4gICAgaW50ZXJ2YWw6IG51bWJlcixcbiAgICBpb3NSZWZlcmVuY2VGcmFtZTogbnVtYmVyLFxuICAgIGhhbmRsZXI6IFNoYXJlYWJsZVJlZjwoZGF0YTogVmFsdWUzRCB8IFZhbHVlUm90YXRpb24pID0+IHZvaWQ+XG4gICk6IG51bWJlcjtcbiAgdW5yZWdpc3RlclNlbnNvcihzZW5zb3JJZDogbnVtYmVyKTogdm9pZDtcbiAgY29uZmlndXJlUHJvcHModWlQcm9wczogc3RyaW5nW10sIG5hdGl2ZVByb3BzOiBzdHJpbmdbXSk6IHZvaWQ7XG4gIHN1YnNjcmliZUZvcktleWJvYXJkRXZlbnRzKFxuICAgIGhhbmRsZXI6IFNoYXJlYWJsZVJlZjxudW1iZXI+LFxuICAgIGlzU3RhdHVzQmFyVHJhbnNsdWNlbnQ6IGJvb2xlYW4sXG4gICAgaXNOYXZpZ2F0aW9uQmFyVHJhbnNsdWNlbnQ6IGJvb2xlYW5cbiAgKTogbnVtYmVyO1xuICB1bnN1YnNjcmliZUZyb21LZXlib2FyZEV2ZW50cyhsaXN0ZW5lcklkOiBudW1iZXIpOiB2b2lkO1xuICBjb25maWd1cmVMYXlvdXRBbmltYXRpb25CYXRjaChcbiAgICBsYXlvdXRBbmltYXRpb25zQmF0Y2g6IExheW91dEFuaW1hdGlvbkJhdGNoSXRlbVtdXG4gICk6IHZvaWQ7XG4gIHNldFNob3VsZEFuaW1hdGVFeGl0aW5nRm9yVGFnKHZpZXdUYWc6IG51bWJlciwgc2hvdWxkQW5pbWF0ZTogYm9vbGVhbik6IHZvaWQ7XG59XG5cbmZ1bmN0aW9uIGFzc2VydFNpbmdsZVJlYW5pbWF0ZWRJbnN0YW5jZSgpIHtcbiAgaWYgKFxuICAgIGdsb2JhbC5fUkVBTklNQVRFRF9WRVJTSU9OX0pTICE9PSB1bmRlZmluZWQgJiZcbiAgICBnbG9iYWwuX1JFQU5JTUFURURfVkVSU0lPTl9KUyAhPT0ganNWZXJzaW9uXG4gICkge1xuICAgIHRocm93IG5ldyBSZWFuaW1hdGVkRXJyb3IoXG4gICAgICBgQW5vdGhlciBpbnN0YW5jZSBvZiBSZWFuaW1hdGVkIHdhcyBkZXRlY3RlZC5cblNlZSBcXGBodHRwczovL2RvY3Muc3dtYW5zaW9uLmNvbS9yZWFjdC1uYXRpdmUtcmVhbmltYXRlZC9kb2NzL2d1aWRlcy90cm91Ymxlc2hvb3RpbmcjYW5vdGhlci1pbnN0YW5jZS1vZi1yZWFuaW1hdGVkLXdhcy1kZXRlY3RlZFxcYCBmb3IgbW9yZSBkZXRhaWxzLiBQcmV2aW91czogJHtnbG9iYWwuX1JFQU5JTUFURURfVkVSU0lPTl9KU30sIGN1cnJlbnQ6ICR7anNWZXJzaW9ufS5gXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTmF0aXZlUmVhbmltYXRlZCB7XG4gIHByaXZhdGUgSW5uZXJOYXRpdmVNb2R1bGU6IE5hdGl2ZVJlYW5pbWF0ZWRNb2R1bGU7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8gVGhlc2UgY2hlY2tzIGhhdmUgdG8gc3BsaXQgc2luY2UgdmVyc2lvbiBjaGVja2luZyBkZXBlbmQgb24gdGhlIGV4ZWN1dGlvbiBvcmRlclxuICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICBhc3NlcnRTaW5nbGVSZWFuaW1hdGVkSW5zdGFuY2UoKTtcbiAgICB9XG4gICAgZ2xvYmFsLl9SRUFOSU1BVEVEX1ZFUlNJT05fSlMgPSBqc1ZlcnNpb247XG4gICAgaWYgKGdsb2JhbC5fX3JlYW5pbWF0ZWRNb2R1bGVQcm94eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCB2YWx1ZVVucGFja2VyQ29kZSA9IGdldFZhbHVlVW5wYWNrZXJDb2RlKCk7XG4gICAgICBSZWFuaW1hdGVkTW9kdWxlPy5pbnN0YWxsVHVyYm9Nb2R1bGUodmFsdWVVbnBhY2tlckNvZGUpO1xuICAgIH1cbiAgICBpZiAoZ2xvYmFsLl9fcmVhbmltYXRlZE1vZHVsZVByb3h5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBSZWFuaW1hdGVkRXJyb3IoXG4gICAgICAgIGBOYXRpdmUgcGFydCBvZiBSZWFuaW1hdGVkIGRvZXNuJ3Qgc2VlbSB0byBiZSBpbml0aWFsaXplZC5cblNlZSBodHRwczovL2RvY3Muc3dtYW5zaW9uLmNvbS9yZWFjdC1uYXRpdmUtcmVhbmltYXRlZC9kb2NzL2d1aWRlcy90cm91Ymxlc2hvb3RpbmcjbmF0aXZlLXBhcnQtb2YtcmVhbmltYXRlZC1kb2VzbnQtc2VlbS10by1iZS1pbml0aWFsaXplZCBmb3IgbW9yZSBkZXRhaWxzLmBcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICBjaGVja0NwcFZlcnNpb24oKTtcbiAgICB9XG4gICAgdGhpcy5Jbm5lck5hdGl2ZU1vZHVsZSA9IGdsb2JhbC5fX3JlYW5pbWF0ZWRNb2R1bGVQcm94eTtcbiAgfVxuXG4gIG1ha2VTaGFyZWFibGVDbG9uZTxUPihcbiAgICB2YWx1ZTogVCxcbiAgICBzaG91bGRQZXJzaXN0UmVtb3RlOiBib29sZWFuLFxuICAgIG5hdGl2ZVN0YXRlU291cmNlPzogb2JqZWN0XG4gICkge1xuICAgIHJldHVybiB0aGlzLklubmVyTmF0aXZlTW9kdWxlLm1ha2VTaGFyZWFibGVDbG9uZShcbiAgICAgIHZhbHVlLFxuICAgICAgc2hvdWxkUGVyc2lzdFJlbW90ZSxcbiAgICAgIG5hdGl2ZVN0YXRlU291cmNlXG4gICAgKTtcbiAgfVxuXG4gIHNjaGVkdWxlT25VSTxUPihzaGFyZWFibGU6IFNoYXJlYWJsZVJlZjxUPikge1xuICAgIHJldHVybiB0aGlzLklubmVyTmF0aXZlTW9kdWxlLnNjaGVkdWxlT25VSShzaGFyZWFibGUpO1xuICB9XG5cbiAgZXhlY3V0ZU9uVUlSdW50aW1lU3luYzxULCBSPihzaGFyZWFibGU6IFNoYXJlYWJsZVJlZjxUPik6IFIge1xuICAgIHJldHVybiB0aGlzLklubmVyTmF0aXZlTW9kdWxlLmV4ZWN1dGVPblVJUnVudGltZVN5bmMoc2hhcmVhYmxlKTtcbiAgfVxuXG4gIGNyZWF0ZVdvcmtsZXRSdW50aW1lKG5hbWU6IHN0cmluZywgaW5pdGlhbGl6ZXI6IFNoYXJlYWJsZVJlZjwoKSA9PiB2b2lkPikge1xuICAgIHJldHVybiB0aGlzLklubmVyTmF0aXZlTW9kdWxlLmNyZWF0ZVdvcmtsZXRSdW50aW1lKG5hbWUsIGluaXRpYWxpemVyKTtcbiAgfVxuXG4gIHNjaGVkdWxlT25SdW50aW1lPFQ+KFxuICAgIHdvcmtsZXRSdW50aW1lOiBXb3JrbGV0UnVudGltZSxcbiAgICBzaGFyZWFibGVXb3JrbGV0OiBTaGFyZWFibGVSZWY8VD5cbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMuSW5uZXJOYXRpdmVNb2R1bGUuc2NoZWR1bGVPblJ1bnRpbWUoXG4gICAgICB3b3JrbGV0UnVudGltZSxcbiAgICAgIHNoYXJlYWJsZVdvcmtsZXRcbiAgICApO1xuICB9XG5cbiAgcmVnaXN0ZXJTZW5zb3IoXG4gICAgc2Vuc29yVHlwZTogbnVtYmVyLFxuICAgIGludGVydmFsOiBudW1iZXIsXG4gICAgaW9zUmVmZXJlbmNlRnJhbWU6IG51bWJlcixcbiAgICBoYW5kbGVyOiBTaGFyZWFibGVSZWY8KGRhdGE6IFZhbHVlM0QgfCBWYWx1ZVJvdGF0aW9uKSA9PiB2b2lkPlxuICApIHtcbiAgICByZXR1cm4gdGhpcy5Jbm5lck5hdGl2ZU1vZHVsZS5yZWdpc3RlclNlbnNvcihcbiAgICAgIHNlbnNvclR5cGUsXG4gICAgICBpbnRlcnZhbCxcbiAgICAgIGlvc1JlZmVyZW5jZUZyYW1lLFxuICAgICAgaGFuZGxlclxuICAgICk7XG4gIH1cblxuICB1bnJlZ2lzdGVyU2Vuc29yKHNlbnNvcklkOiBudW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy5Jbm5lck5hdGl2ZU1vZHVsZS51bnJlZ2lzdGVyU2Vuc29yKHNlbnNvcklkKTtcbiAgfVxuXG4gIHJlZ2lzdGVyRXZlbnRIYW5kbGVyPFQ+KFxuICAgIGV2ZW50SGFuZGxlcjogU2hhcmVhYmxlUmVmPFQ+LFxuICAgIGV2ZW50TmFtZTogc3RyaW5nLFxuICAgIGVtaXR0ZXJSZWFjdFRhZzogbnVtYmVyXG4gICkge1xuICAgIHJldHVybiB0aGlzLklubmVyTmF0aXZlTW9kdWxlLnJlZ2lzdGVyRXZlbnRIYW5kbGVyKFxuICAgICAgZXZlbnRIYW5kbGVyLFxuICAgICAgZXZlbnROYW1lLFxuICAgICAgZW1pdHRlclJlYWN0VGFnXG4gICAgKTtcbiAgfVxuXG4gIHVucmVnaXN0ZXJFdmVudEhhbmRsZXIoaWQ6IG51bWJlcikge1xuICAgIHJldHVybiB0aGlzLklubmVyTmF0aXZlTW9kdWxlLnVucmVnaXN0ZXJFdmVudEhhbmRsZXIoaWQpO1xuICB9XG5cbiAgZ2V0Vmlld1Byb3A8VD4oXG4gICAgdmlld1RhZzogbnVtYmVyLFxuICAgIHByb3BOYW1lOiBzdHJpbmcsXG4gICAgY29tcG9uZW50OiBSZWFjdC5Db21wb25lbnQgfCB1bmRlZmluZWQsIC8vIHJlcXVpcmVkIG9uIEZhYnJpY1xuICAgIGNhbGxiYWNrPzogKHJlc3VsdDogVCkgPT4gdm9pZFxuICApIHtcbiAgICBsZXQgc2hhZG93Tm9kZVdyYXBwZXI7XG4gICAgaWYgKGlzRmFicmljKCkpIHtcbiAgICAgIHNoYWRvd05vZGVXcmFwcGVyID0gZ2V0U2hhZG93Tm9kZVdyYXBwZXJGcm9tUmVmKFxuICAgICAgICBjb21wb25lbnQgYXMgUmVhY3QuQ29tcG9uZW50XG4gICAgICApO1xuICAgICAgcmV0dXJuIHRoaXMuSW5uZXJOYXRpdmVNb2R1bGUuZ2V0Vmlld1Byb3AoXG4gICAgICAgIHNoYWRvd05vZGVXcmFwcGVyLFxuICAgICAgICBwcm9wTmFtZSxcbiAgICAgICAgY2FsbGJhY2tcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuSW5uZXJOYXRpdmVNb2R1bGUuZ2V0Vmlld1Byb3Aodmlld1RhZywgcHJvcE5hbWUsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIGNvbmZpZ3VyZUxheW91dEFuaW1hdGlvbkJhdGNoKFxuICAgIGxheW91dEFuaW1hdGlvbnNCYXRjaDogTGF5b3V0QW5pbWF0aW9uQmF0Y2hJdGVtW11cbiAgKSB7XG4gICAgdGhpcy5Jbm5lck5hdGl2ZU1vZHVsZS5jb25maWd1cmVMYXlvdXRBbmltYXRpb25CYXRjaChsYXlvdXRBbmltYXRpb25zQmF0Y2gpO1xuICB9XG5cbiAgc2V0U2hvdWxkQW5pbWF0ZUV4aXRpbmdGb3JUYWcodmlld1RhZzogbnVtYmVyLCBzaG91bGRBbmltYXRlOiBib29sZWFuKSB7XG4gICAgdGhpcy5Jbm5lck5hdGl2ZU1vZHVsZS5zZXRTaG91bGRBbmltYXRlRXhpdGluZ0ZvclRhZyhcbiAgICAgIHZpZXdUYWcsXG4gICAgICBzaG91bGRBbmltYXRlXG4gICAgKTtcbiAgfVxuXG4gIGVuYWJsZUxheW91dEFuaW1hdGlvbnMoZmxhZzogYm9vbGVhbikge1xuICAgIHRoaXMuSW5uZXJOYXRpdmVNb2R1bGUuZW5hYmxlTGF5b3V0QW5pbWF0aW9ucyhmbGFnKTtcbiAgfVxuXG4gIGNvbmZpZ3VyZVByb3BzKHVpUHJvcHM6IHN0cmluZ1tdLCBuYXRpdmVQcm9wczogc3RyaW5nW10pIHtcbiAgICB0aGlzLklubmVyTmF0aXZlTW9kdWxlLmNvbmZpZ3VyZVByb3BzKHVpUHJvcHMsIG5hdGl2ZVByb3BzKTtcbiAgfVxuXG4gIHN1YnNjcmliZUZvcktleWJvYXJkRXZlbnRzKFxuICAgIGhhbmRsZXI6IFNoYXJlYWJsZVJlZjxudW1iZXI+LFxuICAgIGlzU3RhdHVzQmFyVHJhbnNsdWNlbnQ6IGJvb2xlYW4sXG4gICAgaXNOYXZpZ2F0aW9uQmFyVHJhbnNsdWNlbnQ6IGJvb2xlYW5cbiAgKSB7XG4gICAgcmV0dXJuIHRoaXMuSW5uZXJOYXRpdmVNb2R1bGUuc3Vic2NyaWJlRm9yS2V5Ym9hcmRFdmVudHMoXG4gICAgICBoYW5kbGVyLFxuICAgICAgaXNTdGF0dXNCYXJUcmFuc2x1Y2VudCxcbiAgICAgIGlzTmF2aWdhdGlvbkJhclRyYW5zbHVjZW50XG4gICAgKTtcbiAgfVxuXG4gIHVuc3Vic2NyaWJlRnJvbUtleWJvYXJkRXZlbnRzKGxpc3RlbmVySWQ6IG51bWJlcikge1xuICAgIHRoaXMuSW5uZXJOYXRpdmVNb2R1bGUudW5zdWJzY3JpYmVGcm9tS2V5Ym9hcmRFdmVudHMobGlzdGVuZXJJZCk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFBQyxJQUFBQSxzQkFBQSxHQUFBQyxPQUFBO0FBQUFDLE1BQUEsQ0FBQUMsY0FBQSxDQUFBQyxPQUFBO0VBQUFDLEtBQUE7QUFBQTtBQUFBRCxPQUFBLENBQUFFLGdCQUFBO0FBQUEsSUFBQUMsZ0JBQUEsR0FBQVAsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFPLGFBQUEsR0FBQVIsc0JBQUEsQ0FBQUMsT0FBQTtBQU9iLElBQUFRLGdCQUFBLEdBQUFSLE9BQUE7QUFDQSxJQUFBUyxVQUFBLEdBQUFULE9BQUE7QUFFQSxJQUFBVSxjQUFBLEdBQUFWLE9BQUE7QUFDQSxJQUFBVyxnQkFBQSxHQUFBWCxPQUFBO0FBRUEsSUFBQVksWUFBQSxHQUFBWixPQUFBO0FBRUEsSUFBQWEsdUJBQUEsR0FBQWQsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFjLE9BQUEsR0FBQWQsT0FBQTtBQW1EQSxTQUFTZSw4QkFB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