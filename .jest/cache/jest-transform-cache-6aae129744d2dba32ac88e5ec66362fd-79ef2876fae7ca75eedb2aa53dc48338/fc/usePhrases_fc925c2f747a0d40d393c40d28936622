6ebf623e1f4e86e558eaed2afe19088e
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var _reactNative = require("react-native");
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var usePhrases = function usePhrases() {
  var phrasesData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
  var level = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "A1";
  var _useState = (0, _react.useState)(0),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    categoryIndex = _useState2[0],
    setCategoryIndex = _useState2[1];
  var _useState3 = (0, _react.useState)(0),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    phraseIndex = _useState4[0],
    setPhraseIndex = _useState4[1];
  var _useState5 = (0, _react.useState)(false),
    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),
    showTranslation = _useState6[0],
    setShowTranslation = _useState6[1];
  var _useState7 = (0, _react.useState)({}),
    _useState8 = (0, _slicedToArray2.default)(_useState7, 2),
    completedPhrases = _useState8[0],
    setCompletedPhrases = _useState8[1];
  var _useState9 = (0, _react.useState)(false),
    _useState0 = (0, _slicedToArray2.default)(_useState9, 2),
    loaded = _useState0[0],
    setLoaded = _useState0[1];
  var _useState1 = (0, _react.useState)(false),
    _useState10 = (0, _slicedToArray2.default)(_useState1, 2),
    showDetailedProgress = _useState10[0],
    setShowDetailedProgress = _useState10[1];
  var isInitialized = (0, _react.useRef)(false);
  var categories = (phrasesData == null ? void 0 : phrasesData.categories) || [];
  var allPhrases = (phrasesData == null ? void 0 : phrasesData.phrases) || [];
  var currentCategory = categories[categoryIndex] || {
    id: null,
    name: "Loading...",
    phrases: []
  };
  var currentPhrases = currentCategory.id ? allPhrases.filter(function (phrase) {
    return phrase.categoryId === currentCategory.id;
  }) : [];
  var currentPhrase = currentPhrases[phraseIndex] || {
    id: "",
    phrase: "",
    translation: "",
    context: ""
  };
  var totalCategories = categories.length;
  var totalPhrasesInCategory = currentPhrases.length;
  var STORAGE_KEY = `phrases_${level}`;
  (0, _react.useEffect)(function () {
    var loadData = function () {
      var _ref = (0, _asyncToGenerator2.default)(function* () {
        try {
          var saved = yield _asyncStorage.default.getItem(STORAGE_KEY);
          if (saved) {
            var _JSON$parse = JSON.parse(saved),
              savedCompleted = _JSON$parse.completedPhrases,
              lastPosition = _JSON$parse.lastPosition;
            setCompletedPhrases(savedCompleted || {});
            if (lastPosition) {
              setCategoryIndex(lastPosition.categoryIndex || 0);
              setPhraseIndex(lastPosition.phraseIndex || 0);
            }
          }
        } catch (error) {} finally {
          setLoaded(true);
        }
      });
      return function loadData() {
        return _ref.apply(this, arguments);
      };
    }();
    loadData();
  }, [level]);
  var saveData = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    try {
      var dataToSave = {
        completedPhrases: completedPhrases,
        lastPosition: {
          categoryIndex: categoryIndex,
          phraseIndex: phraseIndex
        }
      };
      yield _asyncStorage.default.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
    } catch (error) {}
  }), [completedPhrases, categoryIndex, phraseIndex, STORAGE_KEY]);
  (0, _react.useEffect)(function () {
    if (loaded) saveData();
  }, [saveData, loaded]);
  (0, _react.useEffect)(function () {
    if (loaded && phrasesData && !isInitialized.current) {
      var newCompletedPhrases = Object.assign({}, completedPhrases);
      categories.forEach(function (_, index) {
        if (!newCompletedPhrases[index]) {
          newCompletedPhrases[index] = [];
        }
      });
      setCompletedPhrases(newCompletedPhrases);
      isInitialized.current = true;
    }
  }, [loaded, phrasesData, categories, completedPhrases]);
  var changeCategory = (0, _react.useCallback)(function (newCategoryIndex) {
    if (newCategoryIndex !== categoryIndex && newCategoryIndex >= 0 && newCategoryIndex < categories.length) {
      setCategoryIndex(newCategoryIndex);
      setPhraseIndex(0);
      setShowTranslation(false);
    }
  }, [categoryIndex, categories.length]);
  var goToNextPhrase = (0, _react.useCallback)(function () {
    if (phraseIndex < totalPhrasesInCategory - 1) {
      setPhraseIndex(function (prev) {
        return prev + 1;
      });
      setShowTranslation(false);
    }
  }, [phraseIndex, totalPhrasesInCategory]);
  var goToPreviousPhrase = (0, _react.useCallback)(function () {
    if (phraseIndex > 0) {
      setPhraseIndex(function (prev) {
        return prev - 1;
      });
      setShowTranslation(false);
      return true;
    }
    return false;
  }, [phraseIndex]);
  var toggleTranslation = (0, _react.useCallback)(function () {
    setShowTranslation(function (prev) {
      return !prev;
    });
  }, []);
  var toggleDetailedProgress = (0, _react.useCallback)(function () {
    setShowDetailedProgress(function (prev) {
      return !prev;
    });
  }, []);
  var markPhraseAsCompleted = (0, _react.useCallback)(function (catIndex, pIndex) {
    setCompletedPhrases(function (prev) {
      var categoryCompleted = prev[catIndex] || [];
      if (!categoryCompleted.includes(pIndex)) {
        return Object.assign({}, prev, (0, _defineProperty2.default)({}, catIndex, [].concat((0, _toConsumableArray2.default)(categoryCompleted), [pIndex])));
      }
      return prev;
    });
  }, []);
  var findNextUncompletedCategory = (0, _react.useCallback)(function () {
    var numCategories = categories.length;
    var _loop = function _loop() {
        var _completedPhrases$nex;
        var nextIndex = (categoryIndex + i) % numCategories;
        var category = categories[nextIndex];
        var categoryPhrases = allPhrases.filter(function (p) {
          return p.categoryId === category.id;
        });
        var completedInCategory = ((_completedPhrases$nex = completedPhrases[nextIndex]) == null ? void 0 : _completedPhrases$nex.length) || 0;
        if (completedInCategory < categoryPhrases.length) {
          return {
            v: nextIndex
          };
        }
      },
      _ret;
    for (var i = 1; i <= numCategories; i++) {
      _ret = _loop();
      if (_ret) return _ret.v;
    }
    return -1;
  }, [categories, categoryIndex, allPhrases, completedPhrases]);
  var handleNext = (0, _react.useCallback)(function () {
    markPhraseAsCompleted(categoryIndex, phraseIndex);
    if (phraseIndex < totalPhrasesInCategory - 1) {
      goToNextPhrase();
    } else {
      var nextCategoryIndex = findNextUncompletedCategory();
      if (nextCategoryIndex === -1) {
        _reactNative.Alert.alert("Félicitations", "Vous avez terminé tous les exercices de phrases !");
        return {
          completed: true
        };
      } else {
        changeCategory(nextCategoryIndex);
      }
    }
    return {
      completed: false
    };
  }, [categoryIndex, phraseIndex, totalPhrasesInCategory, markPhraseAsCompleted, goToNextPhrase, findNextUncompletedCategory, changeCategory]);
  var handlePrevious = (0, _react.useCallback)(function () {
    goToPreviousPhrase();
  }, [goToPreviousPhrase]);
  var getStats = (0, _react.useCallback)(function () {
    var _completedPhrases$cat;
    var totalPhrases = allPhrases.length;
    var completedPhrasesCount = Object.values(completedPhrases).reduce(function (sum, completed) {
      return sum + ((completed == null ? void 0 : completed.length) || 0);
    }, 0);
    var totalProgress = totalPhrases > 0 ? Math.round(completedPhrasesCount / totalPhrases * 100) : 0;
    var completionProgress = totalPhrasesInCategory > 0 ? (phraseIndex + 1) / totalPhrasesInCategory * 100 : 0;
    return {
      totalPhrases: totalPhrases,
      completedPhrasesCount: completedPhrasesCount,
      totalProgress: totalProgress,
      completionProgress: completionProgress,
      completedInCurrentCategory: ((_completedPhrases$cat = completedPhrases[categoryIndex]) == null ? void 0 : _completedPhrases$cat.length) || 0,
      totalInCurrentCategory: totalPhrasesInCategory
    };
  }, [allPhrases, completedPhrases, totalPhrasesInCategory, phraseIndex, categoryIndex]);
  var getDisplayData = (0, _react.useCallback)(function () {
    var phraseCounter = `${phraseIndex + 1} / ${totalPhrasesInCategory || 0}`;
    var categoriesNames = categories.map(function (cat) {
      return cat.name;
    });
    return {
      phraseCounter: phraseCounter,
      categories: categoriesNames,
      currentPhrase: currentPhrase,
      currentCategory: currentCategory,
      currentPhrases: currentPhrases
    };
  }, [phraseIndex, totalPhrasesInCategory, categories, currentPhrase, currentCategory, currentPhrases]);
  var hasValidData = (phrasesData == null ? void 0 : phrasesData.categories) && Array.isArray(phrasesData.categories) && phrasesData.categories.length > 0;
  var canGoToPrevious = phraseIndex > 0;
  var isLastPhraseInCategory = phraseIndex === totalPhrasesInCategory - 1;
  return {
    categoryIndex: categoryIndex,
    phraseIndex: phraseIndex,
    showTranslation: showTranslation,
    completedPhrases: completedPhrases,
    loaded: loaded,
    showDetailedProgress: showDetailedProgress,
    currentPhrase: currentPhrase,
    currentCategory: currentCategory,
    currentPhrases: currentPhrases,
    totalCategories: totalCategories,
    totalPhrasesInCategory: totalPhrasesInCategory,
    hasValidData: hasValidData,
    changeCategory: changeCategory,
    toggleTranslation: toggleTranslation,
    toggleDetailedProgress: toggleDetailedProgress,
    handleNext: handleNext,
    handlePrevious: handlePrevious,
    canGoToPrevious: canGoToPrevious,
    isLastPhraseInCategory: isLastPhraseInCategory,
    stats: getStats(),
    display: getDisplayData()
  };
};
var _default = exports.default = usePhrases;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0TmF0aXZlIiwiX2FzeW5jU3RvcmFnZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJ1c2VQaHJhc2VzIiwicGhyYXNlc0RhdGEiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJsZXZlbCIsIl91c2VTdGF0ZSIsInVzZVN0YXRlIiwiX3VzZVN0YXRlMiIsIl9zbGljZWRUb0FycmF5MiIsImRlZmF1bHQiLCJjYXRlZ29yeUluZGV4Iiwic2V0Q2F0ZWdvcnlJbmRleCIsIl91c2VTdGF0ZTMiLCJfdXNlU3RhdGU0IiwicGhyYXNlSW5kZXgiLCJzZXRQaHJhc2VJbmRleCIsIl91c2VTdGF0ZTUiLCJfdXNlU3RhdGU2Iiwic2hvd1RyYW5zbGF0aW9uIiwic2V0U2hvd1RyYW5zbGF0aW9uIiwiX3VzZVN0YXRlNyIsIl91c2VTdGF0ZTgiLCJjb21wbGV0ZWRQaHJhc2VzIiwic2V0Q29tcGxldGVkUGhyYXNlcyIsIl91c2VTdGF0ZTkiLCJfdXNlU3RhdGUwIiwibG9hZGVkIiwic2V0TG9hZGVkIiwiX3VzZVN0YXRlMSIsIl91c2VTdGF0ZTEwIiwic2hvd0RldGFpbGVkUHJvZ3Jlc3MiLCJzZXRTaG93RGV0YWlsZWRQcm9ncmVzcyIsImlzSW5pdGlhbGl6ZWQiLCJ1c2VSZWYiLCJjYXRlZ29yaWVzIiwiYWxsUGhyYXNlcyIsInBocmFzZXMiLCJjdXJyZW50Q2F0ZWdvcnkiLCJpZCIsIm5hbWUiLCJjdXJyZW50UGhyYXNlcyIsImZpbHRlciIsInBocmFzZSIsImNhdGVnb3J5SWQiLCJjdXJyZW50UGhyYXNlIiwidHJhbnNsYXRpb24iLCJjb250ZXh0IiwidG90YWxDYXRlZ29yaWVzIiwidG90YWxQaHJhc2VzSW5DYXRlZ29yeSIsIlNUT1JBR0VfS0VZIiwidXNlRWZmZWN0IiwibG9hZERhdGEiLCJfcmVmIiwiX2FzeW5jVG9HZW5lcmF0b3IyIiwic2F2ZWQiLCJBc3luY1N0b3JhZ2UiLCJnZXRJdGVtIiwiX0pTT04kcGFyc2UiLCJKU09OIiwicGFyc2UiLCJzYXZlZENvbXBsZXRlZCIsImxhc3RQb3NpdGlvbiIsImVycm9yIiwiYXBwbHkiLCJzYXZlRGF0YSIsInVzZUNhbGxiYWNrIiwiZGF0YVRvU2F2ZSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJjdXJyZW50IiwibmV3Q29tcGxldGVkUGhyYXNlcyIsIk9iamVjdCIsImFzc2lnbiIsImZvckVhY2giLCJfIiwiaW5kZXgiLCJjaGFuZ2VDYXRlZ29yeSIsIm5ld0NhdGVnb3J5SW5kZXgiLCJnb1RvTmV4dFBocmFzZSIsInByZXYiLCJnb1RvUHJldmlvdXNQaHJhc2UiLCJ0b2dnbGVUcmFuc2xhdGlvbiIsInRvZ2dsZURldGFpbGVkUHJvZ3Jlc3MiLCJtYXJrUGhyYXNlQXNDb21wbGV0ZWQiLCJjYXRJbmRleCIsInBJbmRleCIsImNhdGVnb3J5Q29tcGxldGVkIiwiaW5jbHVkZXMiLCJfZGVmaW5lUHJvcGVydHkyIiwiY29uY2F0IiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsImZpbmROZXh0VW5jb21wbGV0ZWRDYXRlZ29yeSIsIm51bUNhdGVnb3JpZXMiLCJfbG9vcCIsIl9jb21wbGV0ZWRQaHJhc2VzJG5leCIsIm5leHRJbmRleCIsImkiLCJjYXRlZ29yeSIsImNhdGVnb3J5UGhyYXNlcyIsInAiLCJjb21wbGV0ZWRJbkNhdGVnb3J5IiwidiIsIl9yZXQiLCJoYW5kbGVOZXh0IiwibmV4dENhdGVnb3J5SW5kZXgiLCJBbGVydCIsImFsZXJ0IiwiY29tcGxldGVkIiwiaGFuZGxlUHJldmlvdXMiLCJnZXRTdGF0cyIsIl9jb21wbGV0ZWRQaHJhc2VzJGNhdCIsInRvdGFsUGhyYXNlcyIsImNvbXBsZXRlZFBocmFzZXNDb3VudCIsInZhbHVlcyIsInJlZHVjZSIsInN1bSIsInRvdGFsUHJvZ3Jlc3MiLCJNYXRoIiwicm91bmQiLCJjb21wbGV0aW9uUHJvZ3Jlc3MiLCJjb21wbGV0ZWRJbkN1cnJlbnRDYXRlZ29yeSIsInRvdGFsSW5DdXJyZW50Q2F0ZWdvcnkiLCJnZXREaXNwbGF5RGF0YSIsInBocmFzZUNvdW50ZXIiLCJjYXRlZ29yaWVzTmFtZXMiLCJtYXAiLCJjYXQiLCJoYXNWYWxpZERhdGEiLCJBcnJheSIsImlzQXJyYXkiLCJjYW5Hb1RvUHJldmlvdXMiLCJpc0xhc3RQaHJhc2VJbkNhdGVnb3J5Iiwic3RhdHMiLCJkaXNwbGF5IiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsidXNlUGhyYXNlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBob29rcy91c2VQaHJhc2VzLmpzIC0gSE9PSyBVTklGScOJIFNJTVBMRVxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2ssIHVzZVJlZiB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEFsZXJ0IH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCBBc3luY1N0b3JhZ2UgZnJvbSAnQHJlYWN0LW5hdGl2ZS1hc3luYy1zdG9yYWdlL2FzeW5jLXN0b3JhZ2UnO1xuXG4vKipcbiAqIPCfjq8gSG9vayB1bmlmacOpIHBvdXIgUGhyYXNlcyBFeGVyY2lzZVxuICogUmVtcGxhY2UgdXNlUGhyYXNlc0V4ZXJjaXNlU3RhdGUgKyB1c2VQaHJhc2VzUHJvZ3Jlc3MgKyB1c2VQaHJhc2VzRGlzcGxheVxuICogU2ltcGxlLCBlZmZpY2FjZSwgbWFpbnRlbmFibGUgLSBwYXR0ZXJuIGlkZW50aXF1ZSDDoCB1c2VSZWFkaW5nLCB1c2VHcmFtbWFyIGV0IHVzZVZvY2FidWxhcnlcbiAqL1xuY29uc3QgdXNlUGhyYXNlcyA9IChwaHJhc2VzRGF0YSA9IG51bGwsIGxldmVsID0gXCJBMVwiKSA9PiB7XG4gIFxuICAvLyA9PT09PT09PT09PT09PT09PT09IENPUkUgU1RBVEUgPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBbY2F0ZWdvcnlJbmRleCwgc2V0Q2F0ZWdvcnlJbmRleF0gPSB1c2VTdGF0ZSgwKTtcbiAgY29uc3QgW3BocmFzZUluZGV4LCBzZXRQaHJhc2VJbmRleF0gPSB1c2VTdGF0ZSgwKTtcbiAgY29uc3QgW3Nob3dUcmFuc2xhdGlvbiwgc2V0U2hvd1RyYW5zbGF0aW9uXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2NvbXBsZXRlZFBocmFzZXMsIHNldENvbXBsZXRlZFBocmFzZXNdID0gdXNlU3RhdGUoe30pO1xuICBjb25zdCBbbG9hZGVkLCBzZXRMb2FkZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2hvd0RldGFpbGVkUHJvZ3Jlc3MsIHNldFNob3dEZXRhaWxlZFByb2dyZXNzXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09IFJFRlMgPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBpc0luaXRpYWxpemVkID0gdXNlUmVmKGZhbHNlKTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09IENPTVBVVEVEIFZBTFVFUyA9PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGNhdGVnb3JpZXMgPSBwaHJhc2VzRGF0YT8uY2F0ZWdvcmllcyB8fCBbXTtcbiAgY29uc3QgYWxsUGhyYXNlcyA9IHBocmFzZXNEYXRhPy5waHJhc2VzIHx8IFtdO1xuICBjb25zdCBjdXJyZW50Q2F0ZWdvcnkgPSBjYXRlZ29yaWVzW2NhdGVnb3J5SW5kZXhdIHx8IHsgaWQ6IG51bGwsIG5hbWU6IFwiTG9hZGluZy4uLlwiLCBwaHJhc2VzOiBbXSB9O1xuICBjb25zdCBjdXJyZW50UGhyYXNlcyA9IGN1cnJlbnRDYXRlZ29yeS5pZCBcbiAgICA/IGFsbFBocmFzZXMuZmlsdGVyKHBocmFzZSA9PiBwaHJhc2UuY2F0ZWdvcnlJZCA9PT0gY3VycmVudENhdGVnb3J5LmlkKVxuICAgIDogW107XG4gIGNvbnN0IGN1cnJlbnRQaHJhc2UgPSBjdXJyZW50UGhyYXNlc1twaHJhc2VJbmRleF0gfHwgeyBpZDogXCJcIiwgcGhyYXNlOiBcIlwiLCB0cmFuc2xhdGlvbjogXCJcIiwgY29udGV4dDogXCJcIiB9O1xuICBjb25zdCB0b3RhbENhdGVnb3JpZXMgPSBjYXRlZ29yaWVzLmxlbmd0aDtcbiAgY29uc3QgdG90YWxQaHJhc2VzSW5DYXRlZ29yeSA9IGN1cnJlbnRQaHJhc2VzLmxlbmd0aDtcbiAgXG4gIC8vID09PT09PT09PT09PT09PT09PT0gUEVSU0lTVEVOQ0UgPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBTVE9SQUdFX0tFWSA9IGBwaHJhc2VzXyR7bGV2ZWx9YDtcblxuICAvLyBMb2FkIGRhdGEgZnJvbSBzdG9yYWdlXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgbG9hZERhdGEgPSBhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzYXZlZCA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKFNUT1JBR0VfS0VZKTtcbiAgICAgICAgaWYgKHNhdmVkKSB7XG4gICAgICAgICAgY29uc3QgeyBjb21wbGV0ZWRQaHJhc2VzOiBzYXZlZENvbXBsZXRlZCwgbGFzdFBvc2l0aW9uIH0gPSBKU09OLnBhcnNlKHNhdmVkKTtcbiAgICAgICAgICBzZXRDb21wbGV0ZWRQaHJhc2VzKHNhdmVkQ29tcGxldGVkIHx8IHt9KTtcbiAgICAgICAgICBpZiAobGFzdFBvc2l0aW9uKSB7XG4gICAgICAgICAgICBzZXRDYXRlZ29yeUluZGV4KGxhc3RQb3NpdGlvbi5jYXRlZ29yeUluZGV4IHx8IDApO1xuICAgICAgICAgICAgc2V0UGhyYXNlSW5kZXgobGFzdFBvc2l0aW9uLnBocmFzZUluZGV4IHx8IDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gSWdub3JlZCBvbiBwdXJwb3NlXG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBzZXRMb2FkZWQodHJ1ZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBsb2FkRGF0YSgpO1xuICB9LCBbbGV2ZWxdKTtcblxuICAvLyBTYXZlIGRhdGEgdG8gc3RvcmFnZVxuICBjb25zdCBzYXZlRGF0YSA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0YVRvU2F2ZSA9IHtcbiAgICAgICAgY29tcGxldGVkUGhyYXNlcyxcbiAgICAgICAgbGFzdFBvc2l0aW9uOiB7XG4gICAgICAgICAgY2F0ZWdvcnlJbmRleCxcbiAgICAgICAgICBwaHJhc2VJbmRleFxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnNldEl0ZW0oU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KGRhdGFUb1NhdmUpKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gSWdub3JlZCBvbiBwdXJwb3NlXG4gICAgfVxuICB9LCBbY29tcGxldGVkUGhyYXNlcywgY2F0ZWdvcnlJbmRleCwgcGhyYXNlSW5kZXgsIFNUT1JBR0VfS0VZXSk7XG5cbiAgLy8gQXV0by1zYXZlIHdoZW4gZGF0YSBjaGFuZ2VzXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGxvYWRlZCkgc2F2ZURhdGEoKTtcbiAgfSwgW3NhdmVEYXRhLCBsb2FkZWRdKTtcblxuICAvLyBJbml0aWFsaXplIHByb2dyZXNzIGZvciBuZXcgY2F0ZWdvcmllc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChsb2FkZWQgJiYgcGhyYXNlc0RhdGEgJiYgIWlzSW5pdGlhbGl6ZWQuY3VycmVudCkge1xuICAgICAgY29uc3QgbmV3Q29tcGxldGVkUGhyYXNlcyA9IHsgLi4uY29tcGxldGVkUGhyYXNlcyB9O1xuICAgICAgY2F0ZWdvcmllcy5mb3JFYWNoKChfLCBpbmRleCkgPT4ge1xuICAgICAgICBpZiAoIW5ld0NvbXBsZXRlZFBocmFzZXNbaW5kZXhdKSB7XG4gICAgICAgICAgbmV3Q29tcGxldGVkUGhyYXNlc1tpbmRleF0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBzZXRDb21wbGV0ZWRQaHJhc2VzKG5ld0NvbXBsZXRlZFBocmFzZXMpO1xuICAgICAgaXNJbml0aWFsaXplZC5jdXJyZW50ID0gdHJ1ZTtcbiAgICB9XG4gIH0sIFtsb2FkZWQsIHBocmFzZXNEYXRhLCBjYXRlZ29yaWVzLCBjb21wbGV0ZWRQaHJhc2VzXSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PSBOQVZJR0FUSU9OIEFDVElPTlMgPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBjaGFuZ2VDYXRlZ29yeSA9IHVzZUNhbGxiYWNrKChuZXdDYXRlZ29yeUluZGV4KSA9PiB7XG4gICAgaWYgKG5ld0NhdGVnb3J5SW5kZXggIT09IGNhdGVnb3J5SW5kZXggJiYgbmV3Q2F0ZWdvcnlJbmRleCA+PSAwICYmIG5ld0NhdGVnb3J5SW5kZXggPCBjYXRlZ29yaWVzLmxlbmd0aCkge1xuICAgICAgc2V0Q2F0ZWdvcnlJbmRleChuZXdDYXRlZ29yeUluZGV4KTtcbiAgICAgIHNldFBocmFzZUluZGV4KDApO1xuICAgICAgc2V0U2hvd1RyYW5zbGF0aW9uKGZhbHNlKTtcbiAgICB9XG4gIH0sIFtjYXRlZ29yeUluZGV4LCBjYXRlZ29yaWVzLmxlbmd0aF0pO1xuXG4gIGNvbnN0IGdvVG9OZXh0UGhyYXNlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmIChwaHJhc2VJbmRleCA8IHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnkgLSAxKSB7XG4gICAgICBzZXRQaHJhc2VJbmRleChwcmV2ID0+IHByZXYgKyAxKTtcbiAgICAgIHNldFNob3dUcmFuc2xhdGlvbihmYWxzZSk7XG4gICAgfVxuICB9LCBbcGhyYXNlSW5kZXgsIHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnldKTtcblxuICBjb25zdCBnb1RvUHJldmlvdXNQaHJhc2UgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKHBocmFzZUluZGV4ID4gMCkge1xuICAgICAgc2V0UGhyYXNlSW5kZXgocHJldiA9PiBwcmV2IC0gMSk7XG4gICAgICBzZXRTaG93VHJhbnNsYXRpb24oZmFsc2UpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSwgW3BocmFzZUluZGV4XSk7XG5cbiAgY29uc3QgdG9nZ2xlVHJhbnNsYXRpb24gPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgc2V0U2hvd1RyYW5zbGF0aW9uKHByZXYgPT4gIXByZXYpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgdG9nZ2xlRGV0YWlsZWRQcm9ncmVzcyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBzZXRTaG93RGV0YWlsZWRQcm9ncmVzcyhwcmV2ID0+ICFwcmV2KTtcbiAgfSwgW10pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT0gQ09NUExFVElPTiBMT0dJQyA9PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IG1hcmtQaHJhc2VBc0NvbXBsZXRlZCA9IHVzZUNhbGxiYWNrKChjYXRJbmRleCwgcEluZGV4KSA9PiB7XG4gICAgc2V0Q29tcGxldGVkUGhyYXNlcyhwcmV2ID0+IHtcbiAgICAgIGNvbnN0IGNhdGVnb3J5Q29tcGxldGVkID0gcHJldltjYXRJbmRleF0gfHwgW107XG4gICAgICBpZiAoIWNhdGVnb3J5Q29tcGxldGVkLmluY2x1ZGVzKHBJbmRleCkpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgIFtjYXRJbmRleF06IFsuLi5jYXRlZ29yeUNvbXBsZXRlZCwgcEluZGV4XVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHByZXY7XG4gICAgfSk7XG4gIH0sIFtdKTtcblxuICAvLyBGaW5kIG5leHQgdW5jb21wbGV0ZWQgY2F0ZWdvcnlcbiAgY29uc3QgZmluZE5leHRVbmNvbXBsZXRlZENhdGVnb3J5ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IG51bUNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBudW1DYXRlZ29yaWVzOyBpKyspIHtcbiAgICAgIGNvbnN0IG5leHRJbmRleCA9IChjYXRlZ29yeUluZGV4ICsgaSkgJSBudW1DYXRlZ29yaWVzO1xuICAgICAgY29uc3QgY2F0ZWdvcnkgPSBjYXRlZ29yaWVzW25leHRJbmRleF07XG4gICAgICBjb25zdCBjYXRlZ29yeVBocmFzZXMgPSBhbGxQaHJhc2VzLmZpbHRlcihwID0+IHAuY2F0ZWdvcnlJZCA9PT0gY2F0ZWdvcnkuaWQpO1xuICAgICAgY29uc3QgY29tcGxldGVkSW5DYXRlZ29yeSA9IGNvbXBsZXRlZFBocmFzZXNbbmV4dEluZGV4XT8ubGVuZ3RoIHx8IDA7XG4gICAgICBcbiAgICAgIGlmIChjb21wbGV0ZWRJbkNhdGVnb3J5IDwgY2F0ZWdvcnlQaHJhc2VzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gbmV4dEluZGV4O1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTE7XG4gIH0sIFtjYXRlZ29yaWVzLCBjYXRlZ29yeUluZGV4LCBhbGxQaHJhc2VzLCBjb21wbGV0ZWRQaHJhc2VzXSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PSBNQUlOIE5BVklHQVRJT04gPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBoYW5kbGVOZXh0ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIC8vIE1hcmsgY3VycmVudCBwaHJhc2UgYXMgY29tcGxldGVkXG4gICAgbWFya1BocmFzZUFzQ29tcGxldGVkKGNhdGVnb3J5SW5kZXgsIHBocmFzZUluZGV4KTtcblxuICAgIC8vIENoZWNrIGlmIHRoZXJlIGFyZSBtb3JlIHBocmFzZXMgaW4gY3VycmVudCBjYXRlZ29yeVxuICAgIGlmIChwaHJhc2VJbmRleCA8IHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnkgLSAxKSB7XG4gICAgICBnb1RvTmV4dFBocmFzZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBFbmQgb2YgY2F0ZWdvcnkgLSBmaW5kIG5leHQgdW5jb21wbGV0ZWQgY2F0ZWdvcnlcbiAgICAgIGNvbnN0IG5leHRDYXRlZ29yeUluZGV4ID0gZmluZE5leHRVbmNvbXBsZXRlZENhdGVnb3J5KCk7XG4gICAgICBpZiAobmV4dENhdGVnb3J5SW5kZXggPT09IC0xKSB7XG4gICAgICAgIC8vIEFsbCBkb25lIVxuICAgICAgICBBbGVydC5hbGVydChcbiAgICAgICAgICBcIkbDqWxpY2l0YXRpb25zXCIsXG4gICAgICAgICAgXCJWb3VzIGF2ZXogdGVybWluw6kgdG91cyBsZXMgZXhlcmNpY2VzIGRlIHBocmFzZXMgIVwiXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB7IGNvbXBsZXRlZDogdHJ1ZSB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hhbmdlQ2F0ZWdvcnkobmV4dENhdGVnb3J5SW5kZXgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyBjb21wbGV0ZWQ6IGZhbHNlIH07XG4gIH0sIFtjYXRlZ29yeUluZGV4LCBwaHJhc2VJbmRleCwgdG90YWxQaHJhc2VzSW5DYXRlZ29yeSwgbWFya1BocmFzZUFzQ29tcGxldGVkLCBnb1RvTmV4dFBocmFzZSwgZmluZE5leHRVbmNvbXBsZXRlZENhdGVnb3J5LCBjaGFuZ2VDYXRlZ29yeV0pO1xuXG4gIGNvbnN0IGhhbmRsZVByZXZpb3VzID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGdvVG9QcmV2aW91c1BocmFzZSgpO1xuICB9LCBbZ29Ub1ByZXZpb3VzUGhyYXNlXSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PSBDT01QVVRFRCBTVEFUUyA9PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGdldFN0YXRzID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IHRvdGFsUGhyYXNlcyA9IGFsbFBocmFzZXMubGVuZ3RoO1xuICAgIGNvbnN0IGNvbXBsZXRlZFBocmFzZXNDb3VudCA9IE9iamVjdC52YWx1ZXMoY29tcGxldGVkUGhyYXNlcykucmVkdWNlKChzdW0sIGNvbXBsZXRlZCkgPT4gc3VtICsgKGNvbXBsZXRlZD8ubGVuZ3RoIHx8IDApLCAwKTtcbiAgICBjb25zdCB0b3RhbFByb2dyZXNzID0gdG90YWxQaHJhc2VzID4gMCA/IE1hdGgucm91bmQoKGNvbXBsZXRlZFBocmFzZXNDb3VudCAvIHRvdGFsUGhyYXNlcykgKiAxMDApIDogMDtcbiAgICBjb25zdCBjb21wbGV0aW9uUHJvZ3Jlc3MgPSB0b3RhbFBocmFzZXNJbkNhdGVnb3J5ID4gMCA/ICgocGhyYXNlSW5kZXggKyAxKSAvIHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnkpICogMTAwIDogMDtcblxuICAgIHJldHVybiB7XG4gICAgICB0b3RhbFBocmFzZXMsXG4gICAgICBjb21wbGV0ZWRQaHJhc2VzQ291bnQsXG4gICAgICB0b3RhbFByb2dyZXNzLFxuICAgICAgY29tcGxldGlvblByb2dyZXNzLFxuICAgICAgY29tcGxldGVkSW5DdXJyZW50Q2F0ZWdvcnk6IGNvbXBsZXRlZFBocmFzZXNbY2F0ZWdvcnlJbmRleF0/Lmxlbmd0aCB8fCAwLFxuICAgICAgdG90YWxJbkN1cnJlbnRDYXRlZ29yeTogdG90YWxQaHJhc2VzSW5DYXRlZ29yeVxuICAgIH07XG4gIH0sIFthbGxQaHJhc2VzLCBjb21wbGV0ZWRQaHJhc2VzLCB0b3RhbFBocmFzZXNJbkNhdGVnb3J5LCBwaHJhc2VJbmRleCwgY2F0ZWdvcnlJbmRleF0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT0gQ09NUFVURUQgRElTUExBWSA9PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGdldERpc3BsYXlEYXRhID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IHBocmFzZUNvdW50ZXIgPSBgJHtwaHJhc2VJbmRleCArIDF9IC8gJHt0b3RhbFBocmFzZXNJbkNhdGVnb3J5IHx8IDB9YDtcbiAgICBjb25zdCBjYXRlZ29yaWVzTmFtZXMgPSBjYXRlZ29yaWVzLm1hcChjYXQgPT4gY2F0Lm5hbWUpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBwaHJhc2VDb3VudGVyLFxuICAgICAgY2F0ZWdvcmllczogY2F0ZWdvcmllc05hbWVzLFxuICAgICAgY3VycmVudFBocmFzZSxcbiAgICAgIGN1cnJlbnRDYXRlZ29yeSxcbiAgICAgIGN1cnJlbnRQaHJhc2VzXG4gICAgfTtcbiAgfSwgW3BocmFzZUluZGV4LCB0b3RhbFBocmFzZXNJbkNhdGVnb3J5LCBjYXRlZ29yaWVzLCBjdXJyZW50UGhyYXNlLCBjdXJyZW50Q2F0ZWdvcnksIGN1cnJlbnRQaHJhc2VzXSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PSBWQUxJREFUSU9OID09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgaGFzVmFsaWREYXRhID0gcGhyYXNlc0RhdGE/LmNhdGVnb3JpZXMgJiYgQXJyYXkuaXNBcnJheShwaHJhc2VzRGF0YS5jYXRlZ29yaWVzKSAmJiBwaHJhc2VzRGF0YS5jYXRlZ29yaWVzLmxlbmd0aCA+IDA7XG5cbiAgY29uc3QgY2FuR29Ub1ByZXZpb3VzID0gcGhyYXNlSW5kZXggPiAwO1xuICBjb25zdCBpc0xhc3RQaHJhc2VJbkNhdGVnb3J5ID0gcGhyYXNlSW5kZXggPT09IHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnkgLSAxO1xuXG4gIHJldHVybiB7XG4gICAgLy8gU3RhdGVcbiAgICBjYXRlZ29yeUluZGV4LFxuICAgIHBocmFzZUluZGV4LFxuICAgIHNob3dUcmFuc2xhdGlvbixcbiAgICBjb21wbGV0ZWRQaHJhc2VzLFxuICAgIGxvYWRlZCxcbiAgICBzaG93RGV0YWlsZWRQcm9ncmVzcyxcbiAgICBcbiAgICAvLyBEYXRhXG4gICAgY3VycmVudFBocmFzZSxcbiAgICBjdXJyZW50Q2F0ZWdvcnksXG4gICAgY3VycmVudFBocmFzZXMsXG4gICAgdG90YWxDYXRlZ29yaWVzLFxuICAgIHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnksXG4gICAgaGFzVmFsaWREYXRhLFxuICAgIFxuICAgIC8vIEFjdGlvbnNcbiAgICBjaGFuZ2VDYXRlZ29yeSxcbiAgICB0b2dnbGVUcmFuc2xhdGlvbixcbiAgICB0b2dnbGVEZXRhaWxlZFByb2dyZXNzLFxuICAgIGhhbmRsZU5leHQsXG4gICAgaGFuZGxlUHJldmlvdXMsXG4gICAgXG4gICAgLy8gQ29tcHV0ZWRcbiAgICBjYW5Hb1RvUHJldmlvdXMsXG4gICAgaXNMYXN0UGhyYXNlSW5DYXRlZ29yeSxcbiAgICBzdGF0czogZ2V0U3RhdHMoKSxcbiAgICBkaXNwbGF5OiBnZXREaXNwbGF5RGF0YSgpLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgdXNlUGhyYXNlczsiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUNBLElBQUFBLE1BQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLFlBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLGFBQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQU9BLElBQU1JLFVBQVUsR0FBRyxTQUFiQSxVQUFVQSxDQUFBLEVBQXlDO0VBQUEsSUFBckNDLFdBQVcsR0FBQUMsU0FBQSxDQUFBQyxNQUFBLFFBQUFELFNBQUEsUUFBQUUsU0FBQSxHQUFBRixTQUFBLE1BQUcsSUFBSTtFQUFBLElBQUVHLEtBQUssR0FBQUgsU0FBQSxDQUFBQyxNQUFBLFFBQUFELFNBQUEsUUFBQUUsU0FBQSxHQUFBRixTQUFBLE1BQUcsSUFBSTtFQUdsRCxJQUFBSSxTQUFBLEdBQTBDLElBQUFDLGVBQVEsRUFBQyxDQUFDLENBQUM7SUFBQUMsVUFBQSxPQUFBQyxlQUFBLENBQUFDLE9BQUEsRUFBQUosU0FBQTtJQUE5Q0ssYUFBYSxHQUFBSCxVQUFBO0lBQUVJLGdCQUFnQixHQUFBSixVQUFBO0VBQ3RDLElBQUFLLFVBQUEsR0FBc0MsSUFBQU4sZUFBUSxFQUFDLENBQUMsQ0FBQztJQUFBTyxVQUFBLE9BQUFMLGVBQUEsQ0FBQUMsT0FBQSxFQUFBRyxVQUFBO0lBQTFDRSxXQUFXLEdBQUFELFVBQUE7SUFBRUUsY0FBYyxHQUFBRixVQUFBO0VBQ2xDLElBQUFHLFVBQUEsR0FBOEMsSUFBQVYsZUFBUSxFQUFDLEtBQUssQ0FBQztJQUFBVyxVQUFBLE9BQUFULGVBQUEsQ0FBQUMsT0FBQSxFQUFBTyxVQUFBO0lBQXRERSxlQUFlLEdB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