{"version":3,"names":["_getJestObj","mock","getItem","jest","fn","setItem","removeItem","STORAGE_KEYS","LAST_ACTIVITY","emit","_interopRequireDefault","require","_asyncToGenerator2","_reactNative","_asyncStorage","_useLastActivity","_require","describe","beforeEach","clearAllMocks","spyOn","Date","mockReturnValue","afterEach","restoreAllMocks","it","AsyncStorage","mockResolvedValue","_renderHook","renderHook","useLastActivity","result","expect","current","lastActivity","toBeNull","isLoading","toBe","default","mockActivity","type","timestamp","JSON","stringify","_renderHook2","waitFor","toBeDefined","_renderHook3","activityData","score","act","saveActivity","toHaveBeenCalled","_renderHook4","clearActivity","reload"],"sources":["useLastActivity.test.js"],"sourcesContent":["// __tests__/hooks/useLastActivity.test.js\nimport { renderHook, act, waitFor } from '@testing-library/react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport useLastActivity from '../../src/hooks/useLastActivity';\n\njest.mock('@react-native-async-storage/async-storage', () => ({\n  getItem: jest.fn(),\n  setItem: jest.fn(),\n  removeItem: jest.fn(),\n}));\n\njest.mock('../../src/utils/constants', () => ({\n  STORAGE_KEYS: {\n    LAST_ACTIVITY: 'last_activity'\n  }\n}));\n\njest.mock('../../src/utils/eventBus', () => ({\n  emit: jest.fn()\n}));\n\ndescribe('useLastActivity', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    jest.spyOn(Date, 'now').mockReturnValue(1640995200000);\n  });\n\n  afterEach(() => {\n    jest.restoreAllMocks();\n  });\n\n  it('devrait initialiser avec null', () => {\n    AsyncStorage.getItem.mockResolvedValue(null);\n    const { result } = renderHook(() => useLastActivity());\n    \n    expect(result.current.lastActivity).toBeNull();\n    expect(result.current.isLoading).toBe(true);\n  });\n\n  it('devrait charger une activit�� existante', async () => {\n    const mockActivity = {\n      type: 'vocabulary',\n      timestamp: 1640995200000 - 300000 // Il y a 5 minutes\n    };\n\n    AsyncStorage.getItem.mockResolvedValue(JSON.stringify(mockActivity));\n    const { result } = renderHook(() => useLastActivity());\n\n    await waitFor(() => {\n      expect(result.current.lastActivity).toBeDefined();\n      expect(result.current.lastActivity.type).toBe('vocabulary');\n      expect(result.current.isLoading).toBe(false);\n    });\n  });\n\n  it('devrait sauvegarder une nouvelle activité', async () => {\n    AsyncStorage.getItem.mockResolvedValue(null);\n    const { result } = renderHook(() => useLastActivity());\n\n    await waitFor(() => {\n      expect(result.current.isLoading).toBe(false);\n    });\n\n    const activityData = { type: 'grammar', score: 85 };\n\n    await act(async () => {\n      await result.current.saveActivity(activityData);\n    });\n\n    expect(AsyncStorage.setItem).toHaveBeenCalled();\n  });\n\n  it('devrait avoir toutes les fonctions nécessaires', () => {\n    AsyncStorage.getItem.mockResolvedValue(null);\n    const { result } = renderHook(() => useLastActivity());\n    \n    expect(typeof result.current.saveActivity).toBe('function');\n    expect(typeof result.current.clearActivity).toBe('function');\n    expect(typeof result.current.reload).toBe('function');\n  });\n});"],"mappings":"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","ignoreList":[]}