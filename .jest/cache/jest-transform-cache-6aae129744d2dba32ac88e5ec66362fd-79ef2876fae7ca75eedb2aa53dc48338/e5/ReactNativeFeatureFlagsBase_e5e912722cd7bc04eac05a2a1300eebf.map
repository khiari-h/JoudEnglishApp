{"version":3,"names":["_NativeReactNativeFeatureFlags","_interopRequireDefault","require","accessedFeatureFlags","Set","overrides","createGetter","configName","customValueGetter","defaultValue","cachedValue","_customValueGetter","createJavaScriptFlagGetter","_overrides","_overrides$configName","add","call","createNativeFlagGetter","_NativeReactNativeFea","valueFromNative","NativeReactNativeFeatureFlags","logUnavailableNativeModuleError","getOverrides","setOverrides","newOverrides","Error","size","accessedFeatureFlagsStr","Array","from","join","reportedConfigNames","has","console","error"],"sources":["ReactNativeFeatureFlagsBase.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow strict-local\n * @format\n */\n\nimport type {\n  ReactNativeFeatureFlagsJsOnly,\n  ReactNativeFeatureFlagsJsOnlyOverrides,\n} from './ReactNativeFeatureFlags';\n\nimport NativeReactNativeFeatureFlags from './specs/NativeReactNativeFeatureFlags';\n\nconst accessedFeatureFlags: Set<string> = new Set();\nlet overrides: ?ReactNativeFeatureFlagsJsOnlyOverrides;\n\nexport type Getter<T> = () => T;\n\nfunction createGetter<T: boolean | number | string>(\n  configName: string,\n  customValueGetter: Getter<?T>,\n  defaultValue: T,\n): Getter<T> {\n  let cachedValue: ?T;\n\n  return () => {\n    if (cachedValue == null) {\n      cachedValue = customValueGetter() ?? defaultValue;\n    }\n    return cachedValue;\n  };\n}\n\nexport function createJavaScriptFlagGetter<\n  K: $Keys<ReactNativeFeatureFlagsJsOnly>,\n>(\n  configName: K,\n  defaultValue: ReturnType<ReactNativeFeatureFlagsJsOnly[K]>,\n): Getter<ReturnType<ReactNativeFeatureFlagsJsOnly[K]>> {\n  return createGetter(\n    configName,\n    () => {\n      accessedFeatureFlags.add(configName);\n      return overrides?.[configName]?.();\n    },\n    defaultValue,\n  );\n}\n\ntype NativeFeatureFlags = $NonMaybeType<typeof NativeReactNativeFeatureFlags>;\n\nexport function createNativeFlagGetter<K: $Keys<NativeFeatureFlags>>(\n  configName: K,\n  defaultValue: ReturnType<$NonMaybeType<NativeFeatureFlags[K]>>,\n): Getter<ReturnType<$NonMaybeType<NativeFeatureFlags[K]>>> {\n  return createGetter(\n    configName,\n    () => {\n      const valueFromNative = NativeReactNativeFeatureFlags?.[configName]?.();\n      if (valueFromNative == null) {\n        logUnavailableNativeModuleError(configName);\n      }\n      return valueFromNative;\n    },\n    defaultValue,\n  );\n}\n\nexport function getOverrides(): ?ReactNativeFeatureFlagsJsOnlyOverrides {\n  return overrides;\n}\n\nexport function setOverrides(\n  newOverrides: ReactNativeFeatureFlagsJsOnlyOverrides,\n): void {\n  if (overrides != null) {\n    throw new Error('Feature flags cannot be overridden more than once');\n  }\n\n  if (accessedFeatureFlags.size > 0) {\n    const accessedFeatureFlagsStr = Array.from(accessedFeatureFlags).join(', ');\n    throw new Error(\n      `Feature flags were accessed before being overridden: ${accessedFeatureFlagsStr}`,\n    );\n  }\n\n  overrides = newOverrides;\n}\n\nconst reportedConfigNames: Set<string> = new Set();\n\nfunction logUnavailableNativeModuleError(configName: string): void {\n  if (!reportedConfigNames.has(configName)) {\n    reportedConfigNames.add(configName);\n    console.error(\n      `Could not access feature flag '${configName}' because native module method was not available`,\n    );\n  }\n}\n"],"mappings":";;;;;;;;AAeA,IAAAA,8BAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAMC,oBAAiC,GAAG,IAAIC,GAAG,CAAC,CAAC;AACnD,IAAIC,SAAkD;AAItD,SAASC,YAAYA,CACnBC,UAAkB,EAClBC,iBAA6B,EAC7BC,YAAe,EACJ;EACX,IAAIC,WAAe;EAEnB,OAAO,YAAM;IACX,IAAIA,WAAW,IAAI,IAAI,EAAE;MAAA,IAAAC,kBAAA;MACvBD,WAAW,IAAAC,kBAAA,GAAGH,iBAAiB,CAAC,CAAC,YAAAG,kBAAA,GAAIF,YAAY;IACnD;IACA,OAAOC,WAAW;EACpB,CAAC;AACH;AAEO,SAASE,0BAA0BA,CAGxCL,UAAa,EACbE,YAA0D,EACJ;EACtD,OAAOH,YAAY,CACjBC,UAAU,EACV,YAAM;IAAA,IAAAM,UAAA,EAAAC,qBAAA;IACJX,oBAAoB,CAACY,GAAG,CAACR,UAAU,CAAC;IACpC,QAAAM,UAAA,GAAOR,SAAS,cAAAS,qBAAA,GAATD,UAAA,CAAYN,UAAU,CAAC,qBAAvBO,qBAAA,CAAAE,IAAA,CAAAH,UAA0B,CAAC;EACpC,CAAC,EACDJ,YACF,CAAC;AACH;AAIO,SAASQ,sBAAsBA,CACpCV,UAAa,EACbE,YAA8D,EACJ;EAC1D,OAAOH,YAAY,CACjBC,UAAU,EACV,YAAM;IAAA,IAAAW,qBAAA;IACJ,IAAMC,eAAe,GAAGC,sCAA6B,aAAAF,qBAAA,GAA7BE,sCAA6B,CAAGb,UAAU,CAAC,qBAA3CW,qBAAA,CAAAF,IAAA,CAAAI,sCAA8C,CAAC;IACvE,IAAID,eAAe,IAAI,IAAI,EAAE;MAC3BE,+BAA+B,CAACd,UAAU,CAAC;IAC7C;IACA,OAAOY,eAAe;EACxB,CAAC,EACDV,YACF,CAAC;AACH;AAEO,SAASa,YAAYA,CAAA,EAA4C;EACtE,OAAOjB,SAAS;AAClB;AAEO,SAASkB,YAAYA,CAC1BC,YAAoD,EAC9C;EACN,IAAInB,SAAS,IAAI,IAAI,EAAE;IACrB,MAAM,IAAIoB,KAAK,CAAC,mDAAmD,CAAC;EACtE;EAEA,IAAItB,oBAAoB,CAACuB,IAAI,GAAG,CAAC,EAAE;IACjC,IAAMC,uBAAuB,GAAGC,KAAK,CAACC,IAAI,CAAC1B,oBAAoB,CAAC,CAAC2B,IAAI,CAAC,IAAI,CAAC;IAC3E,MAAM,IAAIL,KAAK,CACb,wDAAwDE,uBAAuB,EACjF,CAAC;EACH;EAEAtB,SAAS,GAAGmB,YAAY;AAC1B;AAEA,IAAMO,mBAAgC,GAAG,IAAI3B,GAAG,CAAC,CAAC;AAElD,SAASiB,+BAA+BA,CAACd,UAAkB,EAAQ;EACjE,IAAI,CAACwB,mBAAmB,CAACC,GAAG,CAACzB,UAAU,CAAC,EAAE;IACxCwB,mBAAmB,CAAChB,GAAG,CAACR,UAAU,CAAC;IACnC0B,OAAO,CAACC,KAAK,CACX,kCAAkC3B,UAAU,kDAC9C,CAAC;EACH;AACF","ignoreList":[]}