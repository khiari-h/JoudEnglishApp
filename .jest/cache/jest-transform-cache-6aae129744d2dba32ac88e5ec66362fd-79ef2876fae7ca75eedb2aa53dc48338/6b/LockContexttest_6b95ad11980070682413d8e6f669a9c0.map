{"version":3,"names":["_getJestObj","mock","isEnabled","jest","fn","mockResolvedValue","verifyPin","_ref","_asyncToGenerator2","default","pin","ok","_x","apply","arguments","disableLock","enableLock","_interopRequireDefault","require","_react","_reactNative","_LockContext","_jsxRuntime","_require","Consumer","_useLock","useLock","isLocked","unlockWithPin","disable","jsxs","Fragment","children","jsx","TestText","testID","String","TestButton","onPress","_ref2","_ref3","describe","it","ui","render","LockProvider","waitFor","getByTestId","expect","props","toBe","fireEvent","press"],"sources":["LockContext.test.js"],"sourcesContent":["import React from 'react';\r\nimport { render, act, fireEvent, waitFor } from '@testing-library/react-native';\r\nimport { LockProvider, useLock } from '../../src/contexts/LockContext';\r\n\r\njest.mock('../../src/services/lockService', () => ({\r\n  isEnabled: jest.fn().mockResolvedValue(true),\r\n  verifyPin: jest.fn(async (pin) => ({ ok: pin === '1234' })),\r\n  disableLock: jest.fn().mockResolvedValue(true),\r\n  enableLock: jest.fn().mockResolvedValue(true),\r\n}));\r\n\r\nconst Consumer = () => {\r\n  const { isEnabled, isLocked, unlockWithPin, disable } = useLock();\r\n  return (\r\n    <>\r\n      <TestText testID=\"enabled\">{String(isEnabled)}</TestText>\r\n      <TestText testID=\"locked\">{String(isLocked)}</TestText>\r\n      <TestButton testID=\"unlock\" onPress={() => unlockWithPin('1234')} />\r\n      <TestButton testID=\"disable\" onPress={disable} />\r\n    </>\r\n  );\r\n};\r\n\r\n// Tiny shims to avoid importing RN primitives\r\nconst TestText = ({ children, testID }) => (<text testID={testID}>{children}</text>);\r\nconst TestButton = ({ onPress, testID }) => (<button testID={testID} onPress={onPress} />);\r\n\r\ndescribe('LockContext', () => {\r\n  it('initializes locked when enabled, unlocks with correct PIN, and can disable', async () => {\r\n    const ui = render(\r\n      <LockProvider>\r\n        <Consumer />\r\n      </LockProvider>\r\n    );\r\n    // wait initial load\r\n    await waitFor(() => ui.getByTestId('locked'));\r\n    expect(ui.getByTestId('enabled').props.children).toBe('true');\r\n    expect(ui.getByTestId('locked').props.children).toBe('true');\r\n\r\n    // unlock\r\n    fireEvent.press(ui.getByTestId('unlock'));\r\n    await waitFor(() => expect(ui.getByTestId('locked').props.children).toBe('false'));\r\n\r\n    // disable\r\n    fireEvent.press(ui.getByTestId('disable'));\r\n    await waitFor(() => expect(ui.getByTestId('enabled').props.children).toBe('false'));\r\n  });\r\n});\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]}