00f6e5de36f870173de1ec46918a5d16
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var _vocabularyDataHelper = require("../utils/vocabulary/vocabularyDataHelper");
var useRealTimeProgress = function useRealTimeProgress() {
  var _useState = (0, _react.useState)({}),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    levelProgress = _useState2[0],
    setLevelProgress = _useState2[1];
  var _useState3 = (0, _react.useState)({}),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    exerciseProgress = _useState4[0],
    setExerciseProgress = _useState4[1];
  var _useState5 = (0, _react.useState)(true),
    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),
    isLoading = _useState6[0],
    setIsLoading = _useState6[1];
  var calculateVocabularyProgress = function () {
    var _ref = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `vocabulary_${level}_classic`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        var completedWords = data.completedWords || {};
        var vocabularyData = (0, _vocabularyDataHelper.getVocabularyData)(level, 'classic');
        if (!(vocabularyData != null && vocabularyData.exercises)) return 0;
        var totalWords = vocabularyData.exercises.reduce(function (sum, cat) {
          var _cat$words;
          return sum + (((_cat$words = cat.words) == null ? void 0 : _cat$words.length) || 0);
        }, 0);
        var completedCount = 0;
        Object.values(completedWords).forEach(function (categoryWords) {
          if (Array.isArray(categoryWords)) {
            completedCount += categoryWords.length;
          }
        });
        var percentage = totalWords > 0 ? completedCount / totalWords * 100 : 0;
        return Math.min(Math.round(percentage), 100);
      } catch (error) {
        return 0;
      }
    });
    return function calculateVocabularyProgress(_x) {
      return _ref.apply(this, arguments);
    };
  }();
  var calculateVocabularyFastProgress = function () {
    var _ref2 = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `vocabulary_${level}_fast`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        var completedWords = data.completedWords || {};
        var vocabularyData = (0, _vocabularyDataHelper.getVocabularyData)(level, 'fast');
        if (!(vocabularyData != null && vocabularyData.exercises)) return 0;
        var totalWords = vocabularyData.exercises.reduce(function (sum, cat) {
          var _cat$words2;
          return sum + (((_cat$words2 = cat.words) == null ? void 0 : _cat$words2.length) || 0);
        }, 0);
        var completedCount = 0;
        Object.values(completedWords).forEach(function (categoryWords) {
          if (Array.isArray(categoryWords)) {
            completedCount += categoryWords.length;
          }
        });
        var percentage = totalWords > 0 ? completedCount / totalWords * 100 : 0;
        return Math.min(Math.round(percentage), 100);
      } catch (error) {
        return 0;
      }
    });
    return function calculateVocabularyFastProgress(_x2) {
      return _ref2.apply(this, arguments);
    };
  }();
  var calculateGrammarProgress = function () {
    var _ref3 = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `grammar_${level}`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        var completedExercises = data.completedExercises || {};
        var completedCount = 0;
        Object.values(completedExercises).forEach(function (exerciseIndices) {
          if (Array.isArray(exerciseIndices)) {
            completedCount += exerciseIndices.length;
          }
        });
        var EXERCISES_PER_LEVEL = 20;
        var percentage = completedCount / EXERCISES_PER_LEVEL * 100;
        return Math.min(Math.round(percentage), 100);
      } catch (error) {
        return 0;
      }
    });
    return function calculateGrammarProgress(_x3) {
      return _ref3.apply(this, arguments);
    };
  }();
  var calculateReadingProgress = function () {
    var _ref4 = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `reading_${level}`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        var completedQuestions = data.completedQuestions || {};
        var completedCount = 0;
        Object.values(completedQuestions).forEach(function (questionIndices) {
          if (Array.isArray(questionIndices)) {
            completedCount += questionIndices.length;
          }
        });
        var QUESTIONS_PER_LEVEL = 15;
        var percentage = completedCount / QUESTIONS_PER_LEVEL * 100;
        return Math.min(Math.round(percentage), 100);
      } catch (error) {
        return 0;
      }
    });
    return function calculateReadingProgress(_x4) {
      return _ref4.apply(this, arguments);
    };
  }();
  var calculateSpellingProgress = function () {
    var _ref5 = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `spelling_${level}_correction`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        var completedExercises = data.completedExercises || [];
        var EXERCISES_PER_LEVEL = 25;
        var percentage = completedExercises.length / EXERCISES_PER_LEVEL * 100;
        return Math.min(Math.round(percentage), 100);
      } catch (error) {
        return 0;
      }
    });
    return function calculateSpellingProgress(_x5) {
      return _ref5.apply(this, arguments);
    };
  }();
  var calculatePhrasesProgress = function () {
    var _ref6 = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `phrases_${level}`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        var completedPhrases = data.completedPhrases || {};
        var completedCount = 0;
        Object.values(completedPhrases).forEach(function (phraseIndices) {
          if (Array.isArray(phraseIndices)) {
            completedCount += phraseIndices.length;
          }
        });
        var PHRASES_PER_LEVEL = 30;
        var percentage = completedCount / PHRASES_PER_LEVEL * 100;
        return Math.min(Math.round(percentage), 100);
      } catch (error) {
        return 0;
      }
    });
    return function calculatePhrasesProgress(_x6) {
      return _ref6.apply(this, arguments);
    };
  }();
  var calculateConversationsProgress = function () {
    var _ref7 = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `conversation_${level}`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        var completedScenarios = data.completedScenarios || {};
        var completedCount = Object.values(completedScenarios).filter(function (scenario) {
          return scenario && (scenario.completed || scenario.completedAt);
        }).length;
        var CONVERSATIONS_PER_LEVEL = 8;
        var percentage = completedCount / CONVERSATIONS_PER_LEVEL * 100;
        return Math.min(Math.round(percentage), 100);
      } catch (error) {
        return 0;
      }
    });
    return function calculateConversationsProgress(_x7) {
      return _ref7.apply(this, arguments);
    };
  }();
  var calculateErrorCorrectionProgress = function () {
    var _ref8 = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `error_correction_${level}`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        var completedExercises = data.completedExercises || {};
        var completedCount = 0;
        Object.values(completedExercises).forEach(function (exerciseIndices) {
          if (Array.isArray(exerciseIndices)) {
            completedCount += exerciseIndices.length;
          }
        });
        var EXERCISES_PER_LEVEL = 20;
        var percentage = completedCount / EXERCISES_PER_LEVEL * 100;
        return Math.min(Math.round(percentage), 100);
      } catch (error) {
        return 0;
      }
    });
    return function calculateErrorCorrectionProgress(_x8) {
      return _ref8.apply(this, arguments);
    };
  }();
  var calculateWordGamesProgress = function () {
    var _ref9 = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `word_games_completed_${level}`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        var completedCount = Object.values(data).filter(function (game) {
          return game == null ? void 0 : game.completed;
        }).length;
        var GAMES_PER_LEVEL = 10;
        var percentage = completedCount / GAMES_PER_LEVEL * 100;
        return Math.min(Math.round(percentage), 100);
      } catch (error) {
        return 0;
      }
    });
    return function calculateWordGamesProgress(_x9) {
      return _ref9.apply(this, arguments);
    };
  }();
  var calculateAssessmentProgress = function () {
    var _ref0 = (0, _asyncToGenerator2.default)(function* (level) {
      try {
        var storageKey = `assessment_results_${level}`;
        var savedData = yield _asyncStorage.default.getItem(storageKey);
        if (!savedData) return 0;
        var data = JSON.parse(savedData);
        return data.completedAt ? 100 : 0;
      } catch (error) {
        return 0;
      }
    });
    return function calculateAssessmentProgress(_x0) {
      return _ref0.apply(this, arguments);
    };
  }();
  var calculateProgress = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    try {
      setIsLoading(true);
      var newLevelProgress = {};
      var newExerciseProgress = {};
      var levels = ['1', '2', '3', '4', '5', '6', 'bonus'];
      for (var level of levels) {
        var exerciseCalculators = {
          vocabulary: calculateVocabularyProgress,
          vocabulary_fast: calculateVocabularyFastProgress,
          grammar: calculateGrammarProgress,
          reading: calculateReadingProgress,
          spelling: calculateSpellingProgress,
          phrases: calculatePhrasesProgress,
          conversations: calculateConversationsProgress,
          errorCorrection: calculateErrorCorrectionProgress,
          wordGames: calculateWordGamesProgress,
          assessment: calculateAssessmentProgress
        };
        var availableExercises = level === 'bonus' ? ['reading', 'vocabulary', 'phrases'] : Object.keys(exerciseCalculators);
        var levelTotal = 0;
        var levelCompleted = 0;
        for (var exerciseType of availableExercises) {
          try {
            var calculator = exerciseCalculators[exerciseType];
            var progressForExercise = yield calculator(level);
            if (!newExerciseProgress[exerciseType]) {
              newExerciseProgress[exerciseType] = {};
            }
            newExerciseProgress[exerciseType][level] = progressForExercise;
            levelTotal += 100;
            levelCompleted += progressForExercise;
          } catch (error) {
            console.warn(`Erreur calcul ${exerciseType} niveau ${level}:`, error);
          }
        }
        newLevelProgress[level] = levelTotal > 0 ? Math.round(levelCompleted / levelTotal * 100) : 0;
      }
      setLevelProgress(newLevelProgress);
      setExerciseProgress(newExerciseProgress);
    } catch (error) {
      console.error('Erreur calcul progression:', error);
    } finally {
      setIsLoading(false);
    }
  }), []);
  var getLevelProgress = (0, _react.useCallback)(function (level) {
    return levelProgress[level] || 0;
  }, [levelProgress]);
  var getExerciseProgress = (0, _react.useCallback)(function (exerciseType, level) {
    var _exerciseProgress$exe;
    return ((_exerciseProgress$exe = exerciseProgress[exerciseType]) == null ? void 0 : _exerciseProgress$exe[level]) || 0;
  }, [exerciseProgress]);
  var hasProgress = (0, _react.useCallback)(function (exerciseType, level) {
    return getExerciseProgress(exerciseType, level) > 0;
  }, [getExerciseProgress]);
  var hasVocabularyStarted = (0, _react.useCallback)(function (level) {
    return hasProgress('vocabulary', level);
  }, [hasProgress]);
  var hasVocabularyFastStarted = (0, _react.useCallback)(function (level) {
    return hasProgress('vocabulary_fast', level);
  }, [hasProgress]);
  (0, _react.useEffect)(function () {
    calculateProgress();
  }, [calculateProgress]);
  var refresh = (0, _react.useCallback)(function () {
    calculateProgress();
  }, [calculateProgress]);
  return {
    levelProgress: levelProgress,
    exerciseProgress: exerciseProgress,
    isLoading: isLoading,
    getLevelProgress: getLevelProgress,
    getExerciseProgress: getExerciseProgress,
    hasProgress: hasProgress,
    hasVocabularyStarted: hasVocabularyStarted,
    hasVocabularyFastStarted: hasVocabularyFastStarted,
    refresh: refresh
  };
};
var _default = exports.default = useRealTimeProgress;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX2FzeW5jU3RvcmFnZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfdm9jYWJ1bGFyeURhdGFIZWxwZXIiLCJ1c2VSZWFsVGltZVByb2dyZXNzIiwiX3VzZVN0YXRlIiwidXNlU3RhdGUiLCJfdXNlU3RhdGUyIiwiX3NsaWNlZFRvQXJyYXkyIiwiZGVmYXVsdCIsImxldmVsUHJvZ3Jlc3MiLCJzZXRMZXZlbFByb2dyZXNzIiwiX3VzZVN0YXRlMyIsIl91c2VTdGF0ZTQiLCJleGVyY2lzZVByb2dyZXNzIiwic2V0RXhlcmNpc2VQcm9ncmVzcyIsIl91c2VTdGF0ZTUiLCJfdXNlU3RhdGU2IiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwiY2FsY3VsYXRlVm9jYWJ1bGFyeVByb2dyZXNzIiwiX3JlZiIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImxldmVsIiwic3RvcmFnZUtleSIsInNhdmVkRGF0YSIsIkFzeW5jU3RvcmFnZSIsImdldEl0ZW0iLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwiY29tcGxldGVkV29yZHMiLCJ2b2NhYnVsYXJ5RGF0YSIsImdldFZvY2FidWxhcnlEYXRhIiwiZXhlcmNpc2VzIiwidG90YWxXb3JkcyIsInJlZHVjZSIsInN1bSIsImNhdCIsIl9jYXQkd29yZHMiLCJ3b3JkcyIsImxlbmd0aCIsImNvbXBsZXRlZENvdW50IiwiT2JqZWN0IiwidmFsdWVzIiwiZm9yRWFjaCIsImNhdGVnb3J5V29yZHMiLCJBcnJheSIsImlzQXJyYXkiLCJwZXJjZW50YWdlIiwiTWF0aCIsIm1pbiIsInJvdW5kIiwiZXJyb3IiLCJfeCIsImFwcGx5IiwiYXJndW1lbnRzIiwiY2FsY3VsYXRlVm9jYWJ1bGFyeUZhc3RQcm9ncmVzcyIsIl9yZWYyIiwiX2NhdCR3b3JkczIiLCJfeDIiLCJjYWxjdWxhdGVHcmFtbWFyUHJvZ3Jlc3MiLCJfcmVmMyIsImNvbXBsZXRlZEV4ZXJjaXNlcyIsImV4ZXJjaXNlSW5kaWNlcyIsIkVYRVJDSVNFU19QRVJfTEVWRUwiLCJfeDMiLCJjYWxjdWxhdGVSZWFkaW5nUHJvZ3Jlc3MiLCJfcmVmNCIsImNvbXBsZXRlZFF1ZXN0aW9ucyIsInF1ZXN0aW9uSW5kaWNlcyIsIlFVRVNUSU9OU19QRVJfTEVWRUwiLCJfeDQiLCJjYWxjdWxhdGVTcGVsbGluZ1Byb2dyZXNzIiwiX3JlZjUiLCJfeDUiLCJjYWxjdWxhdGVQaHJhc2VzUHJvZ3Jlc3MiLCJfcmVmNiIsImNvbXBsZXRlZFBocmFzZXMiLCJwaHJhc2VJbmRpY2VzIiwiUEhSQVNFU19QRVJfTEVWRUwiLCJfeDYiLCJjYWxjdWxhdGVDb252ZXJzYXRpb25zUHJvZ3Jlc3MiLCJfcmVmNyIsImNvbXBsZXRlZFNjZW5hcmlvcyIsImZpbHRlciIsInNjZW5hcmlvIiwiY29tcGxldGVkIiwiY29tcGxldGVkQXQiLCJDT05WRVJTQVRJT05TX1BFUl9MRVZFTCIsIl94NyIsImNhbGN1bGF0ZUVycm9yQ29ycmVjdGlvblByb2dyZXNzIiwiX3JlZjgiLCJfeDgiLCJjYWxjdWxhdGVXb3JkR2FtZXNQcm9ncmVzcyIsIl9yZWY5IiwiZ2FtZSIsIkdBTUVTX1BFUl9MRVZFTCIsIl94OSIsImNhbGN1bGF0ZUFzc2Vzc21lbnRQcm9ncmVzcyIsIl9yZWYwIiwiX3gwIiwiY2FsY3VsYXRlUHJvZ3Jlc3MiLCJ1c2VDYWxsYmFjayIsIm5ld0xldmVsUHJvZ3Jlc3MiLCJuZXdFeGVyY2lzZVByb2dyZXNzIiwibGV2ZWxzIiwiZXhlcmNpc2VDYWxjdWxhdG9ycyIsInZvY2FidWxhcnkiLCJ2b2NhYnVsYXJ5X2Zhc3QiLCJncmFtbWFyIiwicmVhZGluZyIsInNwZWxsaW5nIiwicGhyYXNlcyIsImNvbnZlcnNhdGlvbnMiLCJlcnJvckNvcnJlY3Rpb24iLCJ3b3JkR2FtZXMiLCJhc3Nlc3NtZW50IiwiYXZhaWxhYmxlRXhlcmNpc2VzIiwia2V5cyIsImxldmVsVG90YWwiLCJsZXZlbENvbXBsZXRlZCIsImV4ZXJjaXNlVHlwZSIsImNhbGN1bGF0b3IiLCJwcm9ncmVzc0ZvckV4ZXJjaXNlIiwiY29uc29sZSIsIndhcm4iLCJnZXRMZXZlbFByb2dyZXNzIiwiZ2V0RXhlcmNpc2VQcm9ncmVzcyIsIl9leGVyY2lzZVByb2dyZXNzJGV4ZSIsImhhc1Byb2dyZXNzIiwiaGFzVm9jYWJ1bGFyeVN0YXJ0ZWQiLCJoYXNWb2NhYnVsYXJ5RmFzdFN0YXJ0ZWQiLCJ1c2VFZmZlY3QiLCJyZWZyZXNoIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsidXNlUmVhbFRpbWVQcm9ncmVzcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvaG9va3MvdXNlUmVhbFRpbWVQcm9ncmVzcy5qcyAtIENPUlJJR8OJIC0gSnVzdGUgbGVzIHZyYWllcyBkb25uw6llc1xyXG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VDYWxsYmFjayB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IEFzeW5jU3RvcmFnZSBmcm9tICdAcmVhY3QtbmF0aXZlLWFzeW5jLXN0b3JhZ2UvYXN5bmMtc3RvcmFnZSc7XHJcbmltcG9ydCB7IGdldFZvY2FidWxhcnlEYXRhIH0gZnJvbSAnLi4vdXRpbHMvdm9jYWJ1bGFyeS92b2NhYnVsYXJ5RGF0YUhlbHBlcic7XHJcblxyXG5jb25zdCB1c2VSZWFsVGltZVByb2dyZXNzID0gKCkgPT4ge1xyXG4gIGNvbnN0IFtsZXZlbFByb2dyZXNzLCBzZXRMZXZlbFByb2dyZXNzXSA9IHVzZVN0YXRlKHt9KTtcclxuICBjb25zdCBbZXhlcmNpc2VQcm9ncmVzcywgc2V0RXhlcmNpc2VQcm9ncmVzc10gPSB1c2VTdGF0ZSh7fSk7XHJcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xyXG5cclxuICAvLyA9PT09PT09PT09PT09PT09PT09IFZPQ0FCVUxBSVJFIC0gQ09SUkVDVElPTiBQUklOQ0lQQUxFID09PT09PT09PT09PT09PT09PT1cclxuICBcclxuICBjb25zdCBjYWxjdWxhdGVWb2NhYnVsYXJ5UHJvZ3Jlc3MgPSBhc3luYyAobGV2ZWwpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBgdm9jYWJ1bGFyeV8ke2xldmVsfV9jbGFzc2ljYDtcclxuICAgICAgY29uc3Qgc2F2ZWREYXRhID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEl0ZW0oc3RvcmFnZUtleSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXNhdmVkRGF0YSkgcmV0dXJuIDA7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShzYXZlZERhdGEpO1xyXG4gICAgICBjb25zdCBjb21wbGV0ZWRXb3JkcyA9IGRhdGEuY29tcGxldGVkV29yZHMgfHwge307XHJcbiAgICAgIFxyXG4gICAgICAvLyDinIUgRklYIDogUsOpY3Vww6lyZXIgbGVzIFZSQUlFUyBkb25uw6llcyBjb21tZSB1c2VWb2NhYnVsYXJ5LmpzXHJcbiAgICAgIGNvbnN0IHZvY2FidWxhcnlEYXRhID0gZ2V0Vm9jYWJ1bGFyeURhdGEobGV2ZWwsICdjbGFzc2ljJyk7XHJcbiAgICAgIGlmICghdm9jYWJ1bGFyeURhdGE/LmV4ZXJjaXNlcykgcmV0dXJuIDA7XHJcbiAgICAgIFxyXG4gICAgICAvLyDinIUgRklYIDogQ2FsY3VsIHLDqWVsIGR1IHRvdGFsIGNvbW1lIGxpZ25lIDE2OCBkZSB1c2VWb2NhYnVsYXJ5LmpzXHJcbiAgICAgIGNvbnN0IHRvdGFsV29yZHMgPSB2b2NhYnVsYXJ5RGF0YS5leGVyY2lzZXMucmVkdWNlKChzdW0sIGNhdCkgPT4gXHJcbiAgICAgICAgc3VtICsgKGNhdC53b3Jkcz8ubGVuZ3RoIHx8IDApLCAwXHJcbiAgICAgICk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDb21wdGVyIG1vdHMgY29tcGzDqXTDqXNcclxuICAgICAgbGV0IGNvbXBsZXRlZENvdW50ID0gMDtcclxuICAgICAgT2JqZWN0LnZhbHVlcyhjb21wbGV0ZWRXb3JkcykuZm9yRWFjaChjYXRlZ29yeVdvcmRzID0+IHtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjYXRlZ29yeVdvcmRzKSkge1xyXG4gICAgICAgICAgY29tcGxldGVkQ291bnQgKz0gY2F0ZWdvcnlXb3Jkcy5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIOKchSBGSVggOiBDYWxjdWwgY29ycmVjdCBhdSBsaWV1IGRlIGNvbnN0YW50ZSBiaWRvblxyXG4gICAgICBjb25zdCBwZXJjZW50YWdlID0gdG90YWxXb3JkcyA+IDAgPyAoY29tcGxldGVkQ291bnQgLyB0b3RhbFdvcmRzKSAqIDEwMCA6IDA7XHJcbiAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLnJvdW5kKHBlcmNlbnRhZ2UpLCAxMDApO1xyXG4gICAgICBcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIFZPQ0FCVUxBUlkgRkFTVFxyXG4gIGNvbnN0IGNhbGN1bGF0ZVZvY2FidWxhcnlGYXN0UHJvZ3Jlc3MgPSBhc3luYyAobGV2ZWwpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBgdm9jYWJ1bGFyeV8ke2xldmVsfV9mYXN0YDtcclxuICAgICAgY29uc3Qgc2F2ZWREYXRhID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEl0ZW0oc3RvcmFnZUtleSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXNhdmVkRGF0YSkgcmV0dXJuIDA7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShzYXZlZERhdGEpO1xyXG4gICAgICBjb25zdCBjb21wbGV0ZWRXb3JkcyA9IGRhdGEuY29tcGxldGVkV29yZHMgfHwge307XHJcbiAgICAgIFxyXG4gICAgICAvLyDinIUgTcOqbWUgZml4IHBvdXIgZmFzdFxyXG4gICAgICBjb25zdCB2b2NhYnVsYXJ5RGF0YSA9IGdldFZvY2FidWxhcnlEYXRhKGxldmVsLCAnZmFzdCcpO1xyXG4gICAgICBpZiAoIXZvY2FidWxhcnlEYXRhPy5leGVyY2lzZXMpIHJldHVybiAwO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgdG90YWxXb3JkcyA9IHZvY2FidWxhcnlEYXRhLmV4ZXJjaXNlcy5yZWR1Y2UoKHN1bSwgY2F0KSA9PiBcclxuICAgICAgICBzdW0gKyAoY2F0LndvcmRzPy5sZW5ndGggfHwgMCksIDBcclxuICAgICAgKTtcclxuICAgICAgXHJcbiAgICAgIGxldCBjb21wbGV0ZWRDb3VudCA9IDA7XHJcbiAgICAgIE9iamVjdC52YWx1ZXMoY29tcGxldGVkV29yZHMpLmZvckVhY2goY2F0ZWdvcnlXb3JkcyA9PiB7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY2F0ZWdvcnlXb3JkcykpIHtcclxuICAgICAgICAgIGNvbXBsZXRlZENvdW50ICs9IGNhdGVnb3J5V29yZHMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBwZXJjZW50YWdlID0gdG90YWxXb3JkcyA+IDAgPyAoY29tcGxldGVkQ291bnQgLyB0b3RhbFdvcmRzKSAqIDEwMCA6IDA7XHJcbiAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLnJvdW5kKHBlcmNlbnRhZ2UpLCAxMDApO1xyXG4gICAgICBcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIEdSQU1NQVJcclxuICBjb25zdCBjYWxjdWxhdGVHcmFtbWFyUHJvZ3Jlc3MgPSBhc3luYyAobGV2ZWwpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBgZ3JhbW1hcl8ke2xldmVsfWA7XHJcbiAgICAgIGNvbnN0IHNhdmVkRGF0YSA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKHN0b3JhZ2VLZXkpO1xyXG4gICAgICBcclxuICAgICAgaWYgKCFzYXZlZERhdGEpIHJldHVybiAwO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2Uoc2F2ZWREYXRhKTtcclxuICAgICAgY29uc3QgY29tcGxldGVkRXhlcmNpc2VzID0gZGF0YS5jb21wbGV0ZWRFeGVyY2lzZXMgfHwge307XHJcbiAgICAgIFxyXG4gICAgICBsZXQgY29tcGxldGVkQ291bnQgPSAwO1xyXG4gICAgICBPYmplY3QudmFsdWVzKGNvbXBsZXRlZEV4ZXJjaXNlcykuZm9yRWFjaChleGVyY2lzZUluZGljZXMgPT4ge1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGV4ZXJjaXNlSW5kaWNlcykpIHtcclxuICAgICAgICAgIGNvbXBsZXRlZENvdW50ICs9IGV4ZXJjaXNlSW5kaWNlcy5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIEVzdGltYXRpb24gcsOpYWxpc3RlICjDoCBhanVzdGVyIHNlbG9uIHZvcyB2cmFpZXMgZG9ubsOpZXMpXHJcbiAgICAgIGNvbnN0IEVYRVJDSVNFU19QRVJfTEVWRUwgPSAyMDtcclxuICAgICAgY29uc3QgcGVyY2VudGFnZSA9IChjb21wbGV0ZWRDb3VudCAvIEVYRVJDSVNFU19QRVJfTEVWRUwpICogMTAwO1xyXG4gICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5yb3VuZChwZXJjZW50YWdlKSwgMTAwKTtcclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyBSRUFESU5HXHJcbiAgY29uc3QgY2FsY3VsYXRlUmVhZGluZ1Byb2dyZXNzID0gYXN5bmMgKGxldmVsKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzdG9yYWdlS2V5ID0gYHJlYWRpbmdfJHtsZXZlbH1gO1xyXG4gICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KTtcclxuICAgICAgXHJcbiAgICAgIGlmICghc2F2ZWREYXRhKSByZXR1cm4gMDtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHNhdmVkRGF0YSk7XHJcbiAgICAgIGNvbnN0IGNvbXBsZXRlZFF1ZXN0aW9ucyA9IGRhdGEuY29tcGxldGVkUXVlc3Rpb25zIHx8IHt9O1xyXG4gICAgICBcclxuICAgICAgbGV0IGNvbXBsZXRlZENvdW50ID0gMDtcclxuICAgICAgT2JqZWN0LnZhbHVlcyhjb21wbGV0ZWRRdWVzdGlvbnMpLmZvckVhY2gocXVlc3Rpb25JbmRpY2VzID0+IHtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShxdWVzdGlvbkluZGljZXMpKSB7XHJcbiAgICAgICAgICBjb21wbGV0ZWRDb3VudCArPSBxdWVzdGlvbkluZGljZXMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBRVUVTVElPTlNfUEVSX0xFVkVMID0gMTU7XHJcbiAgICAgIGNvbnN0IHBlcmNlbnRhZ2UgPSAoY29tcGxldGVkQ291bnQgLyBRVUVTVElPTlNfUEVSX0xFVkVMKSAqIDEwMDtcclxuICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgucm91bmQocGVyY2VudGFnZSksIDEwMCk7XHJcbiAgICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gU1BFTExJTkdcclxuICBjb25zdCBjYWxjdWxhdGVTcGVsbGluZ1Byb2dyZXNzID0gYXN5bmMgKGxldmVsKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzdG9yYWdlS2V5ID0gYHNwZWxsaW5nXyR7bGV2ZWx9X2NvcnJlY3Rpb25gO1xyXG4gICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KTtcclxuICAgICAgXHJcbiAgICAgIGlmICghc2F2ZWREYXRhKSByZXR1cm4gMDtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHNhdmVkRGF0YSk7XHJcbiAgICAgIGNvbnN0IGNvbXBsZXRlZEV4ZXJjaXNlcyA9IGRhdGEuY29tcGxldGVkRXhlcmNpc2VzIHx8IFtdO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgRVhFUkNJU0VTX1BFUl9MRVZFTCA9IDI1O1xyXG4gICAgICBjb25zdCBwZXJjZW50YWdlID0gKGNvbXBsZXRlZEV4ZXJjaXNlcy5sZW5ndGggLyBFWEVSQ0lTRVNfUEVSX0xFVkVMKSAqIDEwMDtcclxuICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgucm91bmQocGVyY2VudGFnZSksIDEwMCk7XHJcbiAgICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gUEhSQVNFU1xyXG4gIGNvbnN0IGNhbGN1bGF0ZVBocmFzZXNQcm9ncmVzcyA9IGFzeW5jIChsZXZlbCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3Qgc3RvcmFnZUtleSA9IGBwaHJhc2VzXyR7bGV2ZWx9YDtcclxuICAgICAgY29uc3Qgc2F2ZWREYXRhID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEl0ZW0oc3RvcmFnZUtleSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXNhdmVkRGF0YSkgcmV0dXJuIDA7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShzYXZlZERhdGEpO1xyXG4gICAgICBjb25zdCBjb21wbGV0ZWRQaHJhc2VzID0gZGF0YS5jb21wbGV0ZWRQaHJhc2VzIHx8IHt9O1xyXG4gICAgICBcclxuICAgICAgbGV0IGNvbXBsZXRlZENvdW50ID0gMDtcclxuICAgICAgT2JqZWN0LnZhbHVlcyhjb21wbGV0ZWRQaHJhc2VzKS5mb3JFYWNoKHBocmFzZUluZGljZXMgPT4ge1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHBocmFzZUluZGljZXMpKSB7XHJcbiAgICAgICAgICBjb21wbGV0ZWRDb3VudCArPSBwaHJhc2VJbmRpY2VzLmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgUEhSQVNFU19QRVJfTEVWRUwgPSAzMDtcclxuICAgICAgY29uc3QgcGVyY2VudGFnZSA9IChjb21wbGV0ZWRDb3VudCAvIFBIUkFTRVNfUEVSX0xFVkVMKSAqIDEwMDtcclxuICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgucm91bmQocGVyY2VudGFnZSksIDEwMCk7XHJcbiAgICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gQ09OVkVSU0FUSU9OU1xyXG4gIGNvbnN0IGNhbGN1bGF0ZUNvbnZlcnNhdGlvbnNQcm9ncmVzcyA9IGFzeW5jIChsZXZlbCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3Qgc3RvcmFnZUtleSA9IGBjb252ZXJzYXRpb25fJHtsZXZlbH1gO1xyXG4gICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KTtcclxuICAgICAgXHJcbiAgICAgIGlmICghc2F2ZWREYXRhKSByZXR1cm4gMDtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHNhdmVkRGF0YSk7XHJcbiAgICAgIGNvbnN0IGNvbXBsZXRlZFNjZW5hcmlvcyA9IGRhdGEuY29tcGxldGVkU2NlbmFyaW9zIHx8IHt9O1xyXG4gICAgICBcclxuICAgICAgY29uc3QgY29tcGxldGVkQ291bnQgPSBPYmplY3QudmFsdWVzKGNvbXBsZXRlZFNjZW5hcmlvcykuZmlsdGVyKHNjZW5hcmlvID0+IFxyXG4gICAgICAgIHNjZW5hcmlvICYmIChzY2VuYXJpby5jb21wbGV0ZWQgfHwgc2NlbmFyaW8uY29tcGxldGVkQXQpXHJcbiAgICAgICkubGVuZ3RoO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgQ09OVkVSU0FUSU9OU19QRVJfTEVWRUwgPSA4O1xyXG4gICAgICBjb25zdCBwZXJjZW50YWdlID0gKGNvbXBsZXRlZENvdW50IC8gQ09OVkVSU0FUSU9OU19QRVJfTEVWRUwpICogMTAwO1xyXG4gICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5yb3VuZChwZXJjZW50YWdlKSwgMTAwKTtcclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyBFUlJPUiBDT1JSRUNUSU9OXHJcbiAgY29uc3QgY2FsY3VsYXRlRXJyb3JDb3JyZWN0aW9uUHJvZ3Jlc3MgPSBhc3luYyAobGV2ZWwpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBgZXJyb3JfY29ycmVjdGlvbl8ke2xldmVsfWA7XHJcbiAgICAgIGNvbnN0IHNhdmVkRGF0YSA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKHN0b3JhZ2VLZXkpO1xyXG4gICAgICBcclxuICAgICAgaWYgKCFzYXZlZERhdGEpIHJldHVybiAwO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2Uoc2F2ZWREYXRhKTtcclxuICAgICAgY29uc3QgY29tcGxldGVkRXhlcmNpc2VzID0gZGF0YS5jb21wbGV0ZWRFeGVyY2lzZXMgfHwge307XHJcbiAgICAgIFxyXG4gICAgICBsZXQgY29tcGxldGVkQ291bnQgPSAwO1xyXG4gICAgICBPYmplY3QudmFsdWVzKGNvbXBsZXRlZEV4ZXJjaXNlcykuZm9yRWFjaChleGVyY2lzZUluZGljZXMgPT4ge1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGV4ZXJjaXNlSW5kaWNlcykpIHtcclxuICAgICAgICAgIGNvbXBsZXRlZENvdW50ICs9IGV4ZXJjaXNlSW5kaWNlcy5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IEVYRVJDSVNFU19QRVJfTEVWRUwgPSAyMDtcclxuICAgICAgY29uc3QgcGVyY2VudGFnZSA9IChjb21wbGV0ZWRDb3VudCAvIEVYRVJDSVNFU19QRVJfTEVWRUwpICogMTAwO1xyXG4gICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5yb3VuZChwZXJjZW50YWdlKSwgMTAwKTtcclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyBXT1JEIEdBTUVTXHJcbiAgY29uc3QgY2FsY3VsYXRlV29yZEdhbWVzUHJvZ3Jlc3MgPSBhc3luYyAobGV2ZWwpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBgd29yZF9nYW1lc19jb21wbGV0ZWRfJHtsZXZlbH1gO1xyXG4gICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KTtcclxuICAgICAgXHJcbiAgICAgIGlmICghc2F2ZWREYXRhKSByZXR1cm4gMDtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHNhdmVkRGF0YSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBjb21wbGV0ZWRDb3VudCA9IE9iamVjdC52YWx1ZXMoZGF0YSkuZmlsdGVyKGdhbWUgPT4gXHJcbiAgICAgICAgZ2FtZT8uY29tcGxldGVkXHJcbiAgICAgICkubGVuZ3RoO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgR0FNRVNfUEVSX0xFVkVMID0gMTA7XHJcbiAgICAgIGNvbnN0IHBlcmNlbnRhZ2UgPSAoY29tcGxldGVkQ291bnQgLyBHQU1FU19QRVJfTEVWRUwpICogMTAwO1xyXG4gICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5yb3VuZChwZXJjZW50YWdlKSwgMTAwKTtcclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyBBU1NFU1NNRU5UXHJcbiAgY29uc3QgY2FsY3VsYXRlQXNzZXNzbWVudFByb2dyZXNzID0gYXN5bmMgKGxldmVsKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzdG9yYWdlS2V5ID0gYGFzc2Vzc21lbnRfcmVzdWx0c18ke2xldmVsfWA7XHJcbiAgICAgIGNvbnN0IHNhdmVkRGF0YSA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKHN0b3JhZ2VLZXkpO1xyXG4gICAgICBcclxuICAgICAgaWYgKCFzYXZlZERhdGEpIHJldHVybiAwO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2Uoc2F2ZWREYXRhKTtcclxuICAgICAgcmV0dXJuIGRhdGEuY29tcGxldGVkQXQgPyAxMDAgOiAwO1xyXG4gICAgICBcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vID09PT09PT09PT09PT09PT09PT0gQ0FMQ1VMIEdMT0JBTCA9PT09PT09PT09PT09PT09PT09XHJcbiAgY29uc3QgY2FsY3VsYXRlUHJvZ3Jlc3MgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBuZXdMZXZlbFByb2dyZXNzID0ge307XHJcbiAgICAgIGNvbnN0IG5ld0V4ZXJjaXNlUHJvZ3Jlc3MgPSB7fTtcclxuXHJcbiAgICAgIGNvbnN0IGxldmVscyA9IFsnMScsICcyJywgJzMnLCAnNCcsICc1JywgJzYnLCAnYm9udXMnXTtcclxuICAgICAgXHJcbiAgICAgIGZvciAoY29uc3QgbGV2ZWwgb2YgbGV2ZWxzKSB7XHJcbiAgICAgICAgY29uc3QgZXhlcmNpc2VDYWxjdWxhdG9ycyA9IHtcclxuICAgICAgICAgIHZvY2FidWxhcnk6IGNhbGN1bGF0ZVZvY2FidWxhcnlQcm9ncmVzcyxcclxuICAgICAgICAgIHZvY2FidWxhcnlfZmFzdDogY2FsY3VsYXRlVm9jYWJ1bGFyeUZhc3RQcm9ncmVzcyxcclxuICAgICAgICAgIGdyYW1tYXI6IGNhbGN1bGF0ZUdyYW1tYXJQcm9ncmVzcyxcclxuICAgICAgICAgIHJlYWRpbmc6IGNhbGN1bGF0ZVJlYWRpbmdQcm9ncmVzcyxcclxuICAgICAgICAgIHNwZWxsaW5nOiBjYWxjdWxhdGVTcGVsbGluZ1Byb2dyZXNzLFxyXG4gICAgICAgICAgcGhyYXNlczogY2FsY3VsYXRlUGhyYXNlc1Byb2dyZXNzLFxyXG4gICAgICAgICAgY29udmVyc2F0aW9uczogY2FsY3VsYXRlQ29udmVyc2F0aW9uc1Byb2dyZXNzLFxyXG4gICAgICAgICAgZXJyb3JDb3JyZWN0aW9uOiBjYWxjdWxhdGVFcnJvckNvcnJlY3Rpb25Qcm9ncmVzcyxcclxuICAgICAgICAgIHdvcmRHYW1lczogY2FsY3VsYXRlV29yZEdhbWVzUHJvZ3Jlc3MsXHJcbiAgICAgICAgICBhc3Nlc3NtZW50OiBjYWxjdWxhdGVBc3Nlc3NtZW50UHJvZ3Jlc3MsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgYXZhaWxhYmxlRXhlcmNpc2VzID0gbGV2ZWwgPT09ICdib251cycgXHJcbiAgICAgICAgICA/IFsncmVhZGluZycsICd2b2NhYnVsYXJ5JywgJ3BocmFzZXMnXVxyXG4gICAgICAgICAgOiBPYmplY3Qua2V5cyhleGVyY2lzZUNhbGN1bGF0b3JzKTtcclxuXHJcbiAgICAgICAgbGV0IGxldmVsVG90YWwgPSAwO1xyXG4gICAgICAgIGxldCBsZXZlbENvbXBsZXRlZCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgZXhlcmNpc2VUeXBlIG9mIGF2YWlsYWJsZUV4ZXJjaXNlcykge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgY2FsY3VsYXRvciA9IGV4ZXJjaXNlQ2FsY3VsYXRvcnNbZXhlcmNpc2VUeXBlXTtcclxuICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NGb3JFeGVyY2lzZSA9IGF3YWl0IGNhbGN1bGF0b3IobGV2ZWwpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFuZXdFeGVyY2lzZVByb2dyZXNzW2V4ZXJjaXNlVHlwZV0pIHtcclxuICAgICAgICAgICAgICBuZXdFeGVyY2lzZVByb2dyZXNzW2V4ZXJjaXNlVHlwZV0gPSB7fTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBuZXdFeGVyY2lzZVByb2dyZXNzW2V4ZXJjaXNlVHlwZV1bbGV2ZWxdID0gcHJvZ3Jlc3NGb3JFeGVyY2lzZTtcclxuXHJcbiAgICAgICAgICAgIGxldmVsVG90YWwgKz0gMTAwO1xyXG4gICAgICAgICAgICBsZXZlbENvbXBsZXRlZCArPSBwcm9ncmVzc0ZvckV4ZXJjaXNlO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgRXJyZXVyIGNhbGN1bCAke2V4ZXJjaXNlVHlwZX0gbml2ZWF1ICR7bGV2ZWx9OmAsIGVycm9yKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG5ld0xldmVsUHJvZ3Jlc3NbbGV2ZWxdID0gbGV2ZWxUb3RhbCA+IDAgXHJcbiAgICAgICAgICA/IE1hdGgucm91bmQoKGxldmVsQ29tcGxldGVkIC8gbGV2ZWxUb3RhbCkgKiAxMDApXHJcbiAgICAgICAgICA6IDA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHNldExldmVsUHJvZ3Jlc3MobmV3TGV2ZWxQcm9ncmVzcyk7XHJcbiAgICAgIHNldEV4ZXJjaXNlUHJvZ3Jlc3MobmV3RXhlcmNpc2VQcm9ncmVzcyk7XHJcbiAgICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyZXVyIGNhbGN1bCBwcm9ncmVzc2lvbjonLCBlcnJvcik7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xyXG4gICAgfVxyXG4gIH0sIFtdKTtcclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PSBHRVRURVJTID09PT09PT09PT09PT09PT09PT1cclxuICBcclxuICBjb25zdCBnZXRMZXZlbFByb2dyZXNzID0gdXNlQ2FsbGJhY2soKGxldmVsKSA9PiB7XHJcbiAgICByZXR1cm4gbGV2ZWxQcm9ncmVzc1tsZXZlbF0gfHwgMDtcclxuICB9LCBbbGV2ZWxQcm9ncmVzc10pO1xyXG5cclxuICBjb25zdCBnZXRFeGVyY2lzZVByb2dyZXNzID0gdXNlQ2FsbGJhY2soKGV4ZXJjaXNlVHlwZSwgbGV2ZWwpID0+IHtcclxuICAgIHJldHVybiBleGVyY2lzZVByb2dyZXNzW2V4ZXJjaXNlVHlwZV0/LltsZXZlbF0gfHwgMDtcclxuICB9LCBbZXhlcmNpc2VQcm9ncmVzc10pO1xyXG5cclxuICBjb25zdCBoYXNQcm9ncmVzcyA9IHVzZUNhbGxiYWNrKChleGVyY2lzZVR5cGUsIGxldmVsKSA9PiB7XHJcbiAgICByZXR1cm4gZ2V0RXhlcmNpc2VQcm9ncmVzcyhleGVyY2lzZVR5cGUsIGxldmVsKSA+IDA7XHJcbiAgfSwgW2dldEV4ZXJjaXNlUHJvZ3Jlc3NdKTtcclxuXHJcbiAgY29uc3QgaGFzVm9jYWJ1bGFyeVN0YXJ0ZWQgPSB1c2VDYWxsYmFjaygobGV2ZWwpID0+IHtcclxuICAgIHJldHVybiBoYXNQcm9ncmVzcygndm9jYWJ1bGFyeScsIGxldmVsKTtcclxuICB9LCBbaGFzUHJvZ3Jlc3NdKTtcclxuXHJcbiAgY29uc3QgaGFzVm9jYWJ1bGFyeUZhc3RTdGFydGVkID0gdXNlQ2FsbGJhY2soKGxldmVsKSA9PiB7XHJcbiAgICByZXR1cm4gaGFzUHJvZ3Jlc3MoJ3ZvY2FidWxhcnlfZmFzdCcsIGxldmVsKTtcclxuICB9LCBbaGFzUHJvZ3Jlc3NdKTtcclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PSBJTklUID09PT09PT09PT09PT09PT09PT1cclxuICBcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgY2FsY3VsYXRlUHJvZ3Jlc3MoKTtcclxuICB9LCBbY2FsY3VsYXRlUHJvZ3Jlc3NdKTtcclxuXHJcbiAgY29uc3QgcmVmcmVzaCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcclxuICAgIGNhbGN1bGF0ZVByb2dyZXNzKCk7XHJcbiAgfSwgW2NhbGN1bGF0ZVByb2dyZXNzXSk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBsZXZlbFByb2dyZXNzLFxyXG4gICAgZXhlcmNpc2VQcm9ncmVzcyxcclxuICAgIGlzTG9hZGluZyxcclxuICAgIGdldExldmVsUHJvZ3Jlc3MsXHJcbiAgICBnZXRFeGVyY2lzZVByb2dyZXNzLFxyXG4gICAgaGFzUHJvZ3Jlc3MsXHJcbiAgICBoYXNWb2NhYnVsYXJ5U3RhcnRlZCxcclxuICAgIGhhc1ZvY2FidWxhcnlGYXN0U3RhcnRlZCxcclxuICAgIHJlZnJlc2gsXHJcbiAgfTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHVzZVJlYWxUaW1lUHJvZ3Jlc3M7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ0EsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsYUFBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUcscUJBQUEsR0FBQUgsT0FBQTtBQUVBLElBQU1JLG1CQUFtQixHQUFHLFNBQXRCQSxtQkFBbUJBLENBQUEsRUFBUztFQUNoQyxJQUFBQyxTQUFBLEdBQTBDLElBQUFDLGVBQVEsRUFBQyxDQUFDLENBQUMsQ0FBQztJQUFBQyxVQUFBLE9BQUFDLGVBQUEsQ0FBQUMsT0FBQSxFQUFBSixTQUFBO0lBQS9DSyxhQUFhLEdBQUFILFVBQUE7SUFBRUksZ0JBQWdCLEdBQUFKLFVBQUE7RUFDdEMsSUFBQUssVUFBQSxHQUFnRCxJQUFBTixlQUFRLEVBQUMsQ0FBQyxDQUFDLENBQUM7SUFBQU8sVUFBQSxPQUFBTCxlQUFBLENBQUFDLE9BQUEsRUFBQUcsVUFBQTtJQUFyREUsZ0JBQWdCLEdBQUFELFVBQUE7SUFBRUUsbUJBQW1CLEdBQUFGLFVBQUE7RUFDNUMsSUFBQUcsVUFBQSxHQUFrQyxJQUFBVixlQUFRLEVBQUMsSUFBSSxDQUFDO0lBQUFXLFVBQUEsT0FBQVQsZUFBQSxDQUFBQyxPQUFBLEVBQUFPLFVBQUE7SUFBekNFLFNBQVMsR0FBQUQsVUFBQTtJQUFFRSxZQUFZLEdBQUFGLFVBQUE7RUFJOUIsSUFBTUcsMkJBQTJCO0lBQUEsSUFBQUMsSUFBQSxPQUFBQyxrQkFBQSxDQUFBYixPQUFBLEVBQUcsV0FBT2MsS0FBSyxFQUFLO01BQ25ELElBQUk7UUFDRixJQUFNQyxVQUFVLEdBQUcsY0FBY0QsS0FBSyxVQUFVO1FBQ2hELElBQU1FLFNBQVMsU0FBU0MscUJBQVksQ0FBQ0MsT0FBTyxDQUFDSCxVQUFVLENBQUM7UUFFeEQsSUFBSSxDQUFDQyxTQUFTLEVBQUUsT0FBTyxDQUFDO1FBRXhCLElBQU1HLElBQUksR0FBR0MsSUFBSSxDQUFDQyxLQUFLLENBQUNMLFNBQVMsQ0FBQztRQUNsQyxJQUFNTSxjQUFjLEdBQUdILElBQUksQ0FBQ0csY0FBYyxJQUFJLENBQUMsQ0FBQztRQUdoRCxJQUFNQyxjQUFjLEdBQUcsSUFBQUMsdUNBQWlCLEVBQUNWLEtBQUssRUFBRSxTQUFTLENBQUM7UUFDMUQsSUFBSSxFQUFDUyxjQUFjLFlBQWRBLGNBQWMsQ0FBRUUsU0FBUyxHQUFFLE9BQU8sQ0FBQztRQUd4QyxJQUFNQyxVQUFVLEdBQUdILGNBQWMsQ0FBQ0UsU0FBUyxDQUFDRSxNQUFNLENBQUMsVUFBQ0MsR0FBRyxFQUFFQyxHQUFHO1VBQUEsSUFBQUMsVUFBQTtVQUFBLE9BQzFERixHQUFHLElBQUksRUFBQUUsVUFBQSxHQUFBRCxHQUFHLENBQUNFLEtBQUsscUJBQVRELFVBQUEsQ0FBV0UsTUFBTSxLQUFJLENBQUMsQ0FBQztRQUFBLEdBQUUsQ0FDbEMsQ0FBQztRQUdELElBQUlDLGNBQWMsR0FBRyxDQUFDO1FBQ3RCQyxNQUFNLENBQUNDLE1BQU0sQ0FBQ2IsY0FBYyxDQUFDLENBQUNjLE9BQU8sQ0FBQyxVQUFBQyxhQUFhLEVBQUk7VUFDckQsSUFBSUMsS0FBSyxDQUFDQyxPQUFPLENBQUNGLGFBQWEsQ0FBQyxFQUFFO1lBQ2hDSixjQUFjLElBQUlJLGFBQWEsQ0FBQ0wsTUFBTTtVQUN4QztRQUNGLENBQUMsQ0FBQztRQUdGLElBQU1RLFVBQVUsR0FBR2QsVUFBVSxHQUFHLENBQUMsR0FBSU8sY0FBYyxHQUFHUCxVQUFVLEdBQUksR0FBRyxHQUFHLENBQUM7UUFDM0UsT0FBT2UsSUFBSSxDQUFDQyxHQUFHLENBQUNELElBQUksQ0FBQ0UsS0FBSyxDQUFDSCxVQUFVLENBQUMsRUFBRSxHQUFHLENBQUM7TUFFOUMsQ0FBQyxDQUFDLE9BQU9JLEtBQUssRUFBRTtRQUNkLE9BQU8sQ0FBQztNQUNWO0lBQ0YsQ0FBQztJQUFBLGdCQWxDS2pDLDJCQUEyQkEsQ0FBQWtDLEVBQUE7TUFBQSxPQUFBakMsSUFBQSxDQUFBa0MsS0FBQSxPQUFBQyxTQUFBO0lBQUE7RUFBQSxHQWtDaEM7RUFHRCxJQUFNQywrQkFBK0I7SUFBQSxJQUFBQyxLQUFBLE9BQUFwQyxrQkFBQSxDQUFBYixPQUFBLEVBQUcsV0FBT2MsS0FBSyxFQUFLO01BQ3ZELElBQUk7UUFDRixJQUFNQyxVQUFVLEdBQUcsY0FBY0QsS0FBSyxPQUFPO1FBQzdDLElBQU1FLFNBQVMsU0FBU0MscUJBQVksQ0FBQ0MsT0FBTyxDQUFDSCxVQUFVLENBQUM7UUFFeEQsSUFBSSxDQUFDQyxTQUFTLEVBQUUsT0FBTyxDQUFDO1FBRXhCLElBQU1HLElBQUksR0FBR0MsSUFBSSxDQUFDQyxLQUFLLENBQUNMLFNBQVMsQ0FBQztRQUNsQyxJQUFNTSxjQUFjLEdBQUdILElBQUksQ0FBQ0csY0FBYyxJQUFJLENBQUMsQ0FBQztRQUdoRCxJQUFNQyxjQUFjLEdBQUcsSUFBQUMsdUNBQWlCLEVBQUNWLEtBQUssRUFBRSxNQUFNLENBQUM7UUFDdkQsSUFBSSxFQUFDUyxjQUFjLFlBQWRBLGNBQWMsQ0FBRUUsU0FBUyxHQUFFLE9BQU8sQ0FBQztRQUV4QyxJQUFNQyxVQUFVLEdBQUdILGNBQWMsQ0FBQ0UsU0FBUyxDQUFDRSxNQUFNLENBQUMsVUFBQ0MsR0FBRyxFQUFFQyxHQUFHO1VBQUEsSUFBQXFCLFdBQUE7VUFBQSxPQUMxRHRCLEdBQUcsSUFBSSxFQUFBc0IsV0FBQSxHQUFBckIsR0FBRyxDQUFDRSxLQUFLLHFCQUFUbUIsV0FBQSxDQUFXbEIsTUFBTSxLQUFJLENBQUMsQ0FBQztRQUFBLEdBQUUsQ0FDbEMsQ0FBQztRQUVELElBQUlDLGNBQWMsR0FBRyxDQUFDO1FBQ3RCQyxNQUFNLENBQUNDLE1BQU0sQ0FBQ2IsY0FBYyxDQUFDLENBQUNjLE9BQU8sQ0FBQyxVQUFBQyxhQUFhLEVBQUk7VUFDckQsSUFBSUMsS0FBSyxDQUFDQyxPQUFPLENBQUNGLGFBQWEsQ0FBQyxFQUFFO1lBQ2hDSixjQUFjLElBQUlJLGFBQWEsQ0FBQ0wsTUFBTTtVQUN4QztRQUNGLENBQUMsQ0FBQztRQUVGLElBQU1RLFVBQVUsR0FBR2QsVUFBVSxHQUFHLENBQUMsR0FBSU8sY0FBYyxHQUFHUCxVQUFVLEdBQUksR0FBRyxHQUFHLENBQUM7UUFDM0UsT0FBT2UsSUFBSSxDQUFDQyxHQUFHLENBQUNELElBQUksQ0FBQ0UsS0FBSyxDQUFDSCxVQUFVLENBQUMsRUFBRSxHQUFHLENBQUM7TUFFOUMsQ0FBQyxDQUFDLE9BQU9JLEtBQUssRUFBRTtRQUNkLE9BQU8sQ0FBQztNQUNWO0lBQ0YsQ0FBQztJQUFBLGdCQS9CS0ksK0JBQStCQSxDQUFBRyxHQUFBO01BQUEsT0FBQUYsS0FBQSxDQUFBSCxLQUFBLE9BQUFDLFNBQUE7SUFBQTtFQUFBLEdBK0JwQztFQUdELElBQU1LLHdCQUF3QjtJQUFBLElBQUFDLEtBQUEsT0FBQXhDLGtCQUFBLENBQUFiLE9BQUEsRUFBRyxXQUFPYyxLQUFLLEVBQUs7TUFDaEQsSUFBSTtRQUNGLElBQU1DLFVBQVUsR0FBRyxXQUFXRCxLQUFLLEVBQUU7UUFDckMsSUFBTUUsU0FBUyxTQUFTQyxxQkFBWSxDQUFDQyxPQUFPLENBQUNILFVBQVUsQ0FBQztRQUV4RCxJQUFJLENBQUNDLFNBQVMsRUFBRSxPQUFPLENBQUM7UUFFeEIsSUFBTUcsSUFBSSxHQUFHQyxJQUFJLENBQUNDLEtBQUssQ0FBQ0wsU0FBUyxDQUFDO1FBQ2xDLElBQU1zQyxrQkFBa0IsR0FBR25DLElBQUksQ0FBQ21DLGtCQUFrQixJQUFJLENBQUMsQ0FBQztRQUV4RCxJQUFJckIsY0FBYyxHQUFHLENBQUM7UUFDdEJDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDbUIsa0JBQWtCLENBQUMsQ0FBQ2xCLE9BQU8sQ0FBQyxVQUFBbUIsZUFBZSxFQUFJO1VBQzNELElBQUlqQixLQUFLLENBQUNDLE9BQU8sQ0FBQ2dCLGVBQWUsQ0FBQyxFQUFFO1lBQ2xDdEIsY0FBYyxJQUFJc0IsZUFBZSxDQUFDdkIsTUFBTTtVQUMxQztRQUNGLENBQUMsQ0FBQztRQUdGLElBQU13QixtQkFBbUIsR0FBRyxFQUFFO1FBQzlCLElBQU1oQixVQUFVLEdBQUlQLGNBQWMsR0FBR3VCLG1CQUFtQixHQUFJLEdBQUc7UUFDL0QsT0FBT2YsSUFBSSxDQUFDQyxHQUFHLENBQUNELElBQUksQ0FBQ0UsS0FBSyxDQUFDSCxVQUFVLENBQUMsRUFBRSxHQUFHLENBQUM7TUFFOUMsQ0FBQyxDQUFDLE9BQU9JLEtBQUssRUFBRTtRQUNkLE9BQU8sQ0FBQztNQUNWO0lBQ0YsQ0FBQztJQUFBLGdCQXpCS1Esd0JBQXdCQSxDQUFBSyxHQUFBO01BQUEsT0FBQUosS0FBQSxDQUFBUCxLQUFBLE9BQUFDLFNBQUE7SUFBQTtFQUFBLEdBeUI3QjtFQUdELElBQU1XLHdCQUF3QjtJQUFBLElBQUFDLEtBQUEsT0FBQTlDLGtCQUFBLENBQUFiLE9BQUEsRUFBRyxXQUFPYyxLQUFLLEVBQUs7TUFDaEQsSUFBSTtRQUNGLElBQU1DLFVBQVUsR0FBRyxXQUFXRCxLQUFLLEVBQUU7UUFDckMsSUFBTUUsU0FBUyxTQUFTQyxxQkFBWSxDQUFDQyxPQUFPLENBQUNILFVBQVUsQ0FBQztRQUV4RCxJQUFJLENBQUNDLFNBQVMsRUFBRSxPQUFPLENBQUM7UUFFeEIsSUFBTUcsSUFBSSxHQUFHQyxJQUFJLENBQUNDLEtBQUssQ0FBQ0wsU0FBUyxDQUFDO1FBQ2xDLElBQU00QyxrQkFBa0IsR0FBR3pDLElBQUksQ0FBQ3lDLGtCQUFrQixJQUFJLENBQUMsQ0FBQztRQUV4RCxJQUFJM0IsY0FBYyxHQUFHLENBQUM7UUFDdEJDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDeUIsa0JBQWtCLENBQUMsQ0FBQ3hCLE9BQU8sQ0FBQyxVQUFBeUIsZUFBZSxFQUFJO1VBQzNELElBQUl2QixLQUFLLENBQUNDLE9BQU8sQ0FBQ3NCLGVBQWUsQ0FBQyxFQUFFO1lBQ2xDNUIsY0FBYyxJQUFJNEIsZUFBZSxDQUFDN0IsTUFBTTtVQUMxQztRQUNGLENBQUMsQ0FBQztRQUVGLElBQU04QixtQkFBbUIsR0FBRyxFQUFFO1FBQzlCLElBQU10QixVQUFVLEdBQUlQLGNBQWMsR0FBRzZCLG1CQUFtQixHQUFJLEdBQUc7UUFDL0QsT0FBT3JCLElBQUksQ0FBQ0MsR0FBRyxDQUFDRCxJQUFJLENBQUNFLEtBQUssQ0FBQ0gsVUFBVSxDQUFDLEVBQUUsR0FBRyxDQUFDO01BRTlDLENBQUMsQ0FBQyxPQUFPSSxLQUFLLEVBQUU7UUFDZCxPQUFPLENBQUM7TUFDVjtJQUNGLENBQUM7SUFBQSxnQkF4QktjLHdCQUF3QkEsQ0FBQUssR0FBQTtNQUFBLE9BQUFKLEtBQUEsQ0FBQWIsS0FBQSxPQUFBQyxTQUFBO0lBQUE7RUFBQSxHQXdCN0I7RUFHRCxJQUFNaUIseUJBQXlCO0lBQUEsSUFBQUMsS0FBQSxPQUFBcEQsa0JBQUEsQ0FBQWIsT0FBQSxFQUFHLFdBQU9jLEtBQUssRUFBSztNQUNqRCxJQUFJO1FBQ0YsSUFBTUMsVUFBVSxHQUFHLFlBQVlELEtBQUssYUFBYTtRQUNqRCxJQUFNRSxTQUFTLFNBQVNDLHFCQUFZLENBQUNDLE9BQU8sQ0FBQ0gsVUFBVSxDQUFDO1FBRXhELElBQUksQ0FBQ0MsU0FBUyxFQUFFLE9BQU8sQ0FBQztRQUV4QixJQUFNRyxJQUFJLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDTCxTQUFTLENBQUM7UUFDbEMsSUFBTXNDLGtCQUFrQixHQUFHbkMsSUFBSSxDQUFDbUMsa0JBQWtCLElBQUksRUFBRTtRQUV4RCxJQUFNRSxtQkFBbUIsR0FBRyxFQUFFO1FBQzlCLElBQU1oQixVQUFVLEdBQUljLGtCQUFrQixDQUFDdEIsTUFBTSxHQUFHd0IsbUJBQW1CLEdBQUksR0FBRztRQUMxRSxPQUFPZixJQUFJLENBQUNDLEdBQUcsQ0FBQ0QsSUFBSSxDQUFDRSxLQUFLLENBQUNILFVBQVUsQ0FBQyxFQUFFLEdBQUcsQ0FBQztNQUU5QyxDQUFDLENBQUMsT0FBT0ksS0FBSyxFQUFFO1FBQ2QsT0FBTyxDQUFDO01BQ1Y7SUFDRixDQUFDO0lBQUEsZ0JBakJLb0IseUJBQXlCQSxDQUFBRSxHQUFBO01BQUEsT0FBQUQsS0FBQSxDQUFBbkIsS0FBQSxPQUFBQyxTQUFBO0lBQUE7RUFBQSxHQWlCOUI7RUFHRCxJQUFNb0Isd0JBQXdCO0lBQUEsSUFBQUMsS0FBQSxPQUFBdkQsa0JBQUEsQ0FBQWIsT0FBQSxFQUFHLFdBQU9jLEtBQUssRUFBSztNQUNoRCxJQUFJO1FBQ0YsSUFBTUMsVUFBVSxHQUFHLFdBQVdELEtBQUssRUFBRTtRQUNyQyxJQUFNRSxTQUFTLFNBQVNDLHFCQUFZLENBQUNDLE9BQU8sQ0FBQ0gsVUFBVSxDQUFDO1FBRXhELElBQUksQ0FBQ0MsU0FBUyxFQUFFLE9BQU8sQ0FBQztRQUV4QixJQUFNRyxJQUFJLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDTCxTQUFTLENBQUM7UUFDbEMsSUFBTXFELGdCQUFnQixHQUFHbEQsSUFBSSxDQUFDa0QsZ0JBQWdCLElBQUksQ0FBQyxDQUFDO1FBRXBELElBQUlwQyxjQUFjLEdBQUcsQ0FBQztRQUN0QkMsTUFBTSxDQUFDQyxNQUFNLENBQUNrQyxnQkFBZ0IsQ0FBQyxDQUFDakMsT0FBTyxDQUFDLFVBQUFrQyxhQUFhLEVBQUk7VUFDdkQsSUFBSWhDLEtBQUssQ0FBQ0MsT0FBTyxDQUFDK0IsYUFBYSxDQUFDLEVBQUU7WUFDaENyQyxjQUFjLElBQUlxQyxhQUFhLENBQUN0QyxNQUFNO1VBQ3hDO1FBQ0YsQ0FBQyxDQUFDO1FBRUYsSUFBTXVDLGlCQUFpQixHQUFHLEVBQUU7UUFDNUIsSUFBTS9CLFVBQVUsR0FBSVAsY0FBYyxHQUFHc0MsaUJBQWlCLEdBQUksR0FBRztRQUM3RCxPQUFPOUIsSUFBSSxDQUFDQyxHQUFHLENBQUNELElBQUksQ0FBQ0UsS0FBSyxDQUFDSCxVQUFVLENBQUMsRUFBRSxHQUFHLENBQUM7TUFFOUMsQ0FBQyxDQUFDLE9BQU9JLEtBQUssRUFBRTtRQUNkLE9BQU8sQ0FBQztNQUNWO0lBQ0YsQ0FBQztJQUFBLGdCQXhCS3VCLHdCQUF3QkEsQ0FBQUssR0FBQTtNQUFBLE9BQUFKLEtBQUEsQ0FBQXRCLEtBQUEsT0FBQUMsU0FBQTtJQUFBO0VBQUEsR0F3QjdCO0VBR0QsSUFBTTBCLDhCQUE4QjtJQUFBLElBQUFDLEtBQUEsT0FBQTdELGtCQUFBLENBQUFiLE9BQUEsRUFBRyxXQUFPYyxLQUFLLEVBQUs7TUFDdEQsSUFBSTtRQUNGLElBQU1DLFVBQVUsR0FBRyxnQkFBZ0JELEtBQUssRUFBRTtRQUMxQyxJQUFNRSxTQUFTLFNBQVNDLHFCQUFZLENBQUNDLE9BQU8sQ0FBQ0gsVUFBVSxDQUFDO1FBRXhELElBQUksQ0FBQ0MsU0FBUyxFQUFFLE9BQU8sQ0FBQztRQUV4QixJQUFNRyxJQUFJLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDTCxTQUFTLENBQUM7UUFDbEMsSUFBTTJELGtCQUFrQixHQUFHeEQsSUFBSSxDQUFDd0Qsa0JBQWtCLElBQUksQ0FBQyxDQUFDO1FBRXhELElBQU0xQyxjQUFjLEdBQUdDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDd0Msa0JBQWtCLENBQUMsQ0FBQ0MsTUFBTSxDQUFDLFVBQUFDLFFBQVE7VUFBQSxPQUN0RUEsUUFBUSxLQUFLQSxRQUFRLENBQUNDLFNBQVMsSUFBSUQsUUFBUSxDQUFDRSxXQUFXLENBQUM7UUFBQSxDQUMxRCxDQUFDLENBQUMvQyxNQUFNO1FBRVIsSUFBTWdELHVCQUF1QixHQUFHLENBQUM7UUFDakMsSUFBTXhDLFVBQVUsR0FBSVAsY0FBYyxHQUFHK0MsdUJBQXVCLEdBQUksR0FBRztRQUNuRSxPQUFPdkMsSUFBSSxDQUFDQyxHQUFHLENBQUNELElBQUksQ0FBQ0UsS0FBSyxDQUFDSCxVQUFVLENBQUMsRUFBRSxHQUFHLENBQUM7TUFFOUMsQ0FBQyxDQUFDLE9BQU9JLEtBQUssRUFBRTtRQUNkLE9BQU8sQ0FBQztNQUNWO0lBQ0YsQ0FBQztJQUFBLGdCQXJCSzZCLDhCQUE4QkEsQ0FBQVEsR0FBQTtNQUFBLE9BQUFQLEtBQUEsQ0FBQTVCLEtBQUEsT0FBQUMsU0FBQTtJQUFBO0VBQUEsR0FxQm5DO0VBR0QsSUFBTW1DLGdDQUFnQztJQUFBLElBQUFDLEtBQUEsT0FBQXRFLGtCQUFBLENBQUFiLE9BQUEsRUFBRyxXQUFPYyxLQUFLLEVBQUs7TUFDeEQsSUFBSTtRQUNGLElBQU1DLFVBQVUsR0FBRyxvQkFBb0JELEtBQUssRUFBRTtRQUM5QyxJQUFNRSxTQUFTLFNBQVNDLHFCQUFZLENBQUNDLE9BQU8sQ0FBQ0gsVUFBVSxDQUFDO1FBRXhELElBQUksQ0FBQ0MsU0FBUyxFQUFFLE9BQU8sQ0FBQztRQUV4QixJQUFNRyxJQUFJLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDTCxTQUFTLENBQUM7UUFDbEMsSUFBTXNDLGtCQUFrQixHQUFHbkMsSUFBSSxDQUFDbUMsa0JBQWtCLElBQUksQ0FBQyxDQUFDO1FBRXhELElBQUlyQixjQUFjLEdBQUcsQ0FBQztRQUN0QkMsTUFBTSxDQUFDQyxNQUFNLENBQUNtQixrQkFBa0IsQ0FBQyxDQUFDbEIsT0FBTyxDQUFDLFVBQUFtQixlQUFlLEVBQUk7VUFDM0QsSUFBSWpCLEtBQUssQ0FBQ0MsT0FBTyxDQUFDZ0IsZUFBZSxDQUFDLEVBQUU7WUFDbEN0QixjQUFjLElBQUlzQixlQUFlLENBQUN2QixNQUFNO1VBQzFDO1FBQ0YsQ0FBQyxDQUFDO1FBRUYsSUFBTXdCLG1CQUFtQixHQUFHLEVBQUU7UUFDOUIsSUFBTWhCLFVBQVUsR0FBSVAsY0FBYyxHQUFHdUIsbUJBQW1CLEdBQUksR0FBRztRQUMvRCxPQUFPZixJQUFJLENBQUNDLEdBQUcsQ0FBQ0QsSUFBSSxDQUFDRSxLQUFLLENBQUNILFVBQVUsQ0FBQyxFQUFFLEdBQUcsQ0FBQztNQUU5QyxDQUFDLENBQUMsT0FBT0ksS0FBSyxFQUFFO1FBQ2QsT0FBTyxDQUFDO01BQ1Y7SUFDRixDQUFDO0lBQUEsZ0JBeEJLc0MsZ0NBQWdDQSxDQUFBRSxHQUFBO01BQUEsT0FBQUQsS0FBQSxDQUFBckMsS0FBQSxPQUFBQyxTQUFBO0lBQUE7RUFBQSxHQXdCckM7RUFHRCxJQUFNc0MsMEJBQTBCO0lBQUEsSUFBQUMsS0FBQSxPQUFBekUsa0JBQUEsQ0FBQWIsT0FBQSxFQUFHLFdBQU9jLEtBQUssRUFBSztNQUNsRCxJQUFJO1FBQ0YsSUFBTUMsVUFBVSxHQUFHLHdCQUF3QkQsS0FBSyxFQUFFO1FBQ2xELElBQU1FLFNBQVMsU0FBU0MscUJBQVksQ0FBQ0MsT0FBTyxDQUFDSCxVQUFVLENBQUM7UUFFeEQsSUFBSSxDQUFDQyxTQUFTLEVBQUUsT0FBTyxDQUFDO1FBRXhCLElBQU1HLElBQUksR0FBR0MsSUFBSSxDQUFDQyxLQUFLLENBQUNMLFNBQVMsQ0FBQztRQUVsQyxJQUFNaUIsY0FBYyxHQUFHQyxNQUFNLENBQUNDLE1BQU0sQ0FBQ2hCLElBQUksQ0FBQyxDQUFDeUQsTUFBTSxDQUFDLFVBQUFXLElBQUk7VUFBQSxPQUNwREEsSUFBSSxvQkFBSkEsSUFBSSxDQUFFVCxTQUFTO1FBQUEsQ0FDakIsQ0FBQyxDQUFDOUMsTUFBTTtRQUVSLElBQU13RCxlQUFlLEdBQUcsRUFBRTtRQUMxQixJQUFNaEQsVUFBVSxHQUFJUCxjQUFjLEdBQUd1RCxlQUFlLEdBQUksR0FBRztRQUMzRCxPQUFPL0MsSUFBSSxDQUFDQyxHQUFHLENBQUNELElBQUksQ0FBQ0UsS0FBSyxDQUFDSCxVQUFVLENBQUMsRUFBRSxHQUFHLENBQUM7TUFFOUMsQ0FBQyxDQUFDLE9BQU9JLEtBQUssRUFBRTtRQUNkLE9BQU8sQ0FBQztNQUNWO0lBQ0YsQ0FBQztJQUFBLGdCQXBCS3lDLDBCQUEwQkEsQ0FBQUksR0FBQTtNQUFBLE9BQUFILEtBQUEsQ0FBQXhDLEtBQUEsT0FBQUMsU0FBQTtJQUFBO0VBQUEsR0FvQi9CO0VBR0QsSUFBTTJDLDJCQUEyQjtJQUFBLElBQUFDLEtBQUEsT0FBQTlFLGtCQUFBLENBQUFiLE9BQUEsRUFBRyxXQUFPYyxLQUFLLEVBQUs7TUFDbkQsSUFBSTtRQUNGLElBQU1DLFVBQVUsR0FBRyxzQkFBc0JELEtBQUssRUFBRTtRQUNoRCxJQUFNRSxTQUFTLFNBQVNDLHFCQUFZLENBQUNDLE9BQU8sQ0FBQ0gsVUFBVSxDQUFDO1FBRXhELElBQUksQ0FBQ0MsU0FBUyxFQUFFLE9BQU8sQ0FBQztRQUV4QixJQUFNRyxJQUFJLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDTCxTQUFTLENBQUM7UUFDbEMsT0FBT0csSUFBSSxDQUFDNEQsV0FBVyxHQUFHLEdBQUcsR0FBRyxDQUFDO01BRW5DLENBQUMsQ0FBQyxPQUFPbkMsS0FBSyxFQUFFO1FBQ2QsT0FBTyxDQUFDO01BQ1Y7SUFDRixDQUFDO0lBQUEsZ0JBYks4QywyQkFBMkJBLENBQUFFLEdBQUE7TUFBQSxPQUFBRCxLQUFBLENBQUE3QyxLQUFBLE9BQUFDLFNBQUE7SUFBQTtFQUFBLEdBYWhDO0VBR0QsSUFBTThDLGlCQUFpQixHQUFHLElBQUFDLGtCQUFXLE1BQUFqRixrQkFBQSxDQUFBYixPQUFBLEVBQUMsYUFBWTtJQUNoRCxJQUFJO01BQ0ZVLFlBQVksQ0FBQyxJQUFJLENBQUM7TUFFbEIsSUFBTXFGLGdCQUFnQixHQUFHLENBQUMsQ0FBQztNQUMzQixJQUFNQyxtQkFBbUIsR0FBRyxDQUFDLENBQUM7TUFFOUIsSUFBTUMsTUFBTSxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsT0FBTyxDQUFDO01BRXRELEtBQUssSUFBTW5GLEtBQUssSUFBSW1GLE1BQU0sRUFBRTtRQUMxQixJQUFNQyxtQkFBbUIsR0FBRztVQUMxQkMsVUFBVSxFQUFFeEYsMkJBQTJCO1VBQ3ZDeUYsZUFBZSxFQUFFcEQsK0JBQStCO1VBQ2hEcUQsT0FBTyxFQUFFakQsd0JBQXdCO1VBQ2pDa0QsT0FBTyxFQUFFNUMsd0JBQXdCO1VBQ2pDNkMsUUFBUSxFQUFFdkMseUJBQXlCO1VBQ25Dd0MsT0FBTyxFQUFFckMsd0JBQXdCO1VBQ2pDc0MsYUFBYSxFQUFFaEMsOEJBQThCO1VBQzdDaUMsZUFBZSxFQUFFeEIsZ0NBQWdDO1VBQ2pEeUIsU0FBUyxFQUFFdEIsMEJBQTBCO1VBQ3JDdUIsVUFBVSxFQUFFbEI7UUFDZCxDQUFDO1FBRUQsSUFBTW1CLGtCQUFrQixHQUFHL0YsS0FBSyxLQUFLLE9BQU8sR0FDeEMsQ0FBQyxTQUFTLEVBQUUsWUFBWSxFQUFFLFNBQVMsQ0FBQyxHQUNwQ29CLE1BQU0sQ0FBQzRFLElBQUksQ0FBQ1osbUJBQW1CLENBQUM7UUFFcEMsSUFBSWEsVUFBVSxHQUFHLENBQUM7UUFDbEIsSUFBSUMsY0FBYyxHQUFHLENBQUM7UUFFdEIsS0FBSyxJQUFNQyxZQUFZLElBQUlKLGtCQUFrQixFQUFFO1VBQzdDLElBQUk7WUFDRixJQUFNSyxVQUFVLEdBQUdoQixtQkFBbUIsQ0FBQ2UsWUFBWSxDQUFDO1lBQ3BELElBQU1FLG1CQUFtQixTQUFTRCxVQUFVLENBQUNwRyxLQUFLLENBQUM7WUFFbkQsSUFBSSxDQUFDa0YsbUJBQW1CLENBQUNpQixZQUFZLENBQUMsRUFBRTtjQUN0Q2pCLG1CQUFtQixDQUFDaUIsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3hDO1lBQ0FqQixtQkFBbUIsQ0FBQ2lCLFlBQVksQ0FBQyxDQUFDbkcsS0FBSyxDQUFDLEdBQUdxRyxtQkFBbUI7WUFFOURKLFVBQVUsSUFBSSxHQUFHO1lBQ2pCQyxjQUFjLElBQUlHLG1CQUFtQjtVQUV2QyxDQUFDLENBQUMsT0FBT3ZFLEtBQUssRUFBRTtZQUNkd0UsT0FBTyxDQUFDQyxJQUFJLENBQUMsaUJBQWlCSixZQUFZLFdBQVduRyxLQUFLLEdBQUcsRUFBRThCLEtBQUssQ0FBQztVQUN2RTtRQUNGO1FBRUFtRCxnQkFBZ0IsQ0FBQ2pGLEtBQUssQ0FBQyxHQUFHaUcsVUFBVSxHQUFHLENBQUMsR0FDcEN0RSxJQUFJLENBQUNFLEtBQUssQ0FBRXFFLGNBQWMsR0FBR0QsVUFBVSxHQUFJLEdBQUcsQ0FBQyxHQUMvQyxDQUFDO01BQ1A7TUFFQTdHLGdCQUFnQixDQUFDNkYsZ0JBQWdCLENBQUM7TUFDbEN6RixtQkFBbUIsQ0FBQzBGLG1CQUFtQixDQUFDO0lBRTFDLENBQUMsQ0FBQyxPQUFPcEQsS0FBSyxFQUFFO01BQ2R3RSxPQUFPLENBQUN4RSxLQUFLLENBQUMsNEJBQTRCLEVBQUVBLEtBQUssQ0FBQztJQUNwRCxDQUFDLFNBQVM7TUFDUmxDLFlBQVksQ0FBQyxLQUFLLENBQUM7SUFDckI7RUFDRixDQUFDLEdBQUUsRUFBRSxDQUFDO0VBSU4sSUFBTTRHLGdCQUFnQixHQUFHLElBQUF4QixrQkFBVyxFQUFDLFVBQUNoRixLQUFLLEVBQUs7SUFDOUMsT0FBT2IsYUFBYSxDQUFDYSxLQUFLLENBQUMsSUFBSSxDQUFDO0VBQ2xDLENBQUMsRUFBRSxDQUFDYixhQUFhLENBQUMsQ0FBQztFQUVuQixJQUFNc0gsbUJBQW1CLEdBQUcsSUFBQXpCLGtCQUFXLEVBQUMsVUFBQ21CLFlBQVksRUFBRW5HLEtBQUssRUFBSztJQUFBLElBQUEwRyxxQkFBQTtJQUMvRCxPQUFPLEVBQUFBLHFCQUFBLEdBQUFuSCxnQkFBZ0IsQ0FBQzRHLFlBQVksQ0FBQyxxQkFBOUJPLHFCQUFBLENBQWlDMUcsS0FBSyxDQUFDLEtBQUksQ0FBQztFQUNyRCxDQUFDLEVBQUUsQ0FBQ1QsZ0JBQWdCLENBQUMsQ0FBQztFQUV0QixJQUFNb0gsV0FBVyxHQUFHLElBQUEzQixrQkFBVyxFQUFDLFVBQUNtQixZQUFZLEVBQUVuRyxLQUFLLEVBQUs7SUFDdkQsT0FBT3lHLG1CQUFtQixDQUFDTixZQUFZLEVBQUVuRyxLQUFLLENBQUMsR0FBRyxDQUFDO0VBQ3JELENBQUMsRUFBRSxDQUFDeUcsbUJBQW1CLENBQUMsQ0FBQztFQUV6QixJQUFNRyxvQkFBb0IsR0FBRyxJQUFBNUIsa0JBQVcsRUFBQyxVQUFDaEYsS0FBSyxFQUFLO0lBQ2xELE9BQU8yRyxXQUFXLENBQUMsWUFBWSxFQUFFM0csS0FBSyxDQUFDO0VBQ3pDLENBQUMsRUFBRSxDQUFDMkcsV0FBVyxDQUFDLENBQUM7RUFFakIsSUFBTUUsd0JBQXdCLEdBQUcsSUFBQTdCLGtCQUFXLEVBQUMsVUFBQ2hGLEtBQUssRUFBSztJQUN0RCxPQUFPMkcsV0FBVyxDQUFDLGlCQUFpQixFQUFFM0csS0FBSyxDQUFDO0VBQzlDLENBQUMsRUFBRSxDQUFDMkcsV0FBVyxDQUFDLENBQUM7RUFJakIsSUFBQUcsZ0JBQVMsRUFBQyxZQUFNO0lBQ2QvQixpQkFBaUIsQ0FBQyxDQUFDO0VBQ3JCLENBQUMsRUFBRSxDQUFDQSxpQkFBaUIsQ0FBQyxDQUFDO0VBRXZCLElBQU1nQyxPQUFPLEdBQUcsSUFBQS9CLGtCQUFXLEVBQUMsWUFBTTtJQUNoQ0QsaUJBQWlCLENBQUMsQ0FBQztFQUNyQixDQUFDLEVBQUUsQ0FBQ0EsaUJBQWlCLENBQUMsQ0FBQztFQUV2QixPQUFPO0lBQ0w1RixhQUFhLEVBQWJBLGFBQWE7SUFDYkksZ0JBQWdCLEVBQWhCQSxnQkFBZ0I7SUFDaEJJLFNBQVMsRUFBVEEsU0FBUztJQUNUNkcsZ0JBQWdCLEVBQWhCQSxnQkFBZ0I7SUFDaEJDLG1CQUFtQixFQUFuQkEsbUJBQW1CO0lBQ25CRSxXQUFXLEVBQVhBLFdBQVc7SUFDWEMsb0JBQW9CLEVBQXBCQSxvQkFBb0I7SUFDcEJDLHdCQUF3QixFQUF4QkEsd0JBQXdCO0lBQ3hCRSxPQUFPLEVBQVBBO0VBQ0YsQ0FBQztBQUNILENBQUM7QUFBQyxJQUFBQyxRQUFBLEdBQUFDLE9BQUEsQ0FBQS9ILE9BQUEsR0FFYUwsbUJBQW1CIiwiaWdub3JlTGlzdCI6W119