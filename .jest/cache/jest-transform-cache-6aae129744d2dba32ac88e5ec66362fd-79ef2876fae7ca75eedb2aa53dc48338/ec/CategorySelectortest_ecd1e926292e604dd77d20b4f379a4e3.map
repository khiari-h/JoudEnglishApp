{"version":3,"names":["_getJestObj","mock","LinearGradient","_ref","children","_require","require","View","_jsxRuntime","jsx","React","MockScrollView","_ref2","props","_objectWithoutProperties2","default","_excluded","Fragment","Object","assign","ScrollView","forwardRef","ref","_interopRequireDefault","_asyncToGenerator2","_react","_reactNative","_reactNative2","_CategorySelector","_require2","jest","mockTimingStart","fn","callback","finished","mockParallelStart","spyOn","Animated","mockReturnValue","start","mockImplementation","interpolate","_nativeTag","setValue","addListener","removeListener","categories","id","name","describe","beforeEach","clearAllMocks","it","_render","render","selectedCategory","onSelectCategory","getByText","expect","toBeTruthy","_render2","fireEvent","press","toHaveBeenCalledWith","_render3","rerender","mockClear","act","toHaveBeenCalledTimes","_render4"],"sources":["CategorySelector.test.js"],"sourcesContent":["import React from 'react';\nimport { render, act, fireEvent } from '@testing-library/react-native';\nimport { Animated } from 'react-native';\nimport CategorySelector from '../../../src/components/exercise-common/CategorySelector';\n\n// ==========================\n// ‚úÖ Mocks essentiels pour les animations et les d√©pendances externes\n// ==========================\n\n// Simule les animations instantan√©ment pour les tests\nconst mockTimingStart = jest.fn((callback) => {\n  if (callback) {\n    callback({ finished: true });\n  }\n});\nconst mockParallelStart = jest.fn((callback) => {\n  if (callback) {\n    callback({ finished: true });\n  }\n});\n\n// Espionne et remplace les fonctions d'animation r√©elles pour les contr√¥ler\njest.spyOn(Animated, 'timing').mockReturnValue({ start: mockTimingStart });\njest.spyOn(Animated, 'parallel').mockReturnValue({ start: mockParallelStart });\njest.spyOn(Animated, 'Value').mockImplementation(() => ({\n  interpolate: jest.fn(() => ({ _nativeTag: 1 })),\n  setValue: jest.fn(),\n  addListener: jest.fn(),\n  removeListener: jest.fn(),\n}));\n\n// Mocke le composant LinearGradient pour √©viter les erreurs de d√©pendance\njest.mock('expo-linear-gradient', () => ({\n  LinearGradient: ({ children }) => {\n    const { View } = require('react-native');\n    return <View>{children}</View>;\n  },\n}));\n\n// Mocke la fonction scrollTo de ScrollView car elle ne fait rien dans l'environnement de test\njest.mock('react-native/Libraries/Components/ScrollView/ScrollView', () => {\n  const React = require('react');\n  const MockScrollView = ({ children, ...props }) => <React.Fragment {...props}>{children}</React.Fragment>;\n  return {\n    ScrollView: React.forwardRef((props, ref) => <MockScrollView {...props} ref={ref} />),\n  };\n});\n\n// ==========================\n// üîπ Donn√©es de test\n// ==========================\nconst categories = [\n  { id: '1', name: 'Grammar' },\n  { id: '2', name: 'Vocabulary' },\n  { id: '3', name: 'Reading' },\n];\n\n// ==========================\n// üß™ Les tests\n// ==========================\ndescribe('CategorySelector', () => {\n  beforeEach(() => {\n    // R√©initialise tous les mocks avant chaque test pour √©viter les interf√©rences\n    jest.clearAllMocks();\n  });\n\n  // Test de rendu et d'√©tat initial\n  it('renders all categories and selects the correct one', () => {\n    const { getByText } = render(\n      <CategorySelector categories={categories} selectedCategory=\"1\" onSelectCategory={() => {}} />\n    );\n\n    expect(getByText('Grammar')).toBeTruthy();\n    expect(getByText('‚ú®')).toBeTruthy(); // V√©rifie la pr√©sence du \"sparkle\" pour l'√©l√©ment s√©lectionn√©\n  });\n\n  // Test d'interaction utilisateur (clic)\n  it('calls onSelectCategory when a new category is pressed', () => {\n    const onSelectCategory = jest.fn();\n    const { getByText } = render(\n      <CategorySelector categories={categories} selectedCategory=\"1\" onSelectCategory={onSelectCategory} />\n    );\n\n    fireEvent.press(getByText('Vocabulary'));\n    expect(onSelectCategory).toHaveBeenCalledWith('2');\n  });\n\n  // Test du comportement d'animation\n  it('triggers an animation when the selectedCategory prop changes', async () => {\n    const { rerender } = render(\n      <CategorySelector categories={categories} selectedCategory=\"1\" onSelectCategory={jest.fn()} />\n    );\n    \n    // On nettoie les appels initiaux pour se concentrer sur le changement de prop\n    mockParallelStart.mockClear();\n\n    // Simule un changement de prop\n    await act(async () => {\n      rerender(\n        <CategorySelector categories={categories} selectedCategory=\"2\" onSelectCategory={jest.fn()} />\n      );\n    });\n\n    // L'animation parall√®le devrait √™tre appel√©e une fois pour la transition\n    expect(mockParallelStart).toHaveBeenCalledTimes(1);\n  });\n\n  // Test de gestion des conflits d'animation\n  it('does not trigger a new animation if one is already in progress', async () => {\n    const { rerender } = render(\n      <CategorySelector categories={categories} selectedCategory=\"1\" onSelectCategory={jest.fn()} />\n    );\n\n    mockParallelStart.mockClear();\n\n    // Premier changement de prop pour d√©marrer l'animation\n    await act(async () => {\n      rerender(\n        <CategorySelector categories={categories} selectedCategory=\"2\" onSelectCategory={jest.fn()} />\n      );\n    });\n\n    // On s'attend √† un appel\n    expect(mockParallelStart).toHaveBeenCalledTimes(1);\n\n    // Deuxi√®me changement de prop imm√©diat\n    await act(async () => {\n      rerender(\n        <CategorySelector categories={categories} selectedCategory=\"1\" onSelectCategory={jest.fn()} />\n      );\n    });\n    \n    // Le nombre d'appels ne doit pas avoir chang√© car isAnimatingRef a bloqu√© le second appel\n    expect(mockParallelStart).toHaveBeenCalledTimes(1);\n  });\n});"],"mappings":"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","ignoreList":[]}