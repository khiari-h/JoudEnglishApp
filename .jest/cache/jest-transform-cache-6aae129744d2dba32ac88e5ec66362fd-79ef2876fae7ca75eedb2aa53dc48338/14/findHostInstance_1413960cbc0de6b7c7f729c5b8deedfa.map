{"version":3,"names":["Object","defineProperty","exports","value","findHostInstance","_errors","require","_PlatformChecker","findHostInstanceFastPath","maybeNativeRef","undefined","__internalInstanceHandle","__nativeTag","_viewConfig","_nativeTag","viewConfig","resolveFindHostInstance_DEPRECATED","findHostInstance_DEPRECATED","isFabric","_ReactFabric$default$","_ReactFabric$default","ReactFabric","default","e","ReanimatedError","_ReactNative$default$","_ReactNative$default","ReactNative","component","hostInstance","_componentRef"],"sources":["findHostInstance.ts"],"sourcesContent":["/* eslint-disable camelcase */\n'use strict';\n\nimport type { IAnimatedComponentInternal } from '../createAnimatedComponent/commonTypes';\nimport { ReanimatedError } from '../errors';\nimport { isFabric } from '../PlatformChecker';\n\ntype HostInstanceFabric = {\n  __internalInstanceHandle?: Record<string, unknown>;\n  __nativeTag?: number;\n  _viewConfig?: Record<string, unknown>;\n};\n\ntype HostInstancePaper = {\n  _nativeTag?: number;\n  viewConfig?: Record<string, unknown>;\n};\n\nexport type HostInstance = HostInstanceFabric & HostInstancePaper;\n\nfunction findHostInstanceFastPath(maybeNativeRef: HostInstance | undefined) {\n  if (!maybeNativeRef) {\n    return undefined;\n  }\n  if (\n    maybeNativeRef.__internalInstanceHandle &&\n    maybeNativeRef.__nativeTag &&\n    maybeNativeRef._viewConfig\n  ) {\n    // This is a native ref to a Fabric component\n    return maybeNativeRef;\n  }\n  if (maybeNativeRef._nativeTag && maybeNativeRef.viewConfig) {\n    // This is a native ref to a Paper component\n    return maybeNativeRef;\n  }\n  // That means it’s a ref to a non-native component, and it’s necessary\n  // to call `findHostInstance_DEPRECATED` on them.\n  return undefined;\n}\n\nfunction resolveFindHostInstance_DEPRECATED() {\n  if (findHostInstance_DEPRECATED !== undefined) {\n    return;\n  }\n  if (isFabric()) {\n    try {\n      const ReactFabric = require('react-native/Libraries/Renderer/shims/ReactFabric');\n      // Since RN 0.77 ReactFabric exports findHostInstance_DEPRECATED in default object so we're trying to\n      // access it first, then fallback on named export\n      findHostInstance_DEPRECATED =\n        ReactFabric?.default?.findHostInstance_DEPRECATED ??\n        ReactFabric?.findHostInstance_DEPRECATED;\n    } catch (e) {\n      throw new ReanimatedError(\n        'Failed to resolve findHostInstance_DEPRECATED'\n      );\n    }\n  } else {\n    const ReactNative = require('react-native/Libraries/Renderer/shims/ReactNative');\n    // Since RN 0.77 ReactFabric exports findHostInstance_DEPRECATED in default object so we're trying to\n    // access it first, then fallback on named export\n    findHostInstance_DEPRECATED =\n      ReactNative?.default?.findHostInstance_DEPRECATED ??\n      ReactNative?.findHostInstance_DEPRECATED;\n  }\n}\n\nlet findHostInstance_DEPRECATED: (ref: unknown) => HostInstance;\nexport function findHostInstance(\n  component: IAnimatedComponentInternal | React.Component\n): HostInstance {\n  // Fast path for native refs\n  const hostInstance = findHostInstanceFastPath(\n    (component as IAnimatedComponentInternal)._componentRef as HostInstance\n  );\n  if (hostInstance !== undefined) {\n    return hostInstance;\n  }\n\n  resolveFindHostInstance_DEPRECATED();\n  // Fabric implementation of findHostInstance_DEPRECATED doesn't accept a ref as an argument\n  return findHostInstance_DEPRECATED(\n    isFabric()\n      ? component\n      : (component as IAnimatedComponentInternal)._componentRef\n  );\n}\n"],"mappings":"AACA,YAAY;;AAACA,MAAA,CAAAC,cAAA,CAAAC,OAAA;EAAAC,KAAA;AAAA;AAAAD,OAAA,CAAAE,gBAAA,GAAAA,gBAAA;AAGb,IAAAC,OAAA,GAAAC,OAAA;AACA,IAAAC,gBAAA,GAAAD,OAAA;AAeA,SAASE,wBAAwBA,CAACC,cAAwC,EAAE;EAC1E,IAAI,CAACA,cAAc,EAAE;IACnB,OAAOC,SAAS;EAClB;EACA,IACED,cAAc,CAACE,wBAAwB,IACvCF,cAAc,CAACG,WAAW,IAC1BH,cAAc,CAACI,WAAW,EAC1B;IAEA,OAAOJ,cAAc;EACvB;EACA,IAAIA,cAAc,CAACK,UAAU,IAAIL,cAAc,CAACM,UAAU,EAAE;IAE1D,OAAON,cAAc;EACvB;EAGA,OAAOC,SAAS;AAClB;AAEA,SAASM,kCAAkCA,CAAA,EAAG;EAC5C,IAAIC,2BAA2B,KAAKP,SAAS,EAAE;IAC7C;EACF;EACA,IAAI,IAAAQ,yBAAQ,EAAC,CAAC,EAAE;IACd,IAAI;MAAA,IAAAC,qBAAA,EAAAC,oBAAA;MACF,IAAMC,WAAW,GAAGf,OAAO,CAAC,mDAAmD,CAAC;MAGhFW,2BAA2B,IAAAE,qBAAA,GACzBE,WAAW,aAAAD,oBAAA,GAAXC,WAAW,CAAEC,OAAO,qBAApBF,oBAAA,CAAsBH,2BAA2B,YAAAE,qBAAA,GACjDE,WAAW,oBAAXA,WAAW,CAAEJ,2BAA2B;IAC5C,CAAC,CAAC,OAAOM,CAAC,EAAE;MACV,MAAM,IAAIC,uBAAe,CACvB,+CACF,CAAC;IACH;EACF,CAAC,MAAM;IAAA,IAAAC,qBAAA,EAAAC,oBAAA;IACL,IAAMC,WAAW,GAAGrB,OAAO,CAAC,mDAAmD,CAAC;IAGhFW,2BAA2B,IAAAQ,qBAAA,GACzBE,WAAW,aAAAD,oBAAA,GAAXC,WAAW,CAAEL,OAAO,qBAApBI,oBAAA,CAAsBT,2BAA2B,YAAAQ,qBAAA,GACjDE,WAAW,oBAAXA,WAAW,CAAEV,2BAA2B;EAC5C;AACF;AAEA,IAAIA,2BAA2D;AACxD,SAASb,gBAAgBA,CAC9BwB,SAAuD,EACzC;EAEd,IAAMC,YAAY,GAAGrB,wBAAwB,CAC1CoB,SAAS,CAAgCE,aAC5C,CAAC;EACD,IAAID,YAAY,KAAKnB,SAAS,EAAE;IAC9B,OAAOmB,YAAY;EACrB;EAEAb,kCAAkC,CAAC,CAAC;EAEpC,OAAOC,2BAA2B,CAChC,IAAAC,yBAAQ,EAAC,CAAC,GACNU,SAAS,GACRA,SAAS,CAAgCE,aAChD,CAAC;AACH","ignoreList":[]}