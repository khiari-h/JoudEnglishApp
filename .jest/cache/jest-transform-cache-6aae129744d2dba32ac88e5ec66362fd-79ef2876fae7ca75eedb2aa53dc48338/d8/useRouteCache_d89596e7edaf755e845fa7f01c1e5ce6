88e5602cc2f077e21093eb7d0b1ffa16
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.CHILD_STATE = void 0;
exports.useRouteCache = useRouteCache;
var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));
var React = _interopRequireWildcard(require("react"));
var _isRecordEqual = require("./isRecordEqual.js");
var _excluded = ["state"];
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function _interopRequireWildcard(e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (var _t in e) "default" !== _t && {}.hasOwnProperty.call(e, _t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t)) && (i.get || i.set) ? o(f, _t, i) : f[_t] = e[_t]); return f; })(e, t); }
var CHILD_STATE = exports.CHILD_STATE = Symbol('CHILD_STATE');
function useRouteCache(routes) {
  var cache = React.useMemo(function () {
    return {
      current: new Map()
    };
  }, []);
  if (process.env.NODE_ENV === 'production') {
    return routes;
  }
  cache.current = routes.reduce(function (acc, route) {
    var previous = cache.current.get(route.key);
    var state = route.state,
      routeWithoutState = (0, _objectWithoutProperties2.default)(route, _excluded);
    var proxy;
    if (previous && (0, _isRecordEqual.isRecordEqual)(previous, routeWithoutState)) {
      proxy = previous;
    } else {
      proxy = routeWithoutState;
    }
    if (process.env.NODE_ENV !== 'production') {
      for (var key in proxy) {
        var value = proxy[key];
        Object.defineProperty(proxy, key, {
          enumerable: true,
          configurable: true,
          writable: false,
          value: value
        });
      }
    }
    Object.defineProperty(proxy, CHILD_STATE, {
      enumerable: false,
      configurable: true,
      value: state
    });
    acc.set(route.key, proxy);
    return acc;
  }, new Map());
  return Array.from(cache.current.values());
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFjdCIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsIl9pc1JlY29yZEVxdWFsIiwiX2V4Y2x1ZGVkIiwiZSIsInQiLCJXZWFrTWFwIiwiciIsIm4iLCJfX2VzTW9kdWxlIiwibyIsImkiLCJmIiwiX19wcm90b19fIiwiZGVmYXVsdCIsImhhcyIsImdldCIsInNldCIsIl90IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJDSElMRF9TVEFURSIsImV4cG9ydHMiLCJTeW1ib2wiLCJ1c2VSb3V0ZUNhY2hlIiwicm91dGVzIiwiY2FjaGUiLCJ1c2VNZW1vIiwiY3VycmVudCIsIk1hcCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInJlZHVjZSIsImFjYyIsInJvdXRlIiwicHJldmlvdXMiLCJrZXkiLCJzdGF0ZSIsInJvdXRlV2l0aG91dFN0YXRlIiwiX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzMiIsInByb3h5IiwiaXNSZWNvcmRFcXVhbCIsInZhbHVlIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL3VzZVJvdXRlQ2FjaGUudHN4Il0sInNvdXJjZXNDb250ZW50IjpbbnVsbF0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDQSxJQUFBQSxLQUFBLEdBQUFDLHVCQUFBLENBQUFDLE9BQUE7QUFFQSxJQUFBQyxjQUFBLEdBQUFELE9BQUE7QUFBK0MsSUFBQUUsU0FBQTtBQUFBLFNBQUFILHdCQUFBSSxDQUFBLEVBQUFDLENBQUEsNkJBQUFDLE9BQUEsTUFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBTix1QkFBQSxZQUFBQSx3QkFBQUksQ0FBQSxFQUFBQyxDQUFBLFNBQUFBLENBQUEsSUFBQUQsQ0FBQSxJQUFBQSxDQUFBLENBQUFLLFVBQUEsU0FBQUwsQ0FBQSxNQUFBTSxDQUFBLEVBQUFDLENBQUEsRUFBQUMsQ0FBQSxLQUFBQyxTQUFBLFFBQUFDLE9BQUEsRUFBQVYsQ0FBQSxpQkFBQUEsQ0FBQSx1QkFBQUEsQ0FBQSx5QkFBQUEsQ0FBQSxTQUFBUSxDQUFBLE1BQUFGLENBQUEsR0FBQUwsQ0FBQSxHQUFBRyxDQUFBLEdBQUFELENBQUEsUUFBQUcsQ0FBQSxDQUFBSyxHQUFBLENBQUFYLENBQUEsVUFBQU0sQ0FBQSxDQUFBTSxHQUFBLENBQUFaLENBQUEsR0FBQU0sQ0FBQSxDQUFBTyxHQUFBLENBQUFiLENBQUEsRUFBQVEsQ0FBQSxjQUFBTSxFQUFBLElBQUFkLENBQUEsZ0JBQUFjLEVBQUEsT0FBQUMsY0FBQSxDQUFBQyxJQUFBLENBQUFoQixDQUFBLEVBQUFjLEVBQUEsT0FBQVAsQ0FBQSxJQUFBRCxDQUFBLEdBQUFXLE1BQUEsQ0FBQUMsY0FBQSxLQUFBRCxNQUFBLENBQUFFLHdCQUFBLENBQUFuQixDQUFBLEVBQUFjLEVBQUEsT0FBQVAsQ0FBQSxDQUFBSyxHQUFBLElBQUFMLENBQUEsQ0FBQU0sR0FBQSxJQUFBUCxDQUFBLENBQUFFLENBQUEsRUFBQU0sRUFBQSxFQUFBUCxDQUFBLElBQUFDLENBQUEsQ0FBQU0sRUFBQSxJQUFBZCxDQUFBLENBQUFjLEVBQUEsV0FBQU4sQ0FBQSxLQUFBUixDQUFBLEVBQUFDLENBQUE7QUFVeEMsSUFBTW1CLFdBQVcsR0FBQUMsT0FBQSxDQUFBRCxXQUFBLEdBQUdFLE1BQU0sQ0FBQyxhQUFhLENBQUM7QUFNekMsU0FBU0MsYUFBYUEsQ0FDM0JDLE1BQXVCLEVBQ3ZCO0VBRUEsSUFBTUMsS0FBSyxHQUFHOUIsS0FBSyxDQUFDK0IsT0FBTyxDQUFDO0lBQUEsT0FBTztNQUFFQyxPQUFPLEVBQUUsSUFBSUMsR0FBRyxDQUFDO0lBQWdCLENBQUM7RUFBQSxDQUFDLEVBQUUsRUFBRSxDQUFDO0VBRTdFLElBQUlDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxRQUFRLEtBQUssWUFBWSxFQUFFO0lBRXpDLE9BQU9QLE1BQU07RUFDZjtFQUVBQyxLQUFLLENBQUNFLE9BQU8sR0FBR0gsTUFBTSxDQUFDUSxNQUFNLENBQUMsVUFBQ0MsR0FBRyxFQUFFQyxLQUFLLEVBQUs7SUFDNUMsSUFBTUMsUUFBUSxHQUFHVixLQUFLLENBQUNFLE9BQU8sQ0FBQ2YsR0FBRyxDQUFDc0IsS0FBSyxDQUFDRSxHQUFHLENBQUM7SUFDN0MsSUFBUUMsS0FBSyxHQUEyQkgsS0FBSyxDQUFyQ0csS0FBSztNQUFLQyxpQkFBQSxPQUFBQyx5QkFBQSxDQUFBN0IsT0FBQSxFQUFzQndCLEtBQUssRUFBQW5DLFNBQUE7SUFFN0MsSUFBSXlDLEtBQUs7SUFFVCxJQUFJTCxRQUFRLElBQUksSUFBQU0sNEJBQWEsRUFBQ04sUUFBUSxFQUFFRyxpQkFBaUIsQ0FBQyxFQUFFO01BRTFERSxLQUFLLEdBQUdMLFFBQVE7SUFDbEIsQ0FBQyxNQUFNO01BQ0xLLEtBQUssR0FBR0YsaUJBQWlCO0lBQzNCO0lBRUEsSUFBSVQsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFFBQVEsS0FBSyxZQUFZLEVBQUU7TUFHekMsS0FBSyxJQUFNSyxHQUFHLElBQUlJLEtBQUssRUFBRTtRQUV2QixJQUFNRSxLQUFLLEdBQUdGLEtBQUssQ0FBQ0osR0FBRyxDQUFDO1FBRXhCbkIsTUFBTSxDQUFDQyxjQUFjLENBQUNzQixLQUFLLEVBQUVKLEdBQUcsRUFBRTtVQUNoQ08sVUFBVSxFQUFFLElBQUk7VUFDaEJDLFlBQVksRUFBRSxJQUFJO1VBQ2xCQyxRQUFRLEVBQUUsS0FBSztVQUNmSCxLQUFBLEVBQUFBO1FBQ0YsQ0FBQyxDQUFDO01BQ0o7SUFDRjtJQUVBekIsTUFBTSxDQUFDQyxjQUFjLENBQUNzQixLQUFLLEVBQUVwQixXQUFXLEVBQUU7TUFDeEN1QixVQUFVLEVBQUUsS0FBSztNQUNqQkMsWUFBWSxFQUFFLElBQUk7TUFDbEJGLEtBQUssRUFBRUw7SUFDVCxDQUFDLENBQUM7SUFFRkosR0FBRyxDQUFDcEIsR0FBRyxDQUFDcUIsS0FBSyxDQUFDRSxHQUFHLEVBQUVJLEtBQUssQ0FBQztJQUV6QixPQUFPUCxHQUFHO0VBQ1osQ0FBQyxFQUFFLElBQUlMLEdBQUcsQ0FBQyxDQUFlLENBQUM7RUFFM0IsT0FBT2tCLEtBQUssQ0FBQ0MsSUFBSSxDQUFDdEIsS0FBSyxDQUFDRSxPQUFPLENBQUNxQixNQUFNLENBQUMsQ0FBQyxDQUFDO0FBQzNDIiwiaWdub3JlTGlzdCI6W119