72fd48a345bbaa971d0147660940ef46
_getJestObj().mock('../../src/services/lockService', function () {
  return mockLockService;
});
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _react = _interopRequireDefault(require("react"));
var _reactNative = require("@testing-library/react-native");
var _LockContext = require("../../src/contexts/LockContext");
var _jsxRuntime = require("react/jsx-runtime");
function _getJestObj() {
  var _require = require("@jest/globals"),
    jest = _require.jest;
  _getJestObj = function _getJestObj() {
    return jest;
  };
  return jest;
}
var mockLockService = {
  isEnabled: jest.fn(),
  verifyPin: jest.fn(),
  disableLock: jest.fn(),
  enableLock: jest.fn()
};
var Consumer = function Consumer() {
  var _useLock = (0, _LockContext.useLock)(),
    isEnabled = _useLock.isEnabled,
    isLocked = _useLock.isLocked,
    unlockWithPin = _useLock.unlockWithPin,
    disable = _useLock.disable,
    enable = _useLock.enable,
    isLoading = _useLock.isLoading;
  return (0, _jsxRuntime.jsxs)(_jsxRuntime.Fragment, {
    children: [isLoading && (0, _jsxRuntime.jsx)("text", {
      testID: "loading",
      children: "Loading..."
    }), (0, _jsxRuntime.jsx)("text", {
      testID: "enabled",
      children: String(isEnabled)
    }), (0, _jsxRuntime.jsx)("text", {
      testID: "locked",
      children: String(isLocked)
    }), (0, _jsxRuntime.jsx)("button", {
      testID: "unlock-correct-pin",
      onPress: function onPress() {
        return unlockWithPin('1234');
      }
    }), (0, _jsxRuntime.jsx)("button", {
      testID: "unlock-wrong-pin",
      onPress: function onPress() {
        return unlockWithPin('0000');
      }
    }), (0, _jsxRuntime.jsx)("button", {
      testID: "unlock-lockout",
      onPress: function onPress() {
        return unlockWithPin('0000');
      }
    }), (0, _jsxRuntime.jsx)("button", {
      testID: "disable",
      onPress: disable
    }), (0, _jsxRuntime.jsx)("button", {
      testID: "enable",
      onPress: enable
    })]
  });
};
var TestText = function TestText(_ref) {
  var children = _ref.children,
    testID = _ref.testID;
  return (0, _jsxRuntime.jsx)("text", {
    testID: testID,
    children: children
  });
};
var TestButton = function TestButton(_ref2) {
  var onPress = _ref2.onPress,
    testID = _ref2.testID;
  return (0, _jsxRuntime.jsx)("button", {
    testID: testID,
    onPress: onPress
  });
};
describe('LockContext', function () {
  beforeEach(function () {
    jest.clearAllMocks();
    mockLockService.isEnabled.mockResolvedValue(true);
    mockLockService.verifyPin.mockResolvedValue({
      ok: true
    });
    mockLockService.disableLock.mockResolvedValue(true);
    mockLockService.enableLock.mockResolvedValue(true);
  });
  it('initializes locked when enabled, unlocks with correct PIN, and can disable', (0, _asyncToGenerator2.default)(function* () {
    var ui = (0, _reactNative.render)((0, _jsxRuntime.jsx)(_LockContext.LockProvider, {
      children: (0, _jsxRuntime.jsx)(Consumer, {})
    }));
    yield (0, _reactNative.waitFor)(function () {
      return expect(ui.queryByTestId('loading')).toBeNull();
    });
    expect(ui.getByTestId('enabled').props.children).toBe('true');
    expect(ui.getByTestId('locked').props.children).toBe('true');
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      _reactNative.fireEvent.press(ui.getByTestId('unlock-correct-pin'));
    }));
    expect(ui.getByTestId('locked').props.children).toBe('false');
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      _reactNative.fireEvent.press(ui.getByTestId('disable'));
    }));
    expect(ui.getByTestId('enabled').props.children).toBe('false');
  }));
  it('initializes unlocked when not enabled', (0, _asyncToGenerator2.default)(function* () {
    mockLockService.isEnabled.mockResolvedValueOnce(false);
    var ui = (0, _reactNative.render)((0, _jsxRuntime.jsx)(_LockContext.LockProvider, {
      children: (0, _jsxRuntime.jsx)(Consumer, {})
    }));
    yield (0, _reactNative.waitFor)(function () {
      return expect(ui.queryByTestId('loading')).toBeNull();
    });
    expect(ui.getByTestId('enabled').props.children).toBe('false');
    expect(ui.getByTestId('locked').props.children).toBe('false');
  }));
  it('should not unlock with an incorrect PIN', (0, _asyncToGenerator2.default)(function* () {
    mockLockService.verifyPin.mockResolvedValue({
      ok: false
    });
    var ui = (0, _reactNative.render)((0, _jsxRuntime.jsx)(_LockContext.LockProvider, {
      children: (0, _jsxRuntime.jsx)(Consumer, {})
    }));
    yield (0, _reactNative.waitFor)(function () {
      return expect(ui.queryByTestId('loading')).toBeNull();
    });
    expect(ui.getByTestId('locked').props.children).toBe('true');
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      _reactNative.fireEvent.press(ui.getByTestId('unlock-wrong-pin'));
    }));
    expect(ui.getByTestId('locked').props.children).toBe('true');
  }));
  it('should return lockout reason when pin verification fails with lockout', (0, _asyncToGenerator2.default)(function* () {
    mockLockService.verifyPin.mockResolvedValue({
      ok: false,
      reason: 'lockout'
    });
    var ui = (0, _reactNative.render)((0, _jsxRuntime.jsx)(_LockContext.LockProvider, {
      children: (0, _jsxRuntime.jsx)(Consumer, {})
    }));
    yield (0, _reactNative.waitFor)(function () {
      return expect(ui.queryByTestId('loading')).toBeNull();
    });
    var result;
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      result = yield ui.getByTestId('unlock-lockout').props.onPress();
    }));
    expect(ui.getByTestId('locked').props.children).toBe('true');
    expect(result).toEqual({
      ok: false,
      reason: 'lockout'
    });
  }));
  it('should enable the lock', (0, _asyncToGenerator2.default)(function* () {
    mockLockService.isEnabled.mockResolvedValueOnce(false);
    var ui = (0, _reactNative.render)((0, _jsxRuntime.jsx)(_LockContext.LockProvider, {
      children: (0, _jsxRuntime.jsx)(Consumer, {})
    }));
    yield (0, _reactNative.waitFor)(function () {
      return expect(ui.queryByTestId('loading')).toBeNull();
    });
    expect(ui.getByTestId('enabled').props.children).toBe('false');
    expect(ui.getByTestId('locked').props.children).toBe('false');
    yield (0, _reactNative.act)((0, _asyncToGenerator2.default)(function* () {
      _reactNative.fireEvent.press(ui.getByTestId('enable'));
    }));
    expect(ui.getByTestId('enabled').props.children).toBe('true');
    expect(ui.getByTestId('locked').props.children).toBe('true');
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJtb2NrTG9ja1NlcnZpY2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9yZWFjdCIsIl9yZWFjdE5hdGl2ZSIsIl9Mb2NrQ29udGV4dCIsIl9qc3hSdW50aW1lIiwiX3JlcXVpcmUiLCJqZXN0IiwiaXNFbmFibGVkIiwiZm4iLCJ2ZXJpZnlQaW4iLCJkaXNhYmxlTG9jayIsImVuYWJsZUxvY2siLCJDb25zdW1lciIsIl91c2VMb2NrIiwidXNlTG9jayIsImlzTG9ja2VkIiwidW5sb2NrV2l0aFBpbiIsImRpc2FibGUiLCJlbmFibGUiLCJpc0xvYWRpbmciLCJqc3hzIiwiRnJhZ21lbnQiLCJjaGlsZHJlbiIsImpzeCIsInRlc3RJRCIsIlN0cmluZyIsIm9uUHJlc3MiLCJUZXN0VGV4dCIsIl9yZWYiLCJUZXN0QnV0dG9uIiwiX3JlZjIiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJvayIsIml0IiwiZGVmYXVsdCIsInVpIiwicmVuZGVyIiwiTG9ja1Byb3ZpZGVyIiwid2FpdEZvciIsImV4cGVjdCIsInF1ZXJ5QnlUZXN0SWQiLCJ0b0JlTnVsbCIsImdldEJ5VGVzdElkIiwicHJvcHMiLCJ0b0JlIiwiYWN0IiwiZmlyZUV2ZW50IiwicHJlc3MiLCJtb2NrUmVzb2x2ZWRWYWx1ZU9uY2UiLCJyZWFzb24iLCJyZXN1bHQiLCJ0b0VxdWFsIl0sInNvdXJjZXMiOlsiTG9ja0NvbnRleHQudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyByZW5kZXIsIGFjdCwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdC1uYXRpdmUnO1xyXG5pbXBvcnQgeyBMb2NrUHJvdmlkZXIsIHVzZUxvY2sgfSBmcm9tICcuLi8uLi9zcmMvY29udGV4dHMvTG9ja0NvbnRleHQnO1xyXG5cclxuLy8gMS4gRMOpcGxhY2VyIGxlIG1vY2sgZW4gaGF1dCBkdSBmaWNoaWVyIHBvdXIgcXUnaWwgc29pdCBleMOpY3V0w6kgZW4gcHJlbWllclxyXG5jb25zdCBtb2NrTG9ja1NlcnZpY2UgPSB7XHJcbiAgaXNFbmFibGVkOiBqZXN0LmZuKCksXHJcbiAgdmVyaWZ5UGluOiBqZXN0LmZuKCksXHJcbiAgZGlzYWJsZUxvY2s6IGplc3QuZm4oKSxcclxuICBlbmFibGVMb2NrOiBqZXN0LmZuKCksXHJcbn07XHJcbmplc3QubW9jaygnLi4vLi4vc3JjL3NlcnZpY2VzL2xvY2tTZXJ2aWNlJywgKCkgPT4gbW9ja0xvY2tTZXJ2aWNlKTtcclxuXHJcbmNvbnN0IENvbnN1bWVyID0gKCkgPT4ge1xyXG4gIGNvbnN0IHsgaXNFbmFibGVkLCBpc0xvY2tlZCwgdW5sb2NrV2l0aFBpbiwgZGlzYWJsZSwgZW5hYmxlLCBpc0xvYWRpbmcgfSA9IHVzZUxvY2soKTtcclxuICByZXR1cm4gKFxyXG4gICAgPD5cclxuICAgICAge2lzTG9hZGluZyAmJiA8dGV4dCB0ZXN0SUQ9XCJsb2FkaW5nXCI+TG9hZGluZy4uLjwvdGV4dD59XHJcbiAgICAgIDx0ZXh0IHRlc3RJRD1cImVuYWJsZWRcIj57U3RyaW5nKGlzRW5hYmxlZCl9PC90ZXh0PlxyXG4gICAgICA8dGV4dCB0ZXN0SUQ9XCJsb2NrZWRcIj57U3RyaW5nKGlzTG9ja2VkKX08L3RleHQ+XHJcbiAgICAgIDxidXR0b24gdGVzdElEPVwidW5sb2NrLWNvcnJlY3QtcGluXCIgb25QcmVzcz17KCkgPT4gdW5sb2NrV2l0aFBpbignMTIzNCcpfSAvPlxyXG4gICAgICA8YnV0dG9uIHRlc3RJRD1cInVubG9jay13cm9uZy1waW5cIiBvblByZXNzPXsoKSA9PiB1bmxvY2tXaXRoUGluKCcwMDAwJyl9IC8+XHJcbiAgICAgIDxidXR0b24gdGVzdElEPVwidW5sb2NrLWxvY2tvdXRcIiBvblByZXNzPXsoKSA9PiB1bmxvY2tXaXRoUGluKCcwMDAwJyl9IC8+XHJcbiAgICAgIDxidXR0b24gdGVzdElEPVwiZGlzYWJsZVwiIG9uUHJlc3M9e2Rpc2FibGV9IC8+XHJcbiAgICAgIDxidXR0b24gdGVzdElEPVwiZW5hYmxlXCIgb25QcmVzcz17ZW5hYmxlfSAvPlxyXG4gICAgPC8+XHJcbiAgKTtcclxufTtcclxuXHJcbi8vIFRpbnkgc2hpbXMgdG8gYXZvaWQgaW1wb3J0aW5nIFJOIHByaW1pdGl2ZXNcclxuY29uc3QgVGVzdFRleHQgPSAoeyBjaGlsZHJlbiwgdGVzdElEIH0pID0+ICg8dGV4dCB0ZXN0SUQ9e3Rlc3RJRH0+e2NoaWxkcmVufTwvdGV4dD4pO1xyXG5jb25zdCBUZXN0QnV0dG9uID0gKHsgb25QcmVzcywgdGVzdElEIH0pID0+ICg8YnV0dG9uIHRlc3RJRD17dGVzdElEfSBvblByZXNzPXtvblByZXNzfSAvPik7XHJcblxyXG5kZXNjcmliZSgnTG9ja0NvbnRleHQnLCAoKSA9PiB7XHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgIC8vIFBhciBkw6lmYXV0LCBsZSB2ZXJyb3UgZXN0IGFjdGl2w6lcclxuICAgIG1vY2tMb2NrU2VydmljZS5pc0VuYWJsZWQubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XHJcbiAgICAvLyBQYXIgZMOpZmF1dCwgbGUgUElOIGVzdCBjb3JyZWN0XHJcbiAgICBtb2NrTG9ja1NlcnZpY2UudmVyaWZ5UGluLm1vY2tSZXNvbHZlZFZhbHVlKHsgb2s6IHRydWUgfSk7XHJcbiAgICBtb2NrTG9ja1NlcnZpY2UuZGlzYWJsZUxvY2subW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XHJcbiAgICBtb2NrTG9ja1NlcnZpY2UuZW5hYmxlTG9jay5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcclxuICB9KTtcclxuXHJcbiAgLy8gVGVzdCAxOiBDb21wb3J0ZW1lbnQgaW5pdGlhbCAoY2FzIGRlIHN1Y2PDqHMpXHJcbiAgaXQoJ2luaXRpYWxpemVzIGxvY2tlZCB3aGVuIGVuYWJsZWQsIHVubG9ja3Mgd2l0aCBjb3JyZWN0IFBJTiwgYW5kIGNhbiBkaXNhYmxlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgdWkgPSByZW5kZXIoPExvY2tQcm92aWRlcj48Q29uc3VtZXIgLz48L0xvY2tQcm92aWRlcj4pO1xyXG5cclxuICAgIC8vIEF0dGVuZHJlIGxlIGNoYXJnZW1lbnQgaW5pdGlhbFxyXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiBleHBlY3QodWkucXVlcnlCeVRlc3RJZCgnbG9hZGluZycpKS50b0JlTnVsbCgpKTtcclxuICAgIFxyXG4gICAgLy8gVsOpcmlmaWVyIGwnw6l0YXQgaW5pdGlhbFxyXG4gICAgZXhwZWN0KHVpLmdldEJ5VGVzdElkKCdlbmFibGVkJykucHJvcHMuY2hpbGRyZW4pLnRvQmUoJ3RydWUnKTtcclxuICAgIGV4cGVjdCh1aS5nZXRCeVRlc3RJZCgnbG9ja2VkJykucHJvcHMuY2hpbGRyZW4pLnRvQmUoJ3RydWUnKTtcclxuXHJcbiAgICAvLyBEw6l2ZXJyb3VpbGxhZ2UgcsOpdXNzaVxyXG4gICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcclxuICAgICAgZmlyZUV2ZW50LnByZXNzKHVpLmdldEJ5VGVzdElkKCd1bmxvY2stY29ycmVjdC1waW4nKSk7XHJcbiAgICB9KTtcclxuICAgIGV4cGVjdCh1aS5nZXRCeVRlc3RJZCgnbG9ja2VkJykucHJvcHMuY2hpbGRyZW4pLnRvQmUoJ2ZhbHNlJyk7XHJcblxyXG4gICAgLy8gRMOpc2FjdGl2YXRpb24gZHUgdmVycm91XHJcbiAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xyXG4gICAgICBmaXJlRXZlbnQucHJlc3ModWkuZ2V0QnlUZXN0SWQoJ2Rpc2FibGUnKSk7XHJcbiAgICB9KTtcclxuICAgIGV4cGVjdCh1aS5nZXRCeVRlc3RJZCgnZW5hYmxlZCcpLnByb3BzLmNoaWxkcmVuKS50b0JlKCdmYWxzZScpO1xyXG4gIH0pO1xyXG5cclxuICAvLyBUZXN0IDI6IEfDqXJlciBsJ8OpdGF0IGluaXRpYWwgZMOpc2FjdGl2w6lcclxuICBpdCgnaW5pdGlhbGl6ZXMgdW5sb2NrZWQgd2hlbiBub3QgZW5hYmxlZCcsIGFzeW5jICgpID0+IHtcclxuICAgIG1vY2tMb2NrU2VydmljZS5pc0VuYWJsZWQubW9ja1Jlc29sdmVkVmFsdWVPbmNlKGZhbHNlKTtcclxuICAgIGNvbnN0IHVpID0gcmVuZGVyKDxMb2NrUHJvdmlkZXI+PENvbnN1bWVyIC8+PC9Mb2NrUHJvdmlkZXI+KTtcclxuXHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IGV4cGVjdCh1aS5xdWVyeUJ5VGVzdElkKCdsb2FkaW5nJykpLnRvQmVOdWxsKCkpO1xyXG5cclxuICAgIGV4cGVjdCh1aS5nZXRCeVRlc3RJZCgnZW5hYmxlZCcpLnByb3BzLmNoaWxkcmVuKS50b0JlKCdmYWxzZScpO1xyXG4gICAgZXhwZWN0KHVpLmdldEJ5VGVzdElkKCdsb2NrZWQnKS5wcm9wcy5jaGlsZHJlbikudG9CZSgnZmFsc2UnKTtcclxuICB9KTtcclxuXHJcbiAgLy8gVGVzdCAzOiBHw6lyZXIgbGUgUElOIGluY29ycmVjdFxyXG4gIGl0KCdzaG91bGQgbm90IHVubG9jayB3aXRoIGFuIGluY29ycmVjdCBQSU4nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAvLyAyLiBNb2NrIGR1IFBJTiBpbmNvcnJlY3QgQVZBTlQgbGUgcmVuZHVcclxuICAgIG1vY2tMb2NrU2VydmljZS52ZXJpZnlQaW4ubW9ja1Jlc29sdmVkVmFsdWUoeyBvazogZmFsc2UgfSk7XHJcbiAgICBjb25zdCB1aSA9IHJlbmRlcig8TG9ja1Byb3ZpZGVyPjxDb25zdW1lciAvPjwvTG9ja1Byb3ZpZGVyPik7XHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IGV4cGVjdCh1aS5xdWVyeUJ5VGVzdElkKCdsb2FkaW5nJykpLnRvQmVOdWxsKCkpO1xyXG5cclxuICAgIGV4cGVjdCh1aS5nZXRCeVRlc3RJZCgnbG9ja2VkJykucHJvcHMuY2hpbGRyZW4pLnRvQmUoJ3RydWUnKTtcclxuXHJcbiAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xyXG4gICAgICBmaXJlRXZlbnQucHJlc3ModWkuZ2V0QnlUZXN0SWQoJ3VubG9jay13cm9uZy1waW4nKSk7XHJcbiAgICB9KTtcclxuICAgIC8vIExlIHZlcnJvdSBuZSBkb2l0IHBhcyBjaGFuZ2VyIGQnw6l0YXRcclxuICAgIGV4cGVjdCh1aS5nZXRCeVRlc3RJZCgnbG9ja2VkJykucHJvcHMuY2hpbGRyZW4pLnRvQmUoJ3RydWUnKTtcclxuICB9KTtcclxuXHJcbiAgLy8gVGVzdCA0OiBHw6lyZXIgbGEgcmFpc29uIFwibG9ja291dFwiXHJcbiAgaXQoJ3Nob3VsZCByZXR1cm4gbG9ja291dCByZWFzb24gd2hlbiBwaW4gdmVyaWZpY2F0aW9uIGZhaWxzIHdpdGggbG9ja291dCcsIGFzeW5jICgpID0+IHtcclxuICAgIG1vY2tMb2NrU2VydmljZS52ZXJpZnlQaW4ubW9ja1Jlc29sdmVkVmFsdWUoeyBvazogZmFsc2UsIHJlYXNvbjogJ2xvY2tvdXQnIH0pO1xyXG4gICAgY29uc3QgdWkgPSByZW5kZXIoPExvY2tQcm92aWRlcj48Q29uc3VtZXIgLz48L0xvY2tQcm92aWRlcj4pO1xyXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiBleHBlY3QodWkucXVlcnlCeVRlc3RJZCgnbG9hZGluZycpKS50b0JlTnVsbCgpKTtcclxuXHJcbiAgICBsZXQgcmVzdWx0O1xyXG4gICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcclxuICAgICAgLy8gY2FwdHVyZSBsZSByw6lzdWx0YXQgZGUgbCdhcHBlbCDDoCB1bmxvY2tXaXRoUGluIHBvdXIgbGUgdsOpcmlmaWVyXHJcbiAgICAgIHJlc3VsdCA9IGF3YWl0IHVpLmdldEJ5VGVzdElkKCd1bmxvY2stbG9ja291dCcpLnByb3BzLm9uUHJlc3MoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGV4cGVjdCh1aS5nZXRCeVRlc3RJZCgnbG9ja2VkJykucHJvcHMuY2hpbGRyZW4pLnRvQmUoJ3RydWUnKTtcclxuICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoeyBvazogZmFsc2UsIHJlYXNvbjogJ2xvY2tvdXQnIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyBUZXN0IDU6IEFjdGl2ZXIgbGUgdmVycm91aWxsYWdlXHJcbiAgaXQoJ3Nob3VsZCBlbmFibGUgdGhlIGxvY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICBtb2NrTG9ja1NlcnZpY2UuaXNFbmFibGVkLm1vY2tSZXNvbHZlZFZhbHVlT25jZShmYWxzZSk7XHJcbiAgICBjb25zdCB1aSA9IHJlbmRlcig8TG9ja1Byb3ZpZGVyPjxDb25zdW1lciAvPjwvTG9ja1Byb3ZpZGVyPik7XHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IGV4cGVjdCh1aS5xdWVyeUJ5VGVzdElkKCdsb2FkaW5nJykpLnRvQmVOdWxsKCkpO1xyXG5cclxuICAgIC8vIFbDqXJpZmllciBsJ8OpdGF0IGluaXRpYWwgZMOpc2FjdGl2w6lcclxuICAgIGV4cGVjdCh1aS5nZXRCeVRlc3RJZCgnZW5hYmxlZCcpLnByb3BzLmNoaWxkcmVuKS50b0JlKCdmYWxzZScpO1xyXG4gICAgZXhwZWN0KHVpLmdldEJ5VGVzdElkKCdsb2NrZWQnKS5wcm9wcy5jaGlsZHJlbikudG9CZSgnZmFsc2UnKTtcclxuXHJcbiAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xyXG4gICAgICBmaXJlRXZlbnQucHJlc3ModWkuZ2V0QnlUZXN0SWQoJ2VuYWJsZScpKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFbDqXJpZmllciBxdWUgbCfDqXRhdCBhIGJhc2N1bMOpXHJcbiAgICBleHBlY3QodWkuZ2V0QnlUZXN0SWQoJ2VuYWJsZWQnKS5wcm9wcy5jaGlsZHJlbikudG9CZSgndHJ1ZScpO1xyXG4gICAgZXhwZWN0KHVpLmdldEJ5VGVzdElkKCdsb2NrZWQnKS5wcm9wcy5jaGlsZHJlbikudG9CZSgndHJ1ZScpO1xyXG4gIH0pO1xyXG59KTsiXSwibWFw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