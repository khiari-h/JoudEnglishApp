{"version":3,"names":["_react","require","_asyncStorage","_interopRequireDefault","REVISION_STORAGE_KEY","useRevisionSettings","exports","_useState","useState","isDisabled","nextRevisionAt","frequency","questionsCount","_useState2","_slicedToArray2","default","preferences","setPreferences","_useState3","_useState4","isLoading","setIsLoading","loadPreferences","_ref","_asyncToGenerator2","saved","AsyncStorage","getItem","prefs","JSON","parse","error","apply","arguments","useEffect","updatePreferences","_ref2","newPrefs","updatedPrefs","Object","assign","lastUpdate","Date","now","setItem","stringify","emit","e","_x","enableRevisions","length","undefined","disableRevisions","updateFrequency","newFrequency","resetToNextTarget","wordsLearned","newTarget"],"sources":["useRevisionSettings.js"],"sourcesContent":["// src/hooks/useRevisionSettings.js - HOOK POUR MENU SETTINGS\nimport { useState, useEffect } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nconst REVISION_STORAGE_KEY = 'revision_preferences';\n\nexport const useRevisionSettings = () => {\n  const [preferences, setPreferences] = useState({\n    isDisabled: false,\n    nextRevisionAt: 50,\n    frequency: 50, // Tous les X mots\n    questionsCount: 10\n  });\n  const [isLoading, setIsLoading] = useState(true);\n\n  const loadPreferences = async () => {\n    try {\n      const saved = await AsyncStorage.getItem(REVISION_STORAGE_KEY);\n      if (saved) {\n        const prefs = JSON.parse(saved);\n        setPreferences({\n          isDisabled: prefs.isDisabled || false,\n          nextRevisionAt: prefs.nextRevisionAt || 50,\n          frequency: prefs.frequency || 50,\n          questionsCount: prefs.questionsCount || 10\n        });\n      }\n    } catch (error) {\n      // Ignored on purpose: empty block to suppress error\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // ========== CHARGEMENT ==========\n  useEffect(() => {\n    loadPreferences();\n  }, []);\n\n  // ========== SAUVEGARDE ==========\n  const updatePreferences = async (newPrefs) => {\n    try {\n      const updatedPrefs = { ...preferences, ...newPrefs, lastUpdate: Date.now() };\n      await AsyncStorage.setItem(REVISION_STORAGE_KEY, JSON.stringify(updatedPrefs));\n      setPreferences(updatedPrefs);\n      // Événement de mise à jour des settings\n      try { require('../utils/eventBus').emit('settings-updated', updatedPrefs); } catch(e) { /* empty: eventBus not critical */ }\n      return true;\n    } catch (error) {\n      // Ignored on purpose: empty block to suppress error\n      return null;\n    }\n  };\n\n  // ========== ACTIONS SPÉCIFIQUES ==========\n  const enableRevisions = (frequency = 50, questionsCount = 10) => {\n    return updatePreferences({\n      isDisabled: false,\n      frequency,\n      questionsCount,\n      nextRevisionAt: frequency // Reset target\n    });\n  };\n\n  const disableRevisions = () => {\n    return updatePreferences({ isDisabled: true });\n  };\n\n  const updateFrequency = (newFrequency) => {\n    return updatePreferences({ \n      frequency: newFrequency,\n      nextRevisionAt: newFrequency // Reset target\n    });\n  };\n\n  const resetToNextTarget = (wordsLearned) => {\n    const newTarget = wordsLearned + preferences.frequency;\n    return updatePreferences({ nextRevisionAt: newTarget });\n  };\n\n  return {\n    preferences,\n    isLoading,\n    enableRevisions,\n    disableRevisions,\n    updateFrequency,\n    updatePreferences,\n    resetToNextTarget\n  };\n};\n"],"mappings":"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","ignoreList":[]}