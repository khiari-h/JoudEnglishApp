e0f1f41ff23668846aed03d889cdb703
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SettingsProvider = exports.SettingsContext = void 0;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var _storageUtils = require("../utils/storageUtils");
var _constants = require("../utils/constants");
var _jsxRuntime = require("react/jsx-runtime");
var SettingsContext = exports.SettingsContext = (0, _react.createContext)();
var SettingsProvider = exports.SettingsProvider = function SettingsProvider(_ref) {
  var children = _ref.children;
  var _useState = (0, _react.useState)(_constants.DEFAULT_SETTINGS),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    settings = _useState2[0],
    setSettings = _useState2[1];
  var _useState3 = (0, _react.useState)(true),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    isLoading = _useState4[0],
    setIsLoading = _useState4[1];
  (0, _react.useEffect)(function () {
    var loadSettings = function () {
      var _ref2 = (0, _asyncToGenerator2.default)(function* () {
        try {
          setIsLoading(true);
          var savedSettings = yield (0, _storageUtils.getData)('userSettings');
          if (savedSettings) {
            setSettings(Object.assign({}, _constants.DEFAULT_SETTINGS, savedSettings));
          }
        } catch (error) {} finally {
          setIsLoading(false);
        }
      });
      return function loadSettings() {
        return _ref2.apply(this, arguments);
      };
    }();
    loadSettings();
  }, []);
  (0, _react.useEffect)(function () {
    if (!isLoading) {
      (0, _storageUtils.storeData)('userSettings', settings);
    }
  }, [settings, isLoading]);
  var updateSetting = function updateSetting(key, value) {
    if (settings[key] === undefined) {
      return;
    }
    setSettings(function (prevSettings) {
      return Object.assign({}, prevSettings, (0, _defineProperty2.default)({}, key, value));
    });
  };
  var updateSettings = function updateSettings(newSettings) {
    setSettings(function (prevSettings) {
      return Object.assign({}, prevSettings, newSettings);
    });
  };
  var resetSettings = function resetSettings() {
    setSettings(_constants.DEFAULT_SETTINGS);
  };
  var areNotificationsEnabled = function areNotificationsEnabled() {
    return settings.notifications;
  };
  var getDailyGoal = function getDailyGoal() {
    return settings.dailyGoal;
  };
  var setDailyGoal = function setDailyGoal(minutes) {
    updateSetting('dailyGoal', Math.max(1, Math.min(120, minutes)));
  };
  var contextValue = {
    settings: settings,
    updateSetting: updateSetting,
    updateSettings: updateSettings,
    resetSettings: resetSettings,
    areNotificationsEnabled: areNotificationsEnabled,
    getDailyGoal: getDailyGoal,
    setDailyGoal: setDailyGoal,
    isLoading: isLoading
  };
  return (0, _jsxRuntime.jsx)(SettingsContext.Provider, {
    value: contextValue,
    children: children
  });
};
var _default = exports.default = SettingsContext;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3N0b3JhZ2VVdGlscyIsIl9jb25zdGFudHMiLCJfanN4UnVudGltZSIsIlNldHRpbmdzQ29udGV4dCIsImV4cG9ydHMiLCJjcmVhdGVDb250ZXh0IiwiU2V0dGluZ3NQcm92aWRlciIsIl9yZWYiLCJjaGlsZHJlbiIsIl91c2VTdGF0ZSIsInVzZVN0YXRlIiwiREVGQVVMVF9TRVRUSU5HUyIsIl91c2VTdGF0ZTIiLCJfc2xpY2VkVG9BcnJheTIiLCJkZWZhdWx0Iiwic2V0dGluZ3MiLCJzZXRTZXR0aW5ncyIsIl91c2VTdGF0ZTMiLCJfdXNlU3RhdGU0IiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwidXNlRWZmZWN0IiwibG9hZFNldHRpbmdzIiwiX3JlZjIiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJzYXZlZFNldHRpbmdzIiwiZ2V0RGF0YSIsIk9iamVjdCIsImFzc2lnbiIsImVycm9yIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJzdG9yZURhdGEiLCJ1cGRhdGVTZXR0aW5nIiwia2V5IiwidmFsdWUiLCJ1bmRlZmluZWQiLCJwcmV2U2V0dGluZ3MiLCJfZGVmaW5lUHJvcGVydHkyIiwidXBkYXRlU2V0dGluZ3MiLCJuZXdTZXR0aW5ncyIsInJlc2V0U2V0dGluZ3MiLCJhcmVOb3RpZmljYXRpb25zRW5hYmxlZCIsIm5vdGlmaWNhdGlvbnMiLCJnZXREYWlseUdvYWwiLCJkYWlseUdvYWwiLCJzZXREYWlseUdvYWwiLCJtaW51dGVzIiwiTWF0aCIsIm1heCIsIm1pbiIsImNvbnRleHRWYWx1ZSIsImpzeCIsIlByb3ZpZGVyIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyJTZXR0aW5nQ29udGV4dC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvY29udGV4dHMvU2V0dGluZ3NDb250ZXh0LmpzXHJcbmltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHN0b3JlRGF0YSwgZ2V0RGF0YSB9IGZyb20gJy4uL3V0aWxzL3N0b3JhZ2VVdGlscyc7XHJcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICcuLi91dGlscy9jb25zdGFudHMnO1xyXG5cclxuLy8gQ3LDqWVyIGxlIGNvbnRleHRlXHJcbmV4cG9ydCBjb25zdCBTZXR0aW5nc0NvbnRleHQgPSBjcmVhdGVDb250ZXh0KCk7XHJcblxyXG4vKipcclxuICogRm91cm5pc3NldXIgZGUgY29udGV4dGUgcG91ciBnw6lyZXIgbGVzIHBhcmFtw6h0cmVzIGRlIGwnYXBwbGljYXRpb25cclxuICovXHJcbmV4cG9ydCBjb25zdCBTZXR0aW5nc1Byb3ZpZGVyID0gKHsgY2hpbGRyZW4gfSkgPT4ge1xyXG4gIC8vIMOJdGF0IGRlcyBwYXJhbcOodHJlc1xyXG4gIGNvbnN0IFtzZXR0aW5ncywgc2V0U2V0dGluZ3NdID0gdXNlU3RhdGUoREVGQVVMVF9TRVRUSU5HUyk7XHJcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xyXG5cclxuICAvLyBDaGFyZ2VyIGxlcyBwYXJhbcOodHJlcyBhdSBkw6ltYXJyYWdlXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGNvbnN0IGxvYWRTZXR0aW5ncyA9IGFzeW5jICgpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XHJcbiAgICAgICAgY29uc3Qgc2F2ZWRTZXR0aW5ncyA9IGF3YWl0IGdldERhdGEoJ3VzZXJTZXR0aW5ncycpO1xyXG5cclxuICAgICAgICBpZiAoc2F2ZWRTZXR0aW5ncykge1xyXG4gICAgICAgICAgLy8gRnVzaW9ubmVyIGF2ZWMgbGVzIHBhcmFtw6h0cmVzIHBhciBkw6lmYXV0IHBvdXIgcydhc3N1cmVyIHF1ZSB0b3VzIGxlcyBjaGFtcHMgc29udCBwcsOpc2VudHNcclxuICAgICAgICAgIHNldFNldHRpbmdzKHsgLi4uREVGQVVMVF9TRVRUSU5HUywgLi4uc2F2ZWRTZXR0aW5ncyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgLy8gSWdub3JlZCBvbiBwdXJwb3NlXHJcbiAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBsb2FkU2V0dGluZ3MoKTtcclxuICB9LCBbXSk7XHJcblxyXG4gIC8vIFNhdXZlZ2FyZGVyIGxlcyBwYXJhbcOodHJlcyBsb3JzcXUnaWxzIGNoYW5nZW50XHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmICghaXNMb2FkaW5nKSB7XHJcbiAgICAgIHN0b3JlRGF0YSgndXNlclNldHRpbmdzJywgc2V0dGluZ3MpO1xyXG4gICAgfVxyXG4gIH0sIFtzZXR0aW5ncywgaXNMb2FkaW5nXSk7XHJcblxyXG4gIC8vIE1ldHRyZSDDoCBqb3VyIHVuIHBhcmFtw6h0cmUgc3DDqWNpZmlxdWVcclxuICBjb25zdCB1cGRhdGVTZXR0aW5nID0gKGtleSwgdmFsdWUpID0+IHtcclxuICAgIGlmIChzZXR0aW5nc1trZXldID09PSB1bmRlZmluZWQpIHtcclxuXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBzZXRTZXR0aW5ncyhwcmV2U2V0dGluZ3MgPT4gKHtcclxuICAgICAgLi4ucHJldlNldHRpbmdzLFxyXG4gICAgICBba2V5XTogdmFsdWVcclxuICAgIH0pKTtcclxuICB9O1xyXG5cclxuICAvLyBNZXR0cmUgw6Agam91ciBwbHVzaWV1cnMgcGFyYW3DqHRyZXMgw6AgbGEgZm9pc1xyXG4gIGNvbnN0IHVwZGF0ZVNldHRpbmdzID0gKG5ld1NldHRpbmdzKSA9PiB7XHJcbiAgICBzZXRTZXR0aW5ncyhwcmV2U2V0dGluZ3MgPT4gKHtcclxuICAgICAgLi4ucHJldlNldHRpbmdzLFxyXG4gICAgICAuLi5uZXdTZXR0aW5nc1xyXG4gICAgfSkpO1xyXG4gIH07XHJcblxyXG4gIC8vIFLDqWluaXRpYWxpc2VyIHRvdXMgbGVzIHBhcmFtw6h0cmVzXHJcbiAgY29uc3QgcmVzZXRTZXR0aW5ncyA9ICgpID0+IHtcclxuICAgIHNldFNldHRpbmdzKERFRkFVTFRfU0VUVElOR1MpO1xyXG4gIH07XHJcblxyXG4gIC8vIFbDqXJpZmllciBzaSBsZXMgbm90aWZpY2F0aW9ucyBzb250IGFjdGl2w6llc1xyXG4gIGNvbnN0IGFyZU5vdGlmaWNhdGlvbnNFbmFibGVkID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIHNldHRpbmdzLm5vdGlmaWNhdGlvbnM7XHJcbiAgfTtcclxuXHJcbiAgLy8gT2J0ZW5pciBsZSBkw6lsYWkgam91cm5hbGllclxyXG4gIGNvbnN0IGdldERhaWx5R29hbCA9ICgpID0+IHtcclxuICAgIHJldHVybiBzZXR0aW5ncy5kYWlseUdvYWw7XHJcbiAgfTtcclxuXHJcbiAgLy8gRMOpZmluaXIgbGUgZMOpbGFpIGpvdXJuYWxpZXJcclxuICBjb25zdCBzZXREYWlseUdvYWwgPSAobWludXRlcykgPT4ge1xyXG4gICAgdXBkYXRlU2V0dGluZygnZGFpbHlHb2FsJywgTWF0aC5tYXgoMSwgTWF0aC5taW4oMTIwLCBtaW51dGVzKSkpOyAvLyBFbnRyZSAxIGV0IDEyMCBtaW51dGVzXHJcbiAgfTtcclxuXHJcbiAgLy8gVmFsZXVyIGZvdXJuaWUgcGFyIGxlIGNvbnRleHRlXHJcbiAgY29uc3QgY29udGV4dFZhbHVlID0ge1xyXG4gICAgc2V0dGluZ3MsXHJcbiAgICB1cGRhdGVTZXR0aW5nLFxyXG4gICAgdXBkYXRlU2V0dGluZ3MsXHJcbiAgICByZXNldFNldHRpbmdzLFxyXG4gICAgYXJlTm90aWZpY2F0aW9uc0VuYWJsZWQsXHJcbiAgICBnZXREYWlseUdvYWwsXHJcbiAgICBzZXREYWlseUdvYWwsXHJcbiAgICBpc0xvYWRpbmcsXHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxTZXR0aW5nc0NvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2NvbnRleHRWYWx1ZX0+XHJcbiAgICAgIHtjaGlsZHJlbn1cclxuICAgIDwvU2V0dGluZ3NDb250ZXh0LlByb3ZpZGVyPlxyXG4gICk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTZXR0aW5nc0NvbnRleHQ7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUNBLElBQUFBLE1BQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLGFBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLFVBQUEsR0FBQUYsT0FBQTtBQUFzRCxJQUFBRyxXQUFBLEdBQUFILE9BQUE7QUFHL0MsSUFBTUksZUFBZSxHQUFBQyxPQUFBLENBQUFELGVBQUEsR0FBRyxJQUFBRSxvQkFBYSxFQUFDLENBQUM7QUFLdkMsSUFBTUMsZ0JBQWdCLEdBQUFGLE9BQUEsQ0FBQUUsZ0JBQUEsR0FBRyxTQUFuQkEsZ0JBQWdCQSxDQUFBQyxJQUFBLEVBQXFCO0VBQUEsSUFBZkMsUUFBUSxHQUFBRCxJQUFBLENBQVJDLFFBQVE7RUFFekMsSUFBQUMsU0FBQSxHQUFnQyxJQUFBQyxlQUFRLEVBQUNDLDJCQUFnQixDQUFDO0lBQUFDLFVBQUEsT0FBQUMsZUFBQSxDQUFBQyxPQUFBLEVBQUFMLFNBQUE7SUFBbkRNLFFBQVEsR0FBQUgsVUFBQTtJQUFFSSxXQUFXLEdBQUFKLFVBQUE7RUFDNUIsSUFBQUssVUFBQSxHQUFrQyxJQUFBUCxlQUFRLEVBQUMsSUFBSSxDQUFDO0lBQUFRLFVBQUEsT0FBQUwsZUFBQSxDQUFBQyxPQUFBLEVBQUFHLFVBQUE7SUFBekNFLFNBQVMsR0FBQUQsVUFBQTtJQUFFRSxZQUFZLEdBQUFGLFVBQUE7RUFHOUIsSUFBQUcsZ0JBQVMsRUFBQyxZQUFNO0lBQ2QsSUFBTUMsWUFBWTtNQUFBLElBQUFDLEtBQUEsT0FBQUMsa0JBQUEsQ0FBQVYsT0FBQSxFQUFHLGFBQVk7UUFDL0IsSUFBSTtVQUNGTSxZQUFZLENBQUMsSUFBSSxDQUFDO1VBQ2xCLElBQU1LLGFBQWEsU0FBUyxJQUFBQyxxQkFBTyxFQUFDLGNBQWMsQ0FB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