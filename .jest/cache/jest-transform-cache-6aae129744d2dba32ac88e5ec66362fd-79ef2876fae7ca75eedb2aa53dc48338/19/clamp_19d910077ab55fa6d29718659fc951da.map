{"version":3,"names":["Object","defineProperty","exports","value","withClamp","_util","require","_logger","_worklet_374384363074_init_data","code","location","sourceMap","version","_worklet_6147952660606_init_data","_e","global","Error","clampTs1","config","_animationToClamp","defineAnimation","clampTs2","animationToClamp","strippedMin","min","undefined","recognizePrefixSuffix","strippedValue","strippedMax","max","clampOnFrame","animation","now","finished","onFrame","current","logger","warn","_recognizePrefixSuffi","prefix","suffix","newValue","onStart","previousAnimation","animationBeforeClamped","callback","isHigherOrder","reduceMotion","getReduceMotionForAnimation","__closure","__workletHash","__initData","__stackDetails"],"sources":["clamp.ts"],"sourcesContent":["'use strict';\nimport {\n  defineAnimation,\n  getReduceMotionForAnimation,\n  recognizePrefixSuffix,\n} from './util';\nimport type {\n  Animation,\n  Timestamp,\n  AnimatableValue,\n  AnimationObject,\n  ReduceMotion,\n} from '../commonTypes';\nimport type { ClampAnimation } from './commonTypes';\nimport { logger } from '../logger';\n\ntype withClampType = <T extends number | string>(\n  config: {\n    min?: T;\n    max?: T;\n  },\n  clampedAnimation: T\n) => T;\n\nexport const withClamp = function <T extends number | string>(\n  config: { min?: T; max?: T; reduceMotion?: ReduceMotion },\n  _animationToClamp: AnimationObject<T> | (() => AnimationObject<T>)\n): Animation<ClampAnimation> {\n  'worklet';\n  return defineAnimation<ClampAnimation, AnimationObject<T>>(\n    _animationToClamp,\n    (): ClampAnimation => {\n      'worklet';\n      const animationToClamp =\n        typeof _animationToClamp === 'function'\n          ? _animationToClamp()\n          : _animationToClamp;\n\n      const strippedMin =\n        config.min === undefined\n          ? undefined\n          : recognizePrefixSuffix(config.min).strippedValue;\n\n      const strippedMax =\n        config.max === undefined\n          ? undefined\n          : recognizePrefixSuffix(config.max).strippedValue;\n\n      function clampOnFrame(\n        animation: ClampAnimation,\n        now: Timestamp\n      ): boolean {\n        const finished = animationToClamp.onFrame(animationToClamp, now);\n\n        if (animationToClamp.current === undefined) {\n          logger.warn(\n            \"Error inside 'withClamp' animation, the inner animation has invalid current value\"\n          );\n          return true;\n        } else {\n          const { prefix, strippedValue, suffix } = recognizePrefixSuffix(\n            animationToClamp.current\n          );\n\n          let newValue;\n\n          if (strippedMax !== undefined && strippedMax < strippedValue) {\n            newValue = strippedMax;\n          } else if (strippedMin !== undefined && strippedMin > strippedValue) {\n            newValue = strippedMin;\n          } else {\n            newValue = strippedValue;\n          }\n\n          animation.current =\n            typeof animationToClamp.current === 'number'\n              ? newValue\n              : `${prefix === undefined ? '' : prefix}${newValue}${\n                  suffix === undefined ? '' : suffix\n                }`;\n        }\n\n        return finished;\n      }\n\n      function onStart(\n        animation: Animation<any>,\n        value: AnimatableValue,\n        now: Timestamp,\n        previousAnimation: Animation<any> | null\n      ): void {\n        animation.current = value;\n        animation.previousAnimation = animationToClamp;\n        const animationBeforeClamped = previousAnimation?.previousAnimation;\n        if (\n          config.max !== undefined &&\n          config.min !== undefined &&\n          config.max < config.min\n        ) {\n          logger.warn(\n            'Wrong config was provided to withClamp. Min value is bigger than max'\n          );\n        }\n\n        animationToClamp.onStart(\n          animationToClamp,\n          /**\n           * Provide the current value of the previous animation of the clamped\n           * animation so we can animate from the original \"un-truncated\" value\n           */\n          animationBeforeClamped?.current || value,\n          now,\n          animationBeforeClamped\n        );\n      }\n\n      const callback = (finished?: boolean): void => {\n        if (animationToClamp.callback) {\n          animationToClamp.callback(finished);\n        }\n      };\n\n      return {\n        isHigherOrder: true,\n        onFrame: clampOnFrame,\n        onStart,\n        current: animationToClamp.current!,\n        callback,\n        previousAnimation: null,\n        reduceMotion: getReduceMotionForAnimation(config.reduceMotion),\n      };\n    }\n  );\n} as withClampType;\n"],"mappings":"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","ignoreList":[]}