e3c8ae8d57c948ed8a3818079f139caa
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.LockProvider = LockProvider;
exports.useLock = useLock;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var _propTypes = _interopRequireDefault(require("prop-types"));
var Lock = _interopRequireWildcard(require("../services/lockService"));
var _jsxRuntime = require("react/jsx-runtime");
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function _interopRequireWildcard(e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (var _t in e) "default" !== _t && {}.hasOwnProperty.call(e, _t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t)) && (i.get || i.set) ? o(f, _t, i) : f[_t] = e[_t]); return f; })(e, t); }
var LockContext = (0, _react.createContext)(null);
function LockProvider(_ref) {
  var children = _ref.children;
  var _useState = (0, _react.useState)(false),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    isEnabled = _useState2[0],
    setIsEnabled = _useState2[1];
  var _useState3 = (0, _react.useState)(false),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    isLocked = _useState4[0],
    setIsLocked = _useState4[1];
  var _useState5 = (0, _react.useState)(true),
    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),
    isLoading = _useState6[0],
    setIsLoading = _useState6[1];
  (0, _react.useEffect)(function () {
    (0, _asyncToGenerator2.default)(function* () {
      try {
        var enabled = yield Lock.isEnabled();
        setIsEnabled(enabled);
        setIsLocked(enabled);
      } finally {
        setIsLoading(false);
      }
    })();
  }, []);
  var lockNow = (0, _react.useCallback)(function () {
    if (isEnabled) setIsLocked(true);
  }, [isEnabled]);
  var unlockWithPin = (0, _react.useCallback)(function () {
    var _ref3 = (0, _asyncToGenerator2.default)(function* (pin) {
      var res = yield Lock.verifyPin(pin);
      if (res.ok) {
        setIsLocked(false);
        return {
          ok: true
        };
      }
      if (res.reason === 'lockout') return {
        ok: false,
        reason: 'lockout'
      };
      return {
        ok: false
      };
    });
    return function (_x) {
      return _ref3.apply(this, arguments);
    };
  }(), []);
  var disable = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    yield Lock.disableLock();
    setIsEnabled(false);
    setIsLocked(false);
  }), []);
  var enable = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    yield Lock.enableLock();
    setIsEnabled(true);
    setIsLocked(true);
  }), []);
  var value = {
    isEnabled: isEnabled,
    isLocked: isLocked,
    isLoading: isLoading,
    lockNow: lockNow,
    unlockWithPin: unlockWithPin,
    enable: enable,
    disable: disable
  };
  return (0, _jsxRuntime.jsx)(LockContext.Provider, {
    value: value,
    children: children
  });
}
LockProvider.propTypes = {
  children: _propTypes.default.node.isRequired
};
function useLock() {
  var ctx = (0, _react.useContext)(LockContext);
  if (!ctx) throw new Error('useLock must be used within LockProvider');
  return ctx;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3Byb3BUeXBlcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJMb2NrIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJfanN4UnVudGltZSIsImUiLCJ0IiwiV2Vha01hcCIsInIiLCJuIiwiX19lc01vZHVsZSIsIm8iLCJpIiwiZiIsIl9fcHJvdG9fXyIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJzZXQiLCJfdCIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiTG9ja0NvbnRleHQiLCJjcmVhdGVDb250ZXh0IiwiTG9ja1Byb3ZpZGVyIiwiX3JlZiIsImNoaWxkcmVuIiwiX3VzZVN0YXRlIiwidXNlU3RhdGUiLCJfdXNlU3RhdGUyIiwiX3NsaWNlZFRvQXJyYXkyIiwiaXNFbmFibGVkIiwic2V0SXNFbmFibGVkIiwiX3VzZVN0YXRlMyIsIl91c2VTdGF0ZTQiLCJpc0xvY2tlZCIsInNldElzTG9ja2VkIiwiX3VzZVN0YXRlNSIsIl91c2VTdGF0ZTYiLCJpc0xvYWRpbmciLCJzZXRJc0xvYWRpbmciLCJ1c2VFZmZlY3QiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJlbmFibGVkIiwibG9ja05vdyIsInVzZUNhbGxiYWNrIiwidW5sb2NrV2l0aFBpbiIsIl9yZWYzIiwicGluIiwicmVzIiwidmVyaWZ5UGluIiwib2siLCJyZWFzb24iLCJfeCIsImFwcGx5IiwiYXJndW1lbnRzIiwiZGlzYWJsZSIsImRpc2FibGVMb2NrIiwiZW5hYmxlIiwiZW5hYmxlTG9jayIsInZhbHVlIiwianN4IiwiUHJvdmlkZXIiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJub2RlIiwiaXNSZXF1aXJlZCIsInVzZUxvY2siLCJjdHgiLCJ1c2VDb250ZXh0IiwiRXJyb3IiXSwic291cmNlcyI6WyJMb2NrQ29udGV4dC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvY29udGV4dHMvTG9ja0NvbnRleHQuanNcclxuaW1wb3J0IHsgY3JlYXRlQ29udGV4dCwgdXNlQ2FsbGJhY2ssIHVzZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XHJcbmltcG9ydCAqIGFzIExvY2sgZnJvbSAnLi4vc2VydmljZXMvbG9ja1NlcnZpY2UnO1xyXG5cclxuY29uc3QgTG9ja0NvbnRleHQgPSBjcmVhdGVDb250ZXh0KG51bGwpO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIExvY2tQcm92aWRlcih7IGNoaWxkcmVuIH0pIHtcclxuICBjb25zdCBbaXNFbmFibGVkLCBzZXRJc0VuYWJsZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtpc0xvY2tlZCwgc2V0SXNMb2NrZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIChhc3luYyAoKSA9PiB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZW5hYmxlZCA9IGF3YWl0IExvY2suaXNFbmFibGVkKCk7XHJcbiAgICAgICAgc2V0SXNFbmFibGVkKGVuYWJsZWQpO1xyXG4gICAgICAgIHNldElzTG9ja2VkKGVuYWJsZWQpO1xyXG4gICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIH1cclxuICAgIH0pKCk7XHJcbiAgfSwgW10pO1xyXG5cclxuICBjb25zdCBsb2NrTm93ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgaWYgKGlzRW5hYmxlZCkgc2V0SXNMb2NrZWQodHJ1ZSk7XHJcbiAgfSwgW2lzRW5hYmxlZF0pO1xyXG5cclxuICBjb25zdCB1bmxvY2tXaXRoUGluID0gdXNlQ2FsbGJhY2soYXN5bmMgKHBpbikgPT4ge1xyXG4gICAgY29uc3QgcmVzID0gYXdhaXQgTG9jay52ZXJpZnlQaW4ocGluKTtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgc2V0SXNMb2NrZWQoZmFsc2UpO1xyXG4gICAgICByZXR1cm4geyBvazogdHJ1ZSB9O1xyXG4gICAgfVxyXG4gICAgaWYgKHJlcy5yZWFzb24gPT09ICdsb2Nrb3V0JykgcmV0dXJuIHsgb2s6IGZhbHNlLCByZWFzb246ICdsb2Nrb3V0JyB9O1xyXG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlIH07XHJcbiAgfSwgW10pO1xyXG5cclxuICBjb25zdCBkaXNhYmxlID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgYXdhaXQgTG9jay5kaXNhYmxlTG9jaygpO1xyXG4gICAgc2V0SXNFbmFibGVkKGZhbHNlKTtcclxuICAgIHNldElzTG9ja2VkKGZhbHNlKTtcclxuICB9LCBbXSk7XHJcblxyXG4gIGNvbnN0IGVuYWJsZSA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcclxuICAgIGF3YWl0IExvY2suZW5hYmxlTG9jaygpO1xyXG4gICAgc2V0SXNFbmFibGVkKHRydWUpO1xyXG4gICAgc2V0SXNMb2NrZWQodHJ1ZSk7XHJcbiAgfSwgW10pO1xyXG5cclxuICBjb25zdCB2YWx1ZSA9IHtcclxuICAgIGlzRW5hYmxlZCxcclxuICAgIGlzTG9ja2VkLFxyXG4gICAgaXNMb2FkaW5nLFxyXG4gICAgbG9ja05vdyxcclxuICAgIHVubG9ja1dpdGhQaW4sXHJcbiAgICBlbmFibGUsXHJcbiAgICBkaXNhYmxlLFxyXG4gIH07XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8TG9ja0NvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3ZhbHVlfT57Y2hpbGRyZW59PC9Mb2NrQ29udGV4dC5Qcm92aWRlcj5cclxuICApO1xyXG59XHJcblxyXG5Mb2NrUHJvdmlkZXIucHJvcFR5cGVzID0ge1xyXG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMubm9kZS5pc1JlcXVpcmVkLFxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVzZUxvY2soKSB7XHJcbiAgY29uc3QgY3R4ID0gdXNlQ29udGV4dChMb2NrQ29udGV4dCk7XHJcbiAgaWYgKCFjdHgpIHRocm93IG5ldyBFcnJvcigndXNlTG9jayBtdXN0IGJlIHVzZWQgd2l0aGluIExvY2tQcm92aWRlcicpO1xyXG4gIHJldHVybiBjdHg7XHJcbn1cclxuXHJcblxyXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQ0EsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsVUFBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUcsSUFBQSxHQUFBQyx1QkFBQSxDQUFBSixPQUFBO0FBQWdELElBQUFLLFdBQUEsR0FBQUwsT0FBQTtBQUFBLFNBQUFJLHdCQUFBRSxDQUFBLEVBQUFDLENBQUEsNkJBQUFDLE9BQUEsTUFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBSix1QkFBQSxZQUFBQSx3QkFBQUUsQ0FBQSxFQUFBQyxDQUFBLFNBQUFBLENBQUEsSUFBQUQsQ0FBQSxJQUFBQSxDQUFBLENBQUFLLFVBQUEsU0FBQUwsQ0FBQSxNQUFBTSxDQUFBLEVBQUFDLENBQUEsRUFBQUMsQ0FBQSxLQUFBQyxTQUFBLFFBQUFDLE9BQUEsRUFBQVYsQ0FBQSxpQkFBQUEsQ0FBQSx1QkFBQUEsQ0FBQSx5QkFBQUEsQ0FBQSxTQUFBUSxDQUFBLE1BQUFGLENBQUEsR0FBQUwsQ0FBQSxHQUFBRyxDQUFBLEdBQUFELENBQUEsUUFBQUcsQ0FBQSxDQUFBSyxHQUFBLENBQUFYLENBQUEsVUFBQU0sQ0FBQSxDQUFBTSxHQUFBLENBQUFaLENBQUEsR0FBQU0sQ0FBQSxDQUFBTyxHQUFBLENBQUFiLENBQUEsRUFBQVEsQ0FBQSxjQUFBTSxFQUFBLElBQUFkLENBQUEsZ0JBQUFjLEVBQUEsT0FBQUMsY0FBQSxDQUFBQyxJQUFBLENBQUFoQixDQUFBLEVBQUFjLEVBQUEsT0FBQVAsQ0FB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