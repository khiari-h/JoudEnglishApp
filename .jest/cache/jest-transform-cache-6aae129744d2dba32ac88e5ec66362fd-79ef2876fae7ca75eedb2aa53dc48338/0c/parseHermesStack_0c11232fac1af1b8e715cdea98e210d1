5ac5bac1634667ba051ad4ed9885f7d5
'use strict';

var RE_FRAME = /^ {4}at (.+?)(?: \((native)\)?| \((address at )?(.*?):(\d+):(\d+)\))$/;
var RE_SKIPPED = /^ {4}... skipping (\d+) frames$/;
var RE_COMPONENT_NO_STACK = /^ {4}at .*$/;
function isInternalBytecodeSourceUrl(sourceUrl) {
  return sourceUrl === 'InternalBytecode.js';
}
function parseLine(line) {
  var asFrame = line.match(RE_FRAME);
  if (asFrame) {
    return {
      type: 'FRAME',
      functionName: asFrame[1],
      location: asFrame[2] === 'native' ? {
        type: 'NATIVE'
      } : asFrame[3] === 'address at ' ? isInternalBytecodeSourceUrl(asFrame[4]) ? {
        type: 'INTERNAL_BYTECODE',
        sourceUrl: asFrame[4],
        line1Based: Number.parseInt(asFrame[5], 10),
        virtualOffset0Based: Number.parseInt(asFrame[6], 10)
      } : {
        type: 'BYTECODE',
        sourceUrl: asFrame[4],
        line1Based: Number.parseInt(asFrame[5], 10),
        virtualOffset0Based: Number.parseInt(asFrame[6], 10)
      } : {
        type: 'SOURCE',
        sourceUrl: asFrame[4],
        line1Based: Number.parseInt(asFrame[5], 10),
        column1Based: Number.parseInt(asFrame[6], 10)
      }
    };
  }
  var asSkipped = line.match(RE_SKIPPED);
  if (asSkipped) {
    return {
      type: 'SKIPPED',
      count: Number.parseInt(asSkipped[1], 10)
    };
  }
}
module.exports = function parseHermesStack(stack) {
  var lines = stack.split(/\n/);
  var entries = [];
  var lastMessageLine = -1;
  for (var i = 0; i < lines.length; ++i) {
    var line = lines[i];
    if (!line) {
      continue;
    }
    var entry = parseLine(line);
    if (entry) {
      entries.push(entry);
      continue;
    }
    if (RE_COMPONENT_NO_STACK.test(line)) {
      continue;
    }
    lastMessageLine = i;
    entries = [];
  }
  var message = lines.slice(0, lastMessageLine + 1).join('\n');
  return {
    message: message,
    entries: entries
  };
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSRV9GUkFNRSIsIlJFX1NLSVBQRUQiLCJSRV9DT01QT05FTlRfTk9fU1RBQ0siLCJpc0ludGVybmFsQnl0ZWNvZGVTb3VyY2VVcmwiLCJzb3VyY2VVcmwiLCJwYXJzZUxpbmUiLCJsaW5lIiwiYXNGcmFtZSIsIm1hdGNoIiwidHlwZSIsImZ1bmN0aW9uTmFtZSIsImxvY2F0aW9uIiwibGluZTFCYXNlZCIsIk51bWJlciIsInBhcnNlSW50IiwidmlydHVhbE9mZnNldDBCYXNlZCIsImNvbHVtbjFCYXNlZCIsImFzU2tpcHBlZCIsImNvdW50IiwibW9kdWxlIiwiZXhwb3J0cyIsInBhcnNlSGVybWVzU3RhY2siLCJzdGFjayIsImxpbmVzIiwic3BsaXQiLCJlbnRyaWVzIiwibGFzdE1lc3NhZ2VMaW5lIiwiaSIsImxlbmd0aCIsImVudHJ5IiwicHVzaCIsInRlc3QiLCJtZXNzYWdlIiwic2xpY2UiLCJqb2luIl0sInNvdXJjZXMiOlsicGFyc2VIZXJtZXNTdGFjay5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZvcm1hdFxuICogQGZsb3cgc3RyaWN0XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG50eXBlIEhlcm1lc1N0YWNrTG9jYXRpb25OYXRpdmUgPSAkUmVhZE9ubHk8e1xuICB0eXBlOiAnTkFUSVZFJyxcbn0+O1xuXG50eXBlIEhlcm1lc1N0YWNrTG9jYXRpb25Tb3VyY2UgPSAkUmVhZE9ubHk8e1xuICB0eXBlOiAnU09VUkNFJyxcbiAgc291cmNlVXJsOiBzdHJpbmcsXG4gIGxpbmUxQmFzZWQ6IG51bWJlcixcbiAgY29sdW1uMUJhc2VkOiBudW1iZXIsXG59PjtcblxudHlwZSBIZXJtZXNTdGFja0xvY2F0aW9uSW50ZXJuYWxCeXRlY29kZSA9ICRSZWFkT25seTx7XG4gIHR5cGU6ICdJTlRFUk5BTF9CWVRFQ09ERScsXG4gIHNvdXJjZVVybDogc3RyaW5nLFxuICBsaW5lMUJhc2VkOiBudW1iZXIsXG4gIHZpcnR1YWxPZmZzZXQwQmFzZWQ6IG51bWJlcixcbn0+O1xuXG50eXBlIEhlcm1lc1N0YWNrTG9jYXRpb25CeXRlY29kZSA9ICRSZWFkT25seTx7XG4gIHR5cGU6ICdCWVRFQ09ERScsXG4gIHNvdXJjZVVybDogc3RyaW5nLFxuICBsaW5lMUJhc2VkOiBudW1iZXIsXG4gIHZpcnR1YWxPZmZzZXQwQmFzZWQ6IG51bWJlcixcbn0+O1xuXG50eXBlIEhlcm1lc1N0YWNrTG9jYXRpb24gPVxuICB8IEhlcm1lc1N0YWNrTG9jYXRpb25OYXRpdmVcbiAgfCBIZXJtZXNTdGFja0xvY2F0aW9uU291cmNlXG4gIHwgSGVybWVzU3RhY2tMb2NhdGlvbkludGVybmFsQnl0ZWNvZGVcbiAgfCBIZXJtZXNTdGFja0xvY2F0aW9uQnl0ZWNvZGU7XG5cbnR5cGUgSGVybWVzU3RhY2tFbnRyeUZyYW1lID0gJFJlYWRPbmx5PHtcbiAgdHlwZTogJ0ZSQU1FJyxcbiAgbG9jYXRpb246IEhlcm1lc1N0YWNrTG9jYXRpb24sXG4gIGZ1bmN0aW9uTmFtZTogc3RyaW5nLFxufT47XG5cbnR5cGUgSGVybWVzU3RhY2tFbnRyeVNraXBwZWQgPSAkUmVhZE9ubHk8e1xuICB0eXBlOiAnU0tJUFBFRCcsXG4gIGNvdW50OiBudW1iZXIsXG59PjtcblxudHlwZSBIZXJtZXNTdGFja0VudHJ5ID0gSGVybWVzU3RhY2tFbnRyeUZyYW1lIHwgSGVybWVzU3RhY2tFbnRyeVNraXBwZWQ7XG5cbmV4cG9ydCB0eXBlIEhlcm1lc1BhcnNlZFN0YWNrID0gJFJlYWRPbmx5PHtcbiAgbWVzc2FnZTogc3RyaW5nLFxuICBlbnRyaWVzOiAkUmVhZE9ubHlBcnJheTxIZXJtZXNTdGFja0VudHJ5Pixcbn0+O1xuXG4vLyBDYXB0dXJpbmcgZ3JvdXBzOlxuLy8gMS4gZnVuY3Rpb24gbmFtZVxuLy8gMi4gaXMgdGhpcyBhIG5hdGl2ZSBzdGFjayBmcmFtZT9cbi8vIDMuIGlzIHRoaXMgYSBieXRlY29kZSBhZGRyZXNzIG9yIGEgc291cmNlIGxvY2F0aW9uP1xuLy8gNC4gc291cmNlIFVSTCAoZmlsZW5hbWUpXG4vLyA1LiBsaW5lIG51bWJlciAoMSBiYXNlZClcbi8vIDYuIGNvbHVtbiBudW1iZXIgKDEgYmFzZWQpIG9yIHZpcnR1YWwgb2Zmc2V0ICgwIGJhc2VkKVxuY29uc3QgUkVfRlJBTUUgPVxuICAvXiB7NH1hdCAoLis/KSg/OiBcXCgobmF0aXZlKVxcKT98IFxcKChhZGRyZXNzIGF0ICk/KC4qPyk6KFxcZCspOihcXGQrKVxcKSkkLztcblxuLy8gQ2FwdHVyaW5nIGdyb3Vwczpcbi8vIDEuIGNvdW50IG9mIHNraXBwZWQgZnJhbWVzXG5jb25zdCBSRV9TS0lQUEVEID0gL14gezR9Li4uIHNraXBwaW5nIChcXGQrKSBmcmFtZXMkLztcbmNvbnN0IFJFX0NPTVBPTkVOVF9OT19TVEFDSyA9IC9eIHs0fWF0IC4qJC87XG5cbmZ1bmN0aW9uIGlzSW50ZXJuYWxCeXRlY29kZVNvdXJjZVVybChzb3VyY2VVcmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2hlcm1lcy9ibG9iLzMzMzJmYTAyMGNhZTBiYWI3NTFmNjQ4ZGI3Yzk0ZTFkNjg3ZWVlYzcvbGliL1ZNL1J1bnRpbWUuY3BwI0wxMTAwXG4gIHJldHVybiBzb3VyY2VVcmwgPT09ICdJbnRlcm5hbEJ5dGVjb2RlLmpzJztcbn1cblxuZnVuY3Rpb24gcGFyc2VMaW5lKGxpbmU6IHN0cmluZyk6ID9IZXJtZXNTdGFja0VudHJ5IHtcbiAgY29uc3QgYXNGcmFtZSA9IGxpbmUubWF0Y2goUkVfRlJBTUUpO1xuICBpZiAoYXNGcmFtZSkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnRlJBTUUnLFxuICAgICAgZnVuY3Rpb25OYW1lOiBhc0ZyYW1lWzFdLFxuICAgICAgbG9jYXRpb246XG4gICAgICAgIGFzRnJhbWVbMl0gPT09ICduYXRpdmUnXG4gICAgICAgICAgPyB7dHlwZTogJ05BVElWRSd9XG4gICAgICAgICAgOiBhc0ZyYW1lWzNdID09PSAnYWRkcmVzcyBhdCAnXG4gICAgICAgICAgICA/IGlzSW50ZXJuYWxCeXRlY29kZVNvdXJjZVVybChhc0ZyYW1lWzRdKVxuICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdJTlRFUk5BTF9CWVRFQ09ERScsXG4gICAgICAgICAgICAgICAgICBzb3VyY2VVcmw6IGFzRnJhbWVbNF0sXG4gICAgICAgICAgICAgICAgICBsaW5lMUJhc2VkOiBOdW1iZXIucGFyc2VJbnQoYXNGcmFtZVs1XSwgMTApLFxuICAgICAgICAgICAgICAgICAgdmlydHVhbE9mZnNldDBCYXNlZDogTnVtYmVyLnBhcnNlSW50KGFzRnJhbWVbNl0sIDEwKSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgdHlwZTogJ0JZVEVDT0RFJyxcbiAgICAgICAgICAgICAgICAgIHNvdXJjZVVybDogYXNGcmFtZVs0XSxcbiAgICAgICAgICAgICAgICAgIGxpbmUxQmFzZWQ6IE51bWJlci5wYXJzZUludChhc0ZyYW1lWzVdLCAxMCksXG4gICAgICAgICAgICAgICAgICB2aXJ0dWFsT2Zmc2V0MEJhc2VkOiBOdW1iZXIucGFyc2VJbnQoYXNGcmFtZVs2XSwgMTApLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdTT1VSQ0UnLFxuICAgICAgICAgICAgICAgIHNvdXJjZVVybDogYXNGcmFtZVs0XSxcbiAgICAgICAgICAgICAgICBsaW5lMUJhc2VkOiBOdW1iZXIucGFyc2VJbnQoYXNGcmFtZVs1XSwgMTApLFxuICAgICAgICAgICAgICAgIGNvbHVtbjFCYXNlZDogTnVtYmVyLnBhcnNlSW50KGFzRnJhbWVbNl0sIDEwKSxcbiAgICAgICAgICAgICAgfSxcbiAgICB9O1xuICB9XG4gIGNvbnN0IGFzU2tpcHBlZCA9IGxpbmUubWF0Y2goUkVfU0tJUFBFRCk7XG4gIGlmIChhc1NraXBwZWQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ1NLSVBQRUQnLFxuICAgICAgY291bnQ6IE51bWJlci5wYXJzZUludChhc1NraXBwZWRbMV0sIDEwKSxcbiAgICB9O1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gcGFyc2VIZXJtZXNTdGFjayhzdGFjazogc3RyaW5nKTogSGVybWVzUGFyc2VkU3RhY2sge1xuICBjb25zdCBsaW5lcyA9IHN0YWNrLnNwbGl0KC9cXG4vKTtcbiAgbGV0IGVudHJpZXM6IEFycmF5PEhlcm1lc1N0YWNrRW50cnlGcmFtZSB8IEhlcm1lc1N0YWNrRW50cnlTa2lwcGVkPiA9IFtdO1xuICBsZXQgbGFzdE1lc3NhZ2VMaW5lID0gLTE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyArK2kpIHtcbiAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XG4gICAgaWYgKCFsaW5lKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY29uc3QgZW50cnkgPSBwYXJzZUxpbmUobGluZSk7XG4gICAgaWYgKGVudHJ5KSB7XG4gICAgICBlbnRyaWVzLnB1c2goZW50cnkpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChSRV9DT01QT05FTlRfTk9fU1RBQ0sudGVzdChsaW5lKSkge1xuICAgICAgLy8gU2tpcCBjb21wb25lbnQgc3RhY2tzIHdpdGhvdXQgc291cmNlIGxvY2F0aW9uLlxuICAgICAgLy8gVE9ETzogVGhpcyB3aWxsIG5vdCBiZSBkaXNwbGF5ZWQsIG5vdCBzdXJlIGhvdyB0byBoYW5kbGUgaXQuXG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgLy8gTm8gbWF0Y2ggLSB3ZSdyZSBzdGlsbCBpbiB0aGUgbWVzc2FnZVxuICAgIGxhc3RNZXNzYWdlTGluZSA9IGk7XG4gICAgZW50cmllcyA9IFtdO1xuICB9XG4gIGNvbnN0IG1lc3NhZ2UgPSBsaW5lcy5zbGljZSgwLCBsYXN0TWVzc2FnZUxpbmUgKyAxKS5qb2luKCdcXG4nKTtcbiAgcmV0dXJuIHttZXNzYWdlLCBlbnRyaWVzfTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQVVBLFlBQVk7O0FBMERaLElBQU1BLFFBQVEsR0FDWix1RUFBdUU7QUFJekUsSUFBTUMsVUFBVSxHQUFHLGlDQUFpQztBQUNwRCxJQUFNQyxxQkFBcUIsR0FBRyxhQUFhO0FBRTNDLFNBQVNDLDJCQUEyQkEsQ0FBQ0MsU0FBaUIsRUFBVztFQUUvRCxPQUFPQSxTQUFTLEtBQUsscUJBQXFCO0FBQzVDO0FBRUEsU0FBU0MsU0FBU0EsQ0FBQ0MsSUFBWSxFQUFxQjtFQUNsRCxJQUFNQyxPQUFPLEdBQUdELElBQUksQ0FBQ0UsS0FBSyxDQUFDUixRQUFRLENBQUM7RUFDcEMsSUFBSU8sT0FBTyxFQUFFO0lBQ1gsT0FBTztNQUNMRSxJQUFJLEVBQUUsT0FBTztNQUNiQyxZQUFZLEVBQUVILE9BQU8sQ0FBQyxDQUFDLENBQUM7TUFDeEJJLFFBQVEsRUFDTkosT0FBTyxDQUFDLENBQUMsQ0FBQyxLQUFLLFFBQVEsR0FDbkI7UUFBQ0UsSUFBSSxFQUFFO01BQVEsQ0FBQyxHQUNoQkYsT0FBTyxDQUFDLENBQUMsQ0FBQyxLQUFLLGFBQWEsR0FDMUJKLDJCQUEyQixDQUFDSSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FDckM7UUFDRUUsSUFBSSxFQUFFLG1CQUFtQjtRQUN6QkwsU0FBUyxFQUFFRyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQ3JCSyxVQUFVLEVBQUVDLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDUCxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQzNDUSxtQkFBbUIsRUFBRUYsTUFBTSxDQUFDQyxRQUFRLENBQUNQLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO01BQ3JELENBQUMsR0FDRDtRQUNFRSxJQUFJLEVBQUUsVUFBVTtRQUNoQkwsU0FBUyxFQUFFRyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQ3JCSyxVQUFVLEVBQUVDLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDUCxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQzNDUSxtQkFBbUIsRUFBRUYsTUFBTSxDQUFDQyxRQUFRLENBQUNQLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO01BQ3JELENBQUMsR0FDSDtRQUNFRSxJQUFJLEVBQUUsUUFBUTtRQUNkTCxTQUFTLEVBQUVHLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDckJLLFVBQVUsRUFBRUMsTUFBTSxDQUFDQyxRQUFRLENBQUNQLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDM0NTLFlBQVksRUFBRUgsTUFBTSxDQUFDQyxRQUFRLENBQUNQLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO01BQzlDO0lBQ1YsQ0FBQztFQUNIO0VBQ0EsSUFBTVUsU0FBUyxHQUFHWCxJQUFJLENBQUNFLEtBQUssQ0FBQ1AsVUFBVSxDQUFDO0VBQ3hDLElBQUlnQixTQUFTLEVBQUU7SUFDYixPQUFPO01BQ0xSLElBQUksRUFBRSxTQUFTO01BQ2ZTLEtBQUssRUFBRUwsTUFBTSxDQUFDQyxRQUFRLENBQUNHLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFO0lBQ3pDLENBQUM7RUFDSDtBQUNGO0FBRUFFLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHLFNBQVNDLGdCQUFnQkEsQ0FBQ0MsS0FBYSxFQUFxQjtFQUMzRSxJQUFNQyxLQUFLLEdBQUdELEtBQUssQ0FBQ0UsS0FBSyxDQUFDLElBQUksQ0FBQztFQUMvQixJQUFJQyxPQUErRCxHQUFHLEVBQUU7RUFDeEUsSUFBSUMsZUFBZSxHQUFHLENBQUMsQ0FBQztFQUN4QixLQUFLLElBQUlDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR0osS0FBSyxDQUFDSyxNQUFNLEVBQUUsRUFBRUQsQ0FBQyxFQUFFO0lBQ3JDLElBQU1yQixJQUFJLEdBQUdpQixLQUFLLENBQUNJLENBQUMsQ0FBQztJQUNyQixJQUFJLENBQUNyQixJQUFJLEVBQUU7TUFDVDtJQUNGO0lBQ0EsSUFBTXVCLEtBQUssR0FBR3hCLFNBQVMsQ0FBQ0MsSUFBSSxDQUFDO0lBQzdCLElBQUl1QixLQUFLLEVBQUU7TUFDVEosT0FBTyxDQUFDSyxJQUFJLENBQUNELEtBQUssQ0FBQztNQUNuQjtJQUNGO0lBQ0EsSUFBSTNCLHFCQUFxQixDQUFDNkIsSUFBSSxDQUFDekIsSUFBSSxDQUFDLEVBQUU7TUFHcEM7SUFDRjtJQUVBb0IsZUFBZSxHQUFHQyxDQUFDO0lBQ25CRixPQUFPLEdBQUcsRUFBRTtFQUNkO0VBQ0EsSUFBTU8sT0FBTyxHQUFHVCxLQUFLLENBQUNVLEtBQUssQ0FBQyxDQUFDLEVBQUVQLGVBQWUsR0FBRyxDQUFDLENBQUMsQ0FBQ1EsSUFBSSxDQUFDLElBQUksQ0FBQztFQUM5RCxPQUFPO0lBQUNGLE9BQU8sRUFBUEEsT0FBTztJQUFFUCxPQUFPLEVBQVBBO0VBQU8sQ0FBQztBQUMzQixDQUFDIiwiaWdub3JlTGlzdCI6W119