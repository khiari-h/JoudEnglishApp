{"version":3,"names":["Object","defineProperty","exports","value","shareableMappingFlag","shareableMappingCache","_PlatformChecker","require","SHOULD_BE_USE_WEB","shouldBeUseWeb","Symbol","cache","WeakMap","set","get","shareable","shareableRef","bind"],"sources":["shareableMappingCache.ts"],"sourcesContent":["'use strict';\nimport { shouldBeUseWeb } from './PlatformChecker';\nimport type { ShareableRef } from './commonTypes';\n\nconst SHOULD_BE_USE_WEB = shouldBeUseWeb();\n\n/**\n * This symbol is used to represent a mapping from the value to itself.\n *\n * It's used to prevent converting a shareable that's already converted - for\n * example a Shared Value that's in worklet's closure.\n */\nexport const shareableMappingFlag = Symbol('shareable flag');\n\n/*\nDuring a fast refresh, React holds the same instance of a Mutable\n(that's guaranteed by `useRef`) but `shareableCache` gets regenerated and thus\nbecoming empty. This happens when editing the file that contains the definition of this cache.\n\nBecause of it, `makeShareableCloneRecursive` can't find given mapping\nin `shareableCache` for the Mutable and tries to clone it as if it was a regular JS object.\nDuring cloning we use `Object.entries` to iterate over the keys which throws an error on accessing `_value`.\nFor convenience we moved this cache to a separate file so it doesn't scare us with red squiggles.\n*/\n\nconst cache = SHOULD_BE_USE_WEB\n  ? null\n  : new WeakMap<object, ShareableRef | symbol>();\n\nexport const shareableMappingCache = SHOULD_BE_USE_WEB\n  ? {\n      set() {\n        // NOOP\n      },\n      get() {\n        return null;\n      },\n    }\n  : {\n      set(shareable: object, shareableRef?: ShareableRef): void {\n        cache!.set(shareable, shareableRef || shareableMappingFlag);\n      },\n      get: cache!.get.bind(cache),\n    };\n"],"mappings":"AAAA,YAAY;;AAACA,MAAA,CAAAC,cAAA,CAAAC,OAAA;EAAAC,KAAA;AAAA;AAAAD,OAAA,CAAAE,oBAAA,GAAAF,OAAA,CAAAG,qBAAA;AACb,IAAAC,gBAAA,GAAAC,OAAA;AAGA,IAAMC,iBAAiB,GAAG,IAAAC,+BAAc,EAAC,CAAC;AAQnC,IAAML,oBAAoB,GAAAF,OAAA,CAAAE,oBAAA,GAAGM,MAAM,CAAC,gBAAgB,CAAC;AAa5D,IAAMC,KAAK,GAAGH,iBAAiB,GAC3B,IAAI,GACJ,IAAII,OAAO,CAAgC,CAAC;AAEzC,IAAMP,qBAAqB,GAAAH,OAAA,CAAAG,qBAAA,GAAGG,iBAAiB,GAClD;EACEK,GAAG,WAAHA,GAAGA,CAAA,EAAG,CAEN,CAAC;EACDC,GAAG,WAAHA,GAAGA,CAAA,EAAG;IACJ,OAAO,IAAI;EACb;AACF,CAAC,GACD;EACED,GAAG,WAAHA,GAAGA,CAACE,SAAiB,EAAEC,YAA2B,EAAQ;IACxDL,KAAK,CAAEE,GAAG,CAACE,SAAS,EAAEC,YAAY,IAAIZ,oBAAoB,CAAC;EAC7D,CAAC;EACDU,GAAG,EAAEH,KAAK,CAAEG,GAAG,CAACG,IAAI,CAACN,KAAK;AAC5B,CAAC","ignoreList":[]}