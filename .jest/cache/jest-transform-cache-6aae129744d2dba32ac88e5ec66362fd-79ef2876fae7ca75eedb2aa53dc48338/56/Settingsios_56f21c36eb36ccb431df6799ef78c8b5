680eae89e0f94d09a788928b6c26827a
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _RCTDeviceEventEmitter = _interopRequireDefault(require("../EventEmitter/RCTDeviceEventEmitter"));
var _NativeSettingsManager = _interopRequireDefault(require("./NativeSettingsManager"));
var _invariant = _interopRequireDefault(require("invariant"));
var subscriptions = [];
var Settings = {
  _settings: _NativeSettingsManager.default && _NativeSettingsManager.default.getConstants().settings,
  get: function get(key) {
    return this._settings[key];
  },
  set: function set(settings) {
    this._settings = Object.assign(this._settings, settings);
    _NativeSettingsManager.default.setValues(settings);
  },
  watchKeys: function watchKeys(keys, callback) {
    if (typeof keys === 'string') {
      keys = [keys];
    }
    (0, _invariant.default)(Array.isArray(keys), 'keys should be a string or array of strings');
    var sid = subscriptions.length;
    subscriptions.push({
      keys: keys,
      callback: callback
    });
    return sid;
  },
  clearWatch: function clearWatch(watchId) {
    if (watchId < subscriptions.length) {
      subscriptions[watchId] = {
        keys: [],
        callback: null
      };
    }
  },
  _sendObservations: function _sendObservations(body) {
    var _this = this;
    Object.keys(body).forEach(function (key) {
      var newValue = body[key];
      var didChange = _this._settings[key] !== newValue;
      _this._settings[key] = newValue;
      if (didChange) {
        subscriptions.forEach(function (sub) {
          if (sub.keys.indexOf(key) !== -1 && sub.callback) {
            sub.callback();
          }
        });
      }
    });
  }
};
_RCTDeviceEventEmitter.default.addListener('settingsUpdated', Settings._sendObservations.bind(Settings));
module.exports = Settings;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfUkNURGV2aWNlRXZlbnRFbWl0dGVyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfTmF0aXZlU2V0dGluZ3NNYW5hZ2VyIiwiX2ludmFyaWFudCIsInN1YnNjcmlwdGlvbnMiLCJTZXR0aW5ncyIsIl9zZXR0aW5ncyIsIk5hdGl2ZVNldHRpbmdzTWFuYWdlciIsImdldENvbnN0YW50cyIsInNldHRpbmdzIiwiZ2V0Iiwia2V5Iiwic2V0IiwiT2JqZWN0IiwiYXNzaWduIiwic2V0VmFsdWVzIiwid2F0Y2hLZXlzIiwia2V5cyIsImNhbGxiYWNrIiwiaW52YXJpYW50IiwiQXJyYXkiLCJpc0FycmF5Iiwic2lkIiwibGVuZ3RoIiwicHVzaCIsImNsZWFyV2F0Y2giLCJ3YXRjaElkIiwiX3NlbmRPYnNlcnZhdGlvbnMiLCJib2R5IiwiX3RoaXMiLCJmb3JFYWNoIiwibmV3VmFsdWUiLCJkaWRDaGFuZ2UiLCJzdWIiLCJpbmRleE9mIiwiUkNURGV2aWNlRXZlbnRFbWl0dGVyIiwiYWRkTGlzdGVuZXIiLCJiaW5kIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIlNldHRpbmdzLmlvcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZvcm1hdFxuICogQGZsb3dcbiAqL1xuXG5pbXBvcnQgUkNURGV2aWNlRXZlbnRFbWl0dGVyIGZyb20gJy4uL0V2ZW50RW1pdHRlci9SQ1REZXZpY2VFdmVudEVtaXR0ZXInO1xuaW1wb3J0IE5hdGl2ZVNldHRpbmdzTWFuYWdlciBmcm9tICcuL05hdGl2ZVNldHRpbmdzTWFuYWdlcic7XG5pbXBvcnQgaW52YXJpYW50IGZyb20gJ2ludmFyaWFudCc7XG5cbmNvbnN0IHN1YnNjcmlwdGlvbnM6IEFycmF5PHtcbiAga2V5czogQXJyYXk8c3RyaW5nPixcbiAgY2FsbGJhY2s6ID9GdW5jdGlvbixcbiAgLi4uXG59PiA9IFtdO1xuXG5jb25zdCBTZXR0aW5ncyA9IHtcbiAgX3NldHRpbmdzOiAoTmF0aXZlU2V0dGluZ3NNYW5hZ2VyICYmXG4gICAgTmF0aXZlU2V0dGluZ3NNYW5hZ2VyLmdldENvbnN0YW50cygpLnNldHRpbmdzOiBhbnkpLFxuXG4gIGdldChrZXk6IHN0cmluZyk6IG1peGVkIHtcbiAgICAvLyAkRmxvd0ZpeE1lW29iamVjdC10aGlzLXJlZmVyZW5jZV1cbiAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3Nba2V5XTtcbiAgfSxcblxuICBzZXQoc2V0dGluZ3M6IE9iamVjdCkge1xuICAgIC8vICRGbG93Rml4TWVbb2JqZWN0LXRoaXMtcmVmZXJlbmNlXVxuICAgIHRoaXMuX3NldHRpbmdzID0gT2JqZWN0LmFzc2lnbih0aGlzLl9zZXR0aW5ncywgc2V0dGluZ3MpO1xuICAgIE5hdGl2ZVNldHRpbmdzTWFuYWdlci5zZXRWYWx1ZXMoc2V0dGluZ3MpO1xuICB9LFxuXG4gIHdhdGNoS2V5cyhrZXlzOiBzdHJpbmcgfCBBcnJheTxzdHJpbmc+LCBjYWxsYmFjazogRnVuY3Rpb24pOiBudW1iZXIge1xuICAgIGlmICh0eXBlb2Yga2V5cyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGtleXMgPSBba2V5c107XG4gICAgfVxuXG4gICAgaW52YXJpYW50KFxuICAgICAgQXJyYXkuaXNBcnJheShrZXlzKSxcbiAgICAgICdrZXlzIHNob3VsZCBiZSBhIHN0cmluZyBvciBhcnJheSBvZiBzdHJpbmdzJyxcbiAgICApO1xuXG4gICAgY29uc3Qgc2lkID0gc3Vic2NyaXB0aW9ucy5sZW5ndGg7XG4gICAgc3Vic2NyaXB0aW9ucy5wdXNoKHtrZXlzOiBrZXlzLCBjYWxsYmFjazogY2FsbGJhY2t9KTtcbiAgICByZXR1cm4gc2lkO1xuICB9LFxuXG4gIGNsZWFyV2F0Y2god2F0Y2hJZDogbnVtYmVyKSB7XG4gICAgaWYgKHdhdGNoSWQgPCBzdWJzY3JpcHRpb25zLmxlbmd0aCkge1xuICAgICAgc3Vic2NyaXB0aW9uc1t3YXRjaElkXSA9IHtrZXlzOiBbXSwgY2FsbGJhY2s6IG51bGx9O1xuICAgIH1cbiAgfSxcblxuICBfc2VuZE9ic2VydmF0aW9ucyhib2R5OiBPYmplY3QpIHtcbiAgICBPYmplY3Qua2V5cyhib2R5KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBjb25zdCBuZXdWYWx1ZSA9IGJvZHlba2V5XTtcbiAgICAgIC8vICRGbG93Rml4TWVbb2JqZWN0LXRoaXMtcmVmZXJlbmNlXVxuICAgICAgY29uc3QgZGlkQ2hhbmdlID0gdGhpcy5fc2V0dGluZ3Nba2V5XSAhPT0gbmV3VmFsdWU7XG4gICAgICAvLyAkRmxvd0ZpeE1lW29iamVjdC10aGlzLXJlZmVyZW5jZV1cbiAgICAgIHRoaXMuX3NldHRpbmdzW2tleV0gPSBuZXdWYWx1ZTtcblxuICAgICAgaWYgKGRpZENoYW5nZSkge1xuICAgICAgICBzdWJzY3JpcHRpb25zLmZvckVhY2goc3ViID0+IHtcbiAgICAgICAgICBpZiAoc3ViLmtleXMuaW5kZXhPZihrZXkpICE9PSAtMSAmJiBzdWIuY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHN1Yi5jYWxsYmFjaygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG59O1xuXG5SQ1REZXZpY2VFdmVudEVtaXR0ZXIuYWRkTGlzdGVuZXIoXG4gICdzZXR0aW5nc1VwZGF0ZWQnLFxuICBTZXR0aW5ncy5fc2VuZE9ic2VydmF0aW9ucy5iaW5kKFNldHRpbmdzKSxcbik7XG5cbm1vZHVsZS5leHBvcnRzID0gU2V0dGluZ3M7XG4iXSwibWFwcGluZ3MiOiI7QUFVQSxJQUFBQSxzQkFBQSxHQUFBQyxzQkFBQSxDQUFB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