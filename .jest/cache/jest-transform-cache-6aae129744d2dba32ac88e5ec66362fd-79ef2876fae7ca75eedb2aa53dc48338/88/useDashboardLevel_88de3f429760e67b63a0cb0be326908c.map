{"version":3,"names":["_react","require","_asyncStorage","_interopRequireDefault","_constants","ACTIVE_LEVEL_KEY","useDashboardLevel","exports","_ref","_LANGUAGE_LEVELS$curr","progressData","progress","_useState","useState","_useState2","_slicedToArray2","default","currentLevel","setCurrentLevel","_useState3","_useState4","isLoaded","setIsLoaded","isInitialLoad","useRef","mapOldToNewLevel","useCallback","level","mapping","A1","A2","B1","B2","C1","C2","bonus","handleChangeActiveLevel","_ref2","_asyncToGenerator2","newLevel","LANGUAGE_LEVELS","AsyncStorage","setItem","error","console","_x","apply","arguments","useEffect","loadActiveLevel","_ref3","savedLevel","getItem","levelColor","color"],"sources":["useDashboardLevel.js"],"sourcesContent":["// src/screens/Dashboard/hooks/useDashboardLevel.js - VERSION CORRIGÃ‰E\nimport { useState, useEffect, useCallback, useRef } from \"react\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { LANGUAGE_LEVELS } from \"../../../utils/constants\";\n\nconst ACTIVE_LEVEL_KEY = \"user_active_level\";\n\nexport const useDashboardLevel = ({ progress: progressData }) => {\n  const [currentLevel, setCurrentLevel] = useState(\"1\");\n  const [isLoaded, setIsLoaded] = useState(false);\n  const isInitialLoad = useRef(true);\n\n  // âœ… CORRECTION : MÃ©moriser la fonction de mapping\n  const mapOldToNewLevel = useCallback((level) => {\n    const mapping = {\n      A1: \"1\",\n      A2: \"2\", \n      B1: \"3\",\n      B2: \"4\",\n      C1: \"5\",\n      C2: \"6\",\n      bonus: \"bonus\",\n    };\n    return mapping[level] || level;\n  }, []);\n\n  // âœ… CORRECTION : MÃ©moriser la fonction de changement de niveau\n  const handleChangeActiveLevel = useCallback(async (newLevel) => {\n    if (!LANGUAGE_LEVELS[newLevel]) return;\n\n    setCurrentLevel(newLevel);\n    try {\n      await AsyncStorage.setItem(ACTIVE_LEVEL_KEY, newLevel);\n    } catch (error) {\n      console.error('Erreur sauvegarde niveau actif:', error);\n    }\n  }, []);\n\n  // ========== ðŸš¨ CORRECTION PRINCIPALE : CHARGEMENT UNIQUE ==========\n  useEffect(() => {\n    const loadActiveLevel = async () => {\n      try {\n        const savedLevel = await AsyncStorage.getItem(ACTIVE_LEVEL_KEY);\n        \n        if (savedLevel && LANGUAGE_LEVELS[savedLevel]) {\n          setCurrentLevel(mapOldToNewLevel(savedLevel));\n        } else if (progressData?.currentLevel) {\n          setCurrentLevel(mapOldToNewLevel(progressData.currentLevel));\n        }\n        \n        setIsLoaded(true);\n      } catch (error) {\n        console.error('Erreur chargement niveau actif:', error);\n        setIsLoaded(true);\n      }\n    };\n\n    loadActiveLevel();\n  }, [progressData]);\n\n  \n\n  // âœ… CORRECTION : MÃ©moriser la couleur du niveau\n  const levelColor = LANGUAGE_LEVELS[currentLevel]?.color || \"#3B82F6\";\n\n  return {\n    currentLevel,\n    handleChangeActiveLevel,\n    levelColor,\n    isLoaded, // Exposer l'Ã©tat de chargement si nÃ©cessaire\n  };\n};"],"mappings":"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","ignoreList":[]}