{"version":3,"names":["_react","require","_asyncStorage","_interopRequireDefault","useVocabularyStorage","_ref","STORAGE_KEY","progressKey","loaded","setLoaded","completedWords","setCompletedWords","setCategoryIndex","setWordIndex","exercises","isInitialized","useEffect","loadData","_ref2","_asyncToGenerator2","default","saved","AsyncStorage","getItem","_JSON$parse","JSON","parse","savedCompleted","lastPosition","categoryIndex","wordIndex","error","apply","arguments","saveData","useCallback","dataToSave","setItem","stringify","current","newCompletedWords","Object","assign","forEach","_","index"],"sources":["useVocabularyStorage.js"],"sourcesContent":["// src/screens/exercises/vocabulary/hooks/internal/useVocabularyStorage.js\r\nimport { useEffect, useCallback } from 'react';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nexport default function useVocabularyStorage({\r\n  STORAGE_KEY,\r\n  progressKey,\r\n  loaded,\r\n  setLoaded,\r\n  completedWords,\r\n  setCompletedWords,\r\n  setCategoryIndex,\r\n  setWordIndex,\r\n  exercises,\r\n  isInitialized,\r\n}) {\r\n  // Load data from storage\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        const saved = await AsyncStorage.getItem(STORAGE_KEY);\r\n        if (saved) {\r\n          const { completedWords: savedCompleted, lastPosition } = JSON.parse(saved);\r\n          setCompletedWords(savedCompleted || {});\r\n          if (lastPosition) {\r\n            setCategoryIndex(lastPosition.categoryIndex || 0);\r\n            setWordIndex(lastPosition.wordIndex || 0);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        // Silently fail\r\n      } finally {\r\n        setLoaded(true);\r\n      }\r\n    };\r\n    loadData();\r\n  }, [progressKey, STORAGE_KEY, setCompletedWords, setCategoryIndex, setWordIndex, setLoaded]);\r\n\r\n  // Save data to storage\r\n  const saveData = useCallback(async () => {\r\n    try {\r\n      const dataToSave = {\r\n        completedWords,\r\n        lastPosition: { categoryIndex: 0, wordIndex: 0 },\r\n      };\r\n      await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));\r\n    } catch (error) {\r\n      // Silently fail\r\n    }\r\n  }, [completedWords, STORAGE_KEY]);\r\n\r\n  // Auto-save when data changes\r\n  useEffect(() => {\r\n    if (loaded) saveData();\r\n  }, [saveData, loaded]);\r\n\r\n  // Initialize progress for new categories\r\n  useEffect(() => {\r\n    if (loaded && exercises && !isInitialized.current) {\r\n      const newCompletedWords = { ...completedWords };\r\n      exercises.forEach((_, index) => {\r\n        if (!newCompletedWords[index]) newCompletedWords[index] = [];\r\n      });\r\n      setCompletedWords(newCompletedWords);\r\n      isInitialized.current = true;\r\n    }\r\n  }, [loaded, exercises, completedWords, setCompletedWords, isInitialized]);\r\n\r\n  return { saveData };\r\n}\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]}