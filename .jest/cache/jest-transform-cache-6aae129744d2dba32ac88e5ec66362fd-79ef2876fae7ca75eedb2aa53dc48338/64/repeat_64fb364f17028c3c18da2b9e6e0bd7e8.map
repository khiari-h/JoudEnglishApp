{"version":3,"names":["Object","defineProperty","exports","value","withRepeat","_util","require","_worklet_1329294093831_init_data","code","location","sourceMap","version","_worklet_2447563735451_init_data","_e","global","Error","repeatTs1","_nextAnimation","numberOfReps","arguments","length","undefined","reverse","callback","reduceMotion","defineAnimation","repeatTs2","nextAnimation","repeat","animation","now","finished","onFrame","current","reps","startValue","toValue","onStart","previousAnimation","repCallback","isHigherOrder","getReduceMotionForAnimation","__closure","__workletHash","__initData","__stackDetails"],"sources":["repeat.ts"],"sourcesContent":["'use strict';\nimport { defineAnimation, getReduceMotionForAnimation } from './util';\nimport type {\n  Animation,\n  AnimationCallback,\n  AnimatableValue,\n  Timestamp,\n  AnimationObject,\n  ReduceMotion,\n} from '../commonTypes';\nimport type { RepeatAnimation } from './commonTypes';\n\n// TODO TYPESCRIPT This is a temporary type to get rid of .d.ts file.\ntype withRepeatType = <T extends AnimatableValue>(\n  animation: T,\n  numberOfReps?: number,\n  reverse?: boolean,\n  callback?: AnimationCallback,\n  reduceMotion?: ReduceMotion\n) => T;\n\n/**\n * Lets you repeat an animation given number of times or run it indefinitely.\n *\n * @param animation - An animation object you want to repeat.\n * @param numberOfReps - The number of times the animation is going to be\n *   repeated. Defaults to 2.\n * @param reverse - Whether the animation should run in reverse every other\n *   repetition. Defaults to false.\n * @param callback - A function called on animation complete.\n * @param reduceMotion - Determines how the animation responds to the device's\n *   reduced motion accessibility setting. Default to `ReduceMotion.System` -\n *   {@link ReduceMotion}.\n * @returns An [animation\n *   object](https://docs.swmansion.com/react-native-reanimated/docs/fundamentals/glossary#animation-object)\n *   which holds the current state of the animation.\n * @see https://docs.swmansion.com/react-native-reanimated/docs/animations/withRepeat\n */\nexport const withRepeat = function <T extends AnimationObject>(\n  _nextAnimation: T | (() => T),\n  numberOfReps = 2,\n  reverse = false,\n  callback?: AnimationCallback,\n  reduceMotion?: ReduceMotion\n): Animation<RepeatAnimation> {\n  'worklet';\n\n  return defineAnimation<RepeatAnimation, T>(\n    _nextAnimation,\n    (): RepeatAnimation => {\n      'worklet';\n\n      const nextAnimation =\n        typeof _nextAnimation === 'function'\n          ? _nextAnimation()\n          : _nextAnimation;\n\n      function repeat(animation: RepeatAnimation, now: Timestamp): boolean {\n        const finished = nextAnimation.onFrame(nextAnimation, now);\n        animation.current = nextAnimation.current;\n        if (finished) {\n          animation.reps += 1;\n          // call inner animation's callback on every repetition\n          // as the second argument the animation's current value is passed\n          if (nextAnimation.callback) {\n            nextAnimation.callback(true /* finished */, animation.current);\n          }\n          if (\n            animation.reduceMotion ||\n            (numberOfReps > 0 && animation.reps >= numberOfReps)\n          ) {\n            return true;\n          }\n\n          const startValue = reverse\n            ? (nextAnimation.current as number)\n            : animation.startValue;\n          if (reverse) {\n            nextAnimation.toValue = animation.startValue;\n            animation.startValue = startValue;\n          }\n          nextAnimation.onStart(\n            nextAnimation,\n            startValue,\n            now,\n            nextAnimation.previousAnimation as RepeatAnimation\n          );\n          return false;\n        }\n        return false;\n      }\n\n      const repCallback = (finished?: boolean): void => {\n        if (callback) {\n          callback(finished);\n        }\n        // when cancelled call inner animation's callback\n        if (!finished && nextAnimation.callback) {\n          nextAnimation.callback(false /* finished */);\n        }\n      };\n\n      function onStart(\n        animation: RepeatAnimation,\n        value: AnimatableValue,\n        now: Timestamp,\n        previousAnimation: Animation<any> | null\n      ): void {\n        animation.startValue = value;\n        animation.reps = 0;\n\n        // child animations inherit the setting, unless they already have it defined\n        // they will have it defined only if the user used the `reduceMotion` prop\n        if (nextAnimation.reduceMotion === undefined) {\n          nextAnimation.reduceMotion = animation.reduceMotion;\n        }\n\n        // don't start the animation if reduced motion is enabled and\n        // the animation would end at its starting point\n        if (\n          animation.reduceMotion &&\n          reverse &&\n          (numberOfReps <= 0 || numberOfReps % 2 === 0)\n        ) {\n          animation.current = animation.startValue;\n          animation.onFrame = () => true;\n        } else {\n          nextAnimation.onStart(nextAnimation, value, now, previousAnimation);\n        }\n      }\n\n      return {\n        isHigherOrder: true,\n        onFrame: repeat,\n        onStart,\n        reps: 0,\n        current: nextAnimation.current,\n        callback: repCallback,\n        startValue: 0,\n        reduceMotion: getReduceMotionForAnimation(reduceMotion),\n      };\n    }\n  );\n} as withRepeatType;\n"],"mappings":"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","ignoreList":[]}