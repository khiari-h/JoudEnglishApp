caa03d71b9771a2e5c5b0de533459662
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = require("react");
var _reactNative = require("react-native");
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var usePhrases = function usePhrases(phrasesData, level) {
  var handleStorageError = function handleStorageError(error, operation) {
    var fallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    console.warn(`Phrases storage error in ${operation}:`, error);
    return fallback;
  };
  var STORAGE_KEY = `phrases_${level}`;
  var _useState = (0, _react.useState)(0),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    categoryIndex = _useState2[0],
    setCategoryIndex = _useState2[1];
  var _useState3 = (0, _react.useState)(0),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    phraseIndex = _useState4[0],
    setPhraseIndex = _useState4[1];
  var _useState5 = (0, _react.useState)(false),
    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),
    showTranslation = _useState6[0],
    setShowTranslation = _useState6[1];
  var _useState7 = (0, _react.useState)({}),
    _useState8 = (0, _slicedToArray2.default)(_useState7, 2),
    completedPhrases = _useState8[0],
    setCompletedPhrases = _useState8[1];
  var _useState9 = (0, _react.useState)(false),
    _useState0 = (0, _slicedToArray2.default)(_useState9, 2),
    loaded = _useState0[0],
    setLoaded = _useState0[1];
  var _useState1 = (0, _react.useState)(false),
    _useState10 = (0, _slicedToArray2.default)(_useState1, 2),
    showDetailedProgress = _useState10[0],
    setShowDetailedProgress = _useState10[1];
  var isInitialized = (0, _react.useRef)(false);
  var categories = (phrasesData == null ? void 0 : phrasesData.categories) || [];
  var currentCategory = categories[categoryIndex];
  var currentPhrases = (currentCategory == null ? void 0 : currentCategory.phrases) || [];
  var currentPhrase = currentPhrases[phraseIndex];
  var totalPhrasesInCategory = currentPhrases.length;
  var hasValidData = phrasesData && categories.length > 0 && currentPhrases.length > 0;
  (0, _react.useEffect)(function () {
    var loadData = function () {
      var _ref = (0, _asyncToGenerator2.default)(function* () {
        try {
          var savedData = yield _asyncStorage.default.getItem(STORAGE_KEY);
          if (savedData) {
            var _JSON$parse = JSON.parse(savedData),
              savedCompleted = _JSON$parse.completedPhrases,
              lastPosition = _JSON$parse.lastPosition;
            setCompletedPhrases(savedCompleted || {});
            if (lastPosition) {
              setCategoryIndex(lastPosition.categoryIndex || 0);
              setPhraseIndex(lastPosition.phraseIndex || 0);
            }
          }
        } catch (error) {
          handleStorageError(error, 'loadData');
        } finally {
          setLoaded(true);
        }
      });
      return function loadData() {
        return _ref.apply(this, arguments);
      };
    }();
    loadData();
  }, [level]);
  var saveData = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
    try {
      var dataToSave = {
        completedPhrases: completedPhrases,
        lastPosition: {
          categoryIndex: categoryIndex,
          phraseIndex: phraseIndex
        }
      };
      yield _asyncStorage.default.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
    } catch (error) {
      handleStorageError(error, 'saveData');
    }
  }), [completedPhrases, categoryIndex, phraseIndex, STORAGE_KEY]);
  (0, _react.useEffect)(function () {
    if (loaded) saveData();
  }, [saveData, loaded]);
  (0, _react.useEffect)(function () {
    if (loaded && phrasesData && !isInitialized.current) {
      var newCompletedPhrases = Object.assign({}, completedPhrases);
      categories.forEach(function (_, index) {
        if (!newCompletedPhrases[index]) {
          newCompletedPhrases[index] = [];
        }
      });
      setCompletedPhrases(newCompletedPhrases);
      isInitialized.current = true;
    }
  }, [loaded, phrasesData, categories, completedPhrases]);
  var changeCategory = (0, _react.useCallback)(function (newCategoryIndex) {
    if (newCategoryIndex !== categoryIndex && newCategoryIndex >= 0 && newCategoryIndex < categories.length) {
      setCategoryIndex(newCategoryIndex);
      setPhraseIndex(0);
      setShowTranslation(false);
    }
  }, [categoryIndex, categories.length]);
  var goToNextPhrase = (0, _react.useCallback)(function () {
    if (phraseIndex < totalPhrasesInCategory - 1) {
      setPhraseIndex(function (prev) {
        return prev + 1;
      });
      setShowTranslation(false);
    }
  }, [phraseIndex, totalPhrasesInCategory]);
  var goToPreviousPhrase = (0, _react.useCallback)(function () {
    if (phraseIndex > 0) {
      setPhraseIndex(function (prev) {
        return prev - 1;
      });
      setShowTranslation(false);
      return true;
    }
    return false;
  }, [phraseIndex]);
  var toggleTranslation = (0, _react.useCallback)(function () {
    setShowTranslation(function (prev) {
      return !prev;
    });
  }, []);
  var toggleDetailedProgress = (0, _react.useCallback)(function () {
    setShowDetailedProgress(function (prev) {
      return !prev;
    });
  }, []);
  var markPhraseAsCompleted = (0, _react.useCallback)(function (catIndex, pIndex) {
    setCompletedPhrases(function (prev) {
      var categoryCompleted = prev[catIndex] || [];
      if (!categoryCompleted.includes(pIndex)) {
        return Object.assign({}, prev, (0, _defineProperty2.default)({}, catIndex, [].concat((0, _toConsumableArray2.default)(categoryCompleted), [pIndex])));
      }
      return prev;
    });
  }, []);
  var findNextUncompletedCategory = (0, _react.useCallback)(function () {
    var numCategories = categories.length;
    var _loop = function _loop() {
        var _completedPhrases$nex;
        var nextIndex = (categoryIndex + i) % numCategories;
        var category = categories[nextIndex];
        var categoryPhrases = currentPhrases.filter(function (p) {
          return p.categoryId === category.id;
        });
        var completedInCategory = ((_completedPhrases$nex = completedPhrases[nextIndex]) == null ? void 0 : _completedPhrases$nex.length) || 0;
        if (completedInCategory < categoryPhrases.length) {
          return {
            v: nextIndex
          };
        }
      },
      _ret;
    for (var i = 1; i <= numCategories; i++) {
      _ret = _loop();
      if (_ret) return _ret.v;
    }
    return -1;
  }, [categories, categoryIndex, currentPhrases, completedPhrases]);
  var handleNext = (0, _react.useCallback)(function () {
    markPhraseAsCompleted(categoryIndex, phraseIndex);
    if (phraseIndex < totalPhrasesInCategory - 1) {
      goToNextPhrase();
    } else {
      var nextCategoryIndex = findNextUncompletedCategory();
      if (nextCategoryIndex === -1) {
        _reactNative.Alert.alert("Félicitations", "Vous avez terminé tous les exercices de phrases !");
        return {
          completed: true
        };
      } else {
        changeCategory(nextCategoryIndex);
      }
    }
    return {
      completed: false
    };
  }, [categoryIndex, phraseIndex, totalPhrasesInCategory, markPhraseAsCompleted, goToNextPhrase, findNextUncompletedCategory, changeCategory]);
  var handlePrevious = (0, _react.useCallback)(function () {
    goToPreviousPhrase();
  }, [goToPreviousPhrase]);
  var getStats = (0, _react.useCallback)(function () {
    var _completedPhrases$cat;
    var totalPhrases = currentPhrases.length;
    var completedPhrasesCount = Object.values(completedPhrases).reduce(function (sum, completed) {
      return sum + ((completed == null ? void 0 : completed.length) || 0);
    }, 0);
    var totalProgress = totalPhrases > 0 ? Math.round(completedPhrasesCount / totalPhrases * 100) : 0;
    var completionProgress = totalPhrasesInCategory > 0 ? (phraseIndex + 1) / totalPhrasesInCategory * 100 : 0;
    return {
      totalPhrases: totalPhrases,
      completedPhrasesCount: completedPhrasesCount,
      totalProgress: totalProgress,
      completionProgress: completionProgress,
      completedInCurrentCategory: ((_completedPhrases$cat = completedPhrases[categoryIndex]) == null ? void 0 : _completedPhrases$cat.length) || 0,
      totalInCurrentCategory: totalPhrasesInCategory
    };
  }, [currentPhrases, completedPhrases, totalPhrasesInCategory, phraseIndex, categoryIndex]);
  var getDisplayData = (0, _react.useCallback)(function () {
    var phraseCounter = `${phraseIndex + 1} / ${totalPhrasesInCategory || 0}`;
    var categoriesNames = categories.map(function (cat) {
      return cat.name;
    });
    return {
      phraseCounter: phraseCounter,
      categories: categoriesNames,
      currentPhrase: currentPhrase,
      currentCategory: currentCategory,
      currentPhrases: currentPhrases
    };
  }, [phraseIndex, totalPhrasesInCategory, categories, currentPhrase, currentCategory, currentPhrases]);
  var canGoToPrevious = phraseIndex > 0;
  var isLastPhraseInCategory = phraseIndex === totalPhrasesInCategory - 1;
  return {
    categoryIndex: categoryIndex,
    phraseIndex: phraseIndex,
    showTranslation: showTranslation,
    completedPhrases: completedPhrases,
    loaded: loaded,
    showDetailedProgress: showDetailedProgress,
    currentPhrase: currentPhrase,
    currentCategory: currentCategory,
    currentPhrases: currentPhrases,
    totalCategories: categories.length,
    totalPhrasesInCategory: totalPhrasesInCategory,
    hasValidData: hasValidData,
    changeCategory: changeCategory,
    toggleTranslation: toggleTranslation,
    toggleDetailedProgress: toggleDetailedProgress,
    handleNext: handleNext,
    handlePrevious: handlePrevious,
    canGoToPrevious: canGoToPrevious,
    isLastPhraseInCategory: isLastPhraseInCategory,
    stats: getStats(),
    display: getDisplayData()
  };
};
var _default = exports.default = usePhrases;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3JlYWN0TmF0aXZlIiwiX2FzeW5jU3RvcmFnZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJ1c2VQaHJhc2VzIiwicGhyYXNlc0RhdGEiLCJsZXZlbCIsImhhbmRsZVN0b3JhZ2VFcnJvciIsImVycm9yIiwib3BlcmF0aW9uIiwiZmFsbGJhY2siLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJjb25zb2xlIiwid2FybiIsIlNUT1JBR0VfS0VZIiwiX3VzZVN0YXRlIiwidXNlU3RhdGUiLCJfdXNlU3RhdGUyIiwiX3NsaWNlZFRvQXJyYXkyIiwiZGVmYXVsdCIsImNhdGVnb3J5SW5kZXgiLCJzZXRDYXRlZ29yeUluZGV4IiwiX3VzZVN0YXRlMyIsIl91c2VTdGF0ZTQiLCJwaHJhc2VJbmRleCIsInNldFBocmFzZUluZGV4IiwiX3VzZVN0YXRlNSIsIl91c2VTdGF0ZTYiLCJzaG93VHJhbnNsYXRpb24iLCJzZXRTaG93VHJhbnNsYXRpb24iLCJfdXNlU3RhdGU3IiwiX3VzZVN0YXRlOCIsImNvbXBsZXRlZFBocmFzZXMiLCJzZXRDb21wbGV0ZWRQaHJhc2VzIiwiX3VzZVN0YXRlOSIsIl91c2VTdGF0ZTAiLCJsb2FkZWQiLCJzZXRMb2FkZWQiLCJfdXNlU3RhdGUxIiwiX3VzZVN0YXRlMTAiLCJzaG93RGV0YWlsZWRQcm9ncmVzcyIsInNldFNob3dEZXRhaWxlZFByb2dyZXNzIiwiaXNJbml0aWFsaXplZCIsInVzZVJlZiIsImNhdGVnb3JpZXMiLCJjdXJyZW50Q2F0ZWdvcnkiLCJjdXJyZW50UGhyYXNlcyIsInBocmFzZXMiLCJjdXJyZW50UGhyYXNlIiwidG90YWxQaHJhc2VzSW5DYXRlZ29yeSIsImhhc1ZhbGlkRGF0YSIsInVzZUVmZmVjdCIsImxvYWREYXRhIiwiX3JlZiIsIl9hc3luY1RvR2VuZXJhdG9yMiIsInNhdmVkRGF0YSIsIkFzeW5jU3RvcmFnZSIsImdldEl0ZW0iLCJfSlNPTiRwYXJzZSIsIkpTT04iLCJwYXJzZSIsInNhdmVkQ29tcGxldGVkIiwibGFzdFBvc2l0aW9uIiwiYXBwbHkiLCJzYXZlRGF0YSIsInVzZUNhbGxiYWNrIiwiZGF0YVRvU2F2ZSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJjdXJyZW50IiwibmV3Q29tcGxldGVkUGhyYXNlcyIsIk9iamVjdCIsImFzc2lnbiIsImZvckVhY2giLCJfIiwiaW5kZXgiLCJjaGFuZ2VDYXRlZ29yeSIsIm5ld0NhdGVnb3J5SW5kZXgiLCJnb1RvTmV4dFBocmFzZSIsInByZXYiLCJnb1RvUHJldmlvdXNQaHJhc2UiLCJ0b2dnbGVUcmFuc2xhdGlvbiIsInRvZ2dsZURldGFpbGVkUHJvZ3Jlc3MiLCJtYXJrUGhyYXNlQXNDb21wbGV0ZWQiLCJjYXRJbmRleCIsInBJbmRleCIsImNhdGVnb3J5Q29tcGxldGVkIiwiaW5jbHVkZXMiLCJfZGVmaW5lUHJvcGVydHkyIiwiY29uY2F0IiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsImZpbmROZXh0VW5jb21wbGV0ZWRDYXRlZ29yeSIsIm51bUNhdGVnb3JpZXMiLCJfbG9vcCIsIl9jb21wbGV0ZWRQaHJhc2VzJG5leCIsIm5leHRJbmRleCIsImkiLCJjYXRlZ29yeSIsImNhdGVnb3J5UGhyYXNlcyIsImZpbHRlciIsInAiLCJjYXRlZ29yeUlkIiwiaWQiLCJjb21wbGV0ZWRJbkNhdGVnb3J5IiwidiIsIl9yZXQiLCJoYW5kbGVOZXh0IiwibmV4dENhdGVnb3J5SW5kZXgiLCJBbGVydCIsImFsZXJ0IiwiY29tcGxldGVkIiwiaGFuZGxlUHJldmlvdXMiLCJnZXRTdGF0cyIsIl9jb21wbGV0ZWRQaHJhc2VzJGNhdCIsInRvdGFsUGhyYXNlcyIsImNvbXBsZXRlZFBocmFzZXNDb3VudCIsInZhbHVlcyIsInJlZHVjZSIsInN1bSIsInRvdGFsUHJvZ3Jlc3MiLCJNYXRoIiwicm91bmQiLCJjb21wbGV0aW9uUHJvZ3Jlc3MiLCJjb21wbGV0ZWRJbkN1cnJlbnRDYXRlZ29yeSIsInRvdGFsSW5DdXJyZW50Q2F0ZWdvcnkiLCJnZXREaXNwbGF5RGF0YSIsInBocmFzZUNvdW50ZXIiLCJjYXRlZ29yaWVzTmFtZXMiLCJtYXAiLCJjYXQiLCJuYW1lIiwiY2FuR29Ub1ByZXZpb3VzIiwiaXNMYXN0UGhyYXNlSW5DYXRlZ29yeSIsInRvdGFsQ2F0ZWdvcmllcyIsInN0YXRzIiwiZGlzcGxheSIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInVzZVBocmFzZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3NjcmVlbnMvZXhlcmNpc2VzL3BocmFzZXMvaG9va3MvdXNlUGhyYXNlcy5qcyAtIFZFUlNJT04gQ09SUklHw4lFXG5cbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZVJlZiwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBBbGVydCB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5pbXBvcnQgQXN5bmNTdG9yYWdlIGZyb20gJ0ByZWFjdC1uYXRpdmUtYXN5bmMtc3RvcmFnZS9hc3luYy1zdG9yYWdlJztcblxuLyoqXG4gKiDwn46vIEhvb2sgdW5pZmnDqSBwb3VyIFBocmFzZXMgRXhlcmNpc2VcbiAqIFJlbXBsYWNlIHVzZVBocmFzZXNFeGVyY2lzZVN0YXRlICsgdXNlUGhyYXNlc1Byb2dyZXNzICsgdXNlUGhyYXNlc0Rpc3BsYXlcbiAqIFNpbXBsZSwgZWZmaWNhY2UsIG1haW50ZW5hYmxlIC0gcGF0dGVybiBpZGVudGlxdWUgw6AgdXNlUmVhZGluZywgdXNlR3JhbW1hciBldCB1c2VWb2NhYnVsYXJ5XG4gKi9cbmNvbnN0IHVzZVBocmFzZXMgPSAocGhyYXNlc0RhdGEsIGxldmVsKSA9PiB7XG4gIC8vID09PT09PT09PT09PT09PT09PT0gRVJST1IgSEFORExJTkcgSEVMUEVSID09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgaGFuZGxlU3RvcmFnZUVycm9yID0gKGVycm9yLCBvcGVyYXRpb24sIGZhbGxiYWNrID0gbnVsbCkgPT4ge1xuICAgIGNvbnNvbGUud2FybihgUGhyYXNlcyBzdG9yYWdlIGVycm9yIGluICR7b3BlcmF0aW9ufTpgLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbGxiYWNrO1xuICB9O1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT0gU1RPUkFHRSBLRVkgPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBTVE9SQUdFX0tFWSA9IGBwaHJhc2VzXyR7bGV2ZWx9YDtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09IFNUQVRFID09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgW2NhdGVnb3J5SW5kZXgsIHNldENhdGVnb3J5SW5kZXhdID0gdXNlU3RhdGUoMCk7XG4gIGNvbnN0IFtwaHJhc2VJbmRleCwgc2V0UGhyYXNlSW5kZXhdID0gdXNlU3RhdGUoMCk7XG4gIGNvbnN0IFtzaG93VHJhbnNsYXRpb24sIHNldFNob3dUcmFuc2xhdGlvbl0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtjb21wbGV0ZWRQaHJhc2VzLCBzZXRDb21wbGV0ZWRQaHJhc2VzXSA9IHVzZVN0YXRlKHt9KTtcbiAgY29uc3QgW2xvYWRlZCwgc2V0TG9hZGVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3Nob3dEZXRhaWxlZFByb2dyZXNzLCBzZXRTaG93RGV0YWlsZWRQcm9ncmVzc10gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgY29uc3QgaXNJbml0aWFsaXplZCA9IHVzZVJlZihmYWxzZSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PSBDT01QVVRFRCBWQUxVRVMgPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBjYXRlZ29yaWVzID0gcGhyYXNlc0RhdGE/LmNhdGVnb3JpZXMgfHwgW107XG4gIGNvbnN0IGN1cnJlbnRDYXRlZ29yeSA9IGNhdGVnb3JpZXNbY2F0ZWdvcnlJbmRleF07XG4gIGNvbnN0IGN1cnJlbnRQaHJhc2VzID0gY3VycmVudENhdGVnb3J5Py5waHJhc2VzIHx8IFtdO1xuICBjb25zdCBjdXJyZW50UGhyYXNlID0gY3VycmVudFBocmFzZXNbcGhyYXNlSW5kZXhdO1xuICBjb25zdCB0b3RhbFBocmFzZXNJbkNhdGVnb3J5ID0gY3VycmVudFBocmFzZXMubGVuZ3RoO1xuICBjb25zdCBoYXNWYWxpZERhdGEgPSBwaHJhc2VzRGF0YSAmJiBjYXRlZ29yaWVzLmxlbmd0aCA+IDAgJiYgY3VycmVudFBocmFzZXMubGVuZ3RoID4gMDtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09IERBVEEgTE9BRElORyA9PT09PT09PT09PT09PT09PT09XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgbG9hZERhdGEgPSBhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShTVE9SQUdFX0tFWSk7XG4gICAgICAgIGlmIChzYXZlZERhdGEpIHtcbiAgICAgICAgICBjb25zdCB7IGNvbXBsZXRlZFBocmFzZXM6IHNhdmVkQ29tcGxldGVkLCBsYXN0UG9zaXRpb24gfSA9IEpTT04ucGFyc2Uoc2F2ZWREYXRhKTtcbiAgICAgICAgICBzZXRDb21wbGV0ZWRQaHJhc2VzKHNhdmVkQ29tcGxldGVkIHx8IHt9KTtcbiAgICAgICAgICBpZiAobGFzdFBvc2l0aW9uKSB7XG4gICAgICAgICAgICBzZXRDYXRlZ29yeUluZGV4KGxhc3RQb3NpdGlvbi5jYXRlZ29yeUluZGV4IHx8IDApO1xuICAgICAgICAgICAgc2V0UGhyYXNlSW5kZXgobGFzdFBvc2l0aW9uLnBocmFzZUluZGV4IHx8IDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8g4pyFIEdlc3Rpb24gZCdlcnJldXIgYXBwcm9wcmnDqWVcbiAgICAgICAgaGFuZGxlU3RvcmFnZUVycm9yKGVycm9yLCAnbG9hZERhdGEnKTtcbiAgICAgICAgLy8gRmFsbGJhY2s6IHV0aWxpc2VyIGxlcyB2YWxldXJzIHBhciBkw6lmYXV0XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBzZXRMb2FkZWQodHJ1ZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBsb2FkRGF0YSgpO1xuICB9LCBbbGV2ZWxdKTtcblxuICAvLyBTYXZlIGRhdGEgdG8gc3RvcmFnZVxuICBjb25zdCBzYXZlRGF0YSA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0YVRvU2F2ZSA9IHtcbiAgICAgICAgY29tcGxldGVkUGhyYXNlcyxcbiAgICAgICAgbGFzdFBvc2l0aW9uOiB7XG4gICAgICAgICAgY2F0ZWdvcnlJbmRleCxcbiAgICAgICAgICBwaHJhc2VJbmRleFxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnNldEl0ZW0oU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KGRhdGFUb1NhdmUpKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8g4pyFIEdlc3Rpb24gZCdlcnJldXIgYXBwcm9wcmnDqWVcbiAgICAgIGhhbmRsZVN0b3JhZ2VFcnJvcihlcnJvciwgJ3NhdmVEYXRhJyk7XG4gICAgICAvLyBGYWxsYmFjazogY29udGludWVyIHNhbnMgc2F1dmVnYXJkZVxuICAgIH1cbiAgfSwgW2NvbXBsZXRlZFBocmFzZXMsIGNhdGVnb3J5SW5kZXgsIHBocmFzZUluZGV4LCBTVE9SQUdFX0tFWV0pO1xuXG4gIC8vIEF1dG8tc2F2ZSB3aGVuIGRhdGEgY2hhbmdlc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChsb2FkZWQpIHNhdmVEYXRhKCk7XG4gIH0sIFtzYXZlRGF0YSwgbG9hZGVkXSk7XG5cbiAgLy8gSW5pdGlhbGl6ZSBwcm9ncmVzcyBmb3IgbmV3IGNhdGVnb3JpZXNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAobG9hZGVkICYmIHBocmFzZXNEYXRhICYmICFpc0luaXRpYWxpemVkLmN1cnJlbnQpIHtcbiAgICAgIGNvbnN0IG5ld0NvbXBsZXRlZFBocmFzZXMgPSB7IC4uLmNvbXBsZXRlZFBocmFzZXMgfTtcbiAgICAgIGNhdGVnb3JpZXMuZm9yRWFjaCgoXywgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKCFuZXdDb21wbGV0ZWRQaHJhc2VzW2luZGV4XSkge1xuICAgICAgICAgIG5ld0NvbXBsZXRlZFBocmFzZXNbaW5kZXhdID0gW107XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgc2V0Q29tcGxldGVkUGhyYXNlcyhuZXdDb21wbGV0ZWRQaHJhc2VzKTtcbiAgICAgIGlzSW5pdGlhbGl6ZWQuY3VycmVudCA9IHRydWU7XG4gICAgfVxuICB9LCBbbG9hZGVkLCBwaHJhc2VzRGF0YSwgY2F0ZWdvcmllcywgY29tcGxldGVkUGhyYXNlc10pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT0gTkFWSUdBVElPTiBBQ1RJT05TID09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgY2hhbmdlQ2F0ZWdvcnkgPSB1c2VDYWxsYmFjaygobmV3Q2F0ZWdvcnlJbmRleCkgPT4ge1xuICAgIGlmIChuZXdDYXRlZ29yeUluZGV4ICE9PSBjYXRlZ29yeUluZGV4ICYmIG5ld0NhdGVnb3J5SW5kZXggPj0gMCAmJiBuZXdDYXRlZ29yeUluZGV4IDwgY2F0ZWdvcmllcy5sZW5ndGgpIHtcbiAgICAgIHNldENhdGVnb3J5SW5kZXgobmV3Q2F0ZWdvcnlJbmRleCk7XG4gICAgICBzZXRQaHJhc2VJbmRleCgwKTtcbiAgICAgIHNldFNob3dUcmFuc2xhdGlvbihmYWxzZSk7XG4gICAgfVxuICB9LCBbY2F0ZWdvcnlJbmRleCwgY2F0ZWdvcmllcy5sZW5ndGhdKTtcblxuICBjb25zdCBnb1RvTmV4dFBocmFzZSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAocGhyYXNlSW5kZXggPCB0b3RhbFBocmFzZXNJbkNhdGVnb3J5IC0gMSkge1xuICAgICAgc2V0UGhyYXNlSW5kZXgocHJldiA9PiBwcmV2ICsgMSk7XG4gICAgICBzZXRTaG93VHJhbnNsYXRpb24oZmFsc2UpO1xuICAgIH1cbiAgfSwgW3BocmFzZUluZGV4LCB0b3RhbFBocmFzZXNJbkNhdGVnb3J5XSk7XG5cbiAgY29uc3QgZ29Ub1ByZXZpb3VzUGhyYXNlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmIChwaHJhc2VJbmRleCA+IDApIHtcbiAgICAgIHNldFBocmFzZUluZGV4KHByZXYgPT4gcHJldiAtIDEpO1xuICAgICAgc2V0U2hvd1RyYW5zbGF0aW9uKGZhbHNlKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sIFtwaHJhc2VJbmRleF0pO1xuXG4gIGNvbnN0IHRvZ2dsZVRyYW5zbGF0aW9uID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHNldFNob3dUcmFuc2xhdGlvbihwcmV2ID0+ICFwcmV2KTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IHRvZ2dsZURldGFpbGVkUHJvZ3Jlc3MgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgc2V0U2hvd0RldGFpbGVkUHJvZ3Jlc3MocHJldiA9PiAhcHJldik7XG4gIH0sIFtdKTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09IENPTVBMRVRJT04gTE9HSUMgPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBtYXJrUGhyYXNlQXNDb21wbGV0ZWQgPSB1c2VDYWxsYmFjaygoY2F0SW5kZXgsIHBJbmRleCkgPT4ge1xuICAgIHNldENvbXBsZXRlZFBocmFzZXMocHJldiA9PiB7XG4gICAgICBjb25zdCBjYXRlZ29yeUNvbXBsZXRlZCA9IHByZXZbY2F0SW5kZXhdIHx8IFtdO1xuICAgICAgaWYgKCFjYXRlZ29yeUNvbXBsZXRlZC5pbmNsdWRlcyhwSW5kZXgpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucHJldixcbiAgICAgICAgICBbY2F0SW5kZXhdOiBbLi4uY2F0ZWdvcnlDb21wbGV0ZWQsIHBJbmRleF1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwcmV2O1xuICAgIH0pO1xuICB9LCBbXSk7XG5cbiAgLy8gRmluZCBuZXh0IHVuY29tcGxldGVkIGNhdGVnb3J5XG4gIGNvbnN0IGZpbmROZXh0VW5jb21wbGV0ZWRDYXRlZ29yeSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBjb25zdCBudW1DYXRlZ29yaWVzID0gY2F0ZWdvcmllcy5sZW5ndGg7XG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbnVtQ2F0ZWdvcmllczsgaSsrKSB7XG4gICAgICBjb25zdCBuZXh0SW5kZXggPSAoY2F0ZWdvcnlJbmRleCArIGkpICUgbnVtQ2F0ZWdvcmllcztcbiAgICAgIGNvbnN0IGNhdGVnb3J5ID0gY2F0ZWdvcmllc1tuZXh0SW5kZXhdO1xuICAgICAgY29uc3QgY2F0ZWdvcnlQaHJhc2VzID0gY3VycmVudFBocmFzZXMuZmlsdGVyKHAgPT4gcC5jYXRlZ29yeUlkID09PSBjYXRlZ29yeS5pZCk7XG4gICAgICBjb25zdCBjb21wbGV0ZWRJbkNhdGVnb3J5ID0gY29tcGxldGVkUGhyYXNlc1tuZXh0SW5kZXhdPy5sZW5ndGggfHwgMDtcbiAgICAgIFxuICAgICAgaWYgKGNvbXBsZXRlZEluQ2F0ZWdvcnkgPCBjYXRlZ29yeVBocmFzZXMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBuZXh0SW5kZXg7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfSwgW2NhdGVnb3JpZXMsIGNhdGVnb3J5SW5kZXgsIGN1cnJlbnRQaHJhc2VzLCBjb21wbGV0ZWRQaHJhc2VzXSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PSBNQUlOIE5BVklHQVRJT04gPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBoYW5kbGVOZXh0ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIC8vIE1hcmsgY3VycmVudCBwaHJhc2UgYXMgY29tcGxldGVkXG4gICAgbWFya1BocmFzZUFzQ29tcGxldGVkKGNhdGVnb3J5SW5kZXgsIHBocmFzZUluZGV4KTtcblxuICAgIC8vIENoZWNrIGlmIHRoZXJlIGFyZSBtb3JlIHBocmFzZXMgaW4gY3VycmVudCBjYXRlZ29yeVxuICAgIGlmIChwaHJhc2VJbmRleCA8IHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnkgLSAxKSB7XG4gICAgICBnb1RvTmV4dFBocmFzZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBFbmQgb2YgY2F0ZWdvcnkgLSBmaW5kIG5leHQgdW5jb21wbGV0ZWQgY2F0ZWdvcnlcbiAgICAgIGNvbnN0IG5leHRDYXRlZ29yeUluZGV4ID0gZmluZE5leHRVbmNvbXBsZXRlZENhdGVnb3J5KCk7XG4gICAgICBpZiAobmV4dENhdGVnb3J5SW5kZXggPT09IC0xKSB7XG4gICAgICAgIC8vIEFsbCBkb25lIVxuICAgICAgICBBbGVydC5hbGVydChcbiAgICAgICAgICBcIkbDqWxpY2l0YXRpb25zXCIsXG4gICAgICAgICAgXCJWb3VzIGF2ZXogdGVybWluw6kgdG91cyBsZXMgZXhlcmNpY2VzIGRlIHBocmFzZXMgIVwiXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB7IGNvbXBsZXRlZDogdHJ1ZSB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hhbmdlQ2F0ZWdvcnkobmV4dENhdGVnb3J5SW5kZXgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyBjb21wbGV0ZWQ6IGZhbHNlIH07XG4gIH0sIFtjYXRlZ29yeUluZGV4LCBwaHJhc2VJbmRleCwgdG90YWxQaHJhc2VzSW5DYXRlZ29yeSwgbWFya1BocmFzZUFzQ29tcGxldGVkLCBnb1RvTmV4dFBocmFzZSwgZmluZE5leHRVbmNvbXBsZXRlZENhdGVnb3J5LCBjaGFuZ2VDYXRlZ29yeV0pO1xuXG4gIGNvbnN0IGhhbmRsZVByZXZpb3VzID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGdvVG9QcmV2aW91c1BocmFzZSgpO1xuICB9LCBbZ29Ub1ByZXZpb3VzUGhyYXNlXSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PSBDT01QVVRFRCBTVEFUUyA9PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGdldFN0YXRzID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IHRvdGFsUGhyYXNlcyA9IGN1cnJlbnRQaHJhc2VzLmxlbmd0aDtcbiAgICBjb25zdCBjb21wbGV0ZWRQaHJhc2VzQ291bnQgPSBPYmplY3QudmFsdWVzKGNvbXBsZXRlZFBocmFzZXMpLnJlZHVjZSgoc3VtLCBjb21wbGV0ZWQpID0+IHN1bSArIChjb21wbGV0ZWQ/Lmxlbmd0aCB8fCAwKSwgMCk7XG4gICAgY29uc3QgdG90YWxQcm9ncmVzcyA9IHRvdGFsUGhyYXNlcyA+IDAgPyBNYXRoLnJvdW5kKChjb21wbGV0ZWRQaHJhc2VzQ291bnQgLyB0b3RhbFBocmFzZXMpICogMTAwKSA6IDA7XG4gICAgY29uc3QgY29tcGxldGlvblByb2dyZXNzID0gdG90YWxQaHJhc2VzSW5DYXRlZ29yeSA+IDAgPyAoKHBocmFzZUluZGV4ICsgMSkgLyB0b3RhbFBocmFzZXNJbkNhdGVnb3J5KSAqIDEwMCA6IDA7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxQaHJhc2VzLFxuICAgICAgY29tcGxldGVkUGhyYXNlc0NvdW50LFxuICAgICAgdG90YWxQcm9ncmVzcyxcbiAgICAgIGNvbXBsZXRpb25Qcm9ncmVzcyxcbiAgICAgIGNvbXBsZXRlZEluQ3VycmVudENhdGVnb3J5OiBjb21wbGV0ZWRQaHJhc2VzW2NhdGVnb3J5SW5kZXhdPy5sZW5ndGggfHwgMCxcbiAgICAgIHRvdGFsSW5DdXJyZW50Q2F0ZWdvcnk6IHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnlcbiAgICB9O1xuICB9LCBbY3VycmVudFBocmFzZXMsIGNvbXBsZXRlZFBocmFzZXMsIHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnksIHBocmFzZUluZGV4LCBjYXRlZ29yeUluZGV4XSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PSBDT01QVVRFRCBESVNQTEFZID09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgZ2V0RGlzcGxheURhdGEgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgY29uc3QgcGhyYXNlQ291bnRlciA9IGAke3BocmFzZUluZGV4ICsgMX0gLyAke3RvdGFsUGhyYXNlc0luQ2F0ZWdvcnkgfHwgMH1gO1xuICAgIGNvbnN0IGNhdGVnb3JpZXNOYW1lcyA9IGNhdGVnb3JpZXMubWFwKGNhdCA9PiBjYXQubmFtZSk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHBocmFzZUNvdW50ZXIsXG4gICAgICBjYXRlZ29yaWVzOiBjYXRlZ29yaWVzTmFtZXMsXG4gICAgICBjdXJyZW50UGhyYXNlLFxuICAgICAgY3VycmVudENhdGVnb3J5LFxuICAgICAgY3VycmVudFBocmFzZXNcbiAgICB9O1xuICB9LCBbcGhyYXNlSW5kZXgsIHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnksIGNhdGVnb3JpZXMsIGN1cnJlbnRQaHJhc2UsIGN1cnJlbnRDYXRlZ29yeSwgY3VycmVudFBocmFzZXNdKTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09IFZBTElEQVRJT04gPT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBjYW5Hb1RvUHJldmlvdXMgPSBwaHJhc2VJbmRleCA+IDA7XG4gIGNvbnN0IGlzTGFzdFBocmFzZUluQ2F0ZWdvcnkgPSBwaHJhc2VJbmRleCA9PT0gdG90YWxQaHJhc2VzSW5DYXRlZ29yeSAtIDE7XG5cbiAgcmV0dXJuIHtcbiAgICAvLyBTdGF0ZVxuICAgIGNhdGVnb3J5SW5kZXgsXG4gICAgcGhyYXNlSW5kZXgsXG4gICAgc2hvd1RyYW5zbGF0aW9uLFxuICAgIGNvbXBsZXRlZFBocmFzZXMsXG4gICAgbG9hZGVkLFxuICAgIHNob3dEZXRhaWxlZFByb2dyZXNzLFxuICAgIFxuICAgIC8vIERhdGFcbiAgICBjdXJyZW50UGhyYXNlLFxuICAgIGN1cnJlbnRDYXRlZ29yeSxcbiAgICBjdXJyZW50UGhyYXNlcyxcbiAgICB0b3RhbENhdGVnb3JpZXM6IGNhdGVnb3JpZXMubGVuZ3RoLFxuICAgIHRvdGFsUGhyYXNlc0luQ2F0ZWdvcnksXG4gICAgaGFzVmFsaWREYXRhLFxuICAgIFxuICAgIC8vIEFjdGlvbnNcbiAgICBjaGFuZ2VDYXRlZ29yeSxcbiAgICB0b2dnbGVUcmFuc2xhdGlvbixcbiAgICB0b2dnbGVEZXRhaWxlZFByb2dyZXNzLFxuICAgIGhhbmRsZU5leHQsXG4gICAgaGFuZGxlUHJldmlvdXMsXG4gICAgXG4gICAgLy8gQ29tcHV0ZWRcbiAgICBjYW5Hb1RvUHJldmlvdXMsXG4gICAgaXNMYXN0UGhyYXNlSW5DYXRlZ29yeSxcbiAgICBzdGF0czogZ2V0U3RhdHMoKSxcbiAgICBkaXNwbGF5OiBnZXREaXNwbGF5RGF0YSgpLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgdXNlUGhyYXNlczsiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUVBLElBQUFBLE1BQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLFlBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLGFBQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQU9BLElBQU1JLFVBQVUsR0FBRyxTQUFiQSxVQUFVQSxDQUFJQyxXQUFXLEVBQUVDLEtBQUssRUFBSztFQUV6QyxJQUFNQyxrQkFBa0IsR0FBRyxTQUFyQkEsa0JBQWtCQSxDQUFJQyxLQUFLLEVBQUVDLFNBQVMsRUFBc0I7SUFBQSxJQUFwQkMsUUFBUSxHQUFBQyxTQUFBLENBQUFDLE1BQUEsUUFBQUQsU0FBQSxRQUFBRSxTQUFBLEdBQUFGLFNBQUEsTUFBRyxJQUFJO0lBQzNERyxPQUFPLENBQUNDLElBQUksQ0FBQyw0QkFBNEJOLFNBQVMsR0FBRyxFQUFFRCxLQUFLLENBQUM7SUFDN0QsT0FBT0UsUUFBUTtFQUNqQixDQUFDO0VBR0QsSUFBTU0sV0FBVyxHQUFHLFdBQVdWLEtBQUssRUFBRTtFQUd0QyxJQUFBVyxTQUFBLEdBQTBDLElBQUFDLGVBQVEsRUFBQyxDQUFDLENBQUM7SUFBQUMsVUFBQSxPQUFBQyxlQUFBLENBQUFDLE9BQUEsRUFBQUosU0FB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