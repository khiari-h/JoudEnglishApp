{"version":3,"names":["_react","require","useEvent","eventEmitter","eventName","initialValue","arguments","length","undefined","_useState","useState","_useState2","_slicedToArray2","default","event","setEvent","listener","useEventListener","listenerRef","useRef","current","useEffect","callback","apply","subscription","addListener","remove"],"sources":["useEvent.ts"],"sourcesContent":["import type { EventEmitter } from 'expo-modules-core/types';\nimport { useEffect, useRef, useState } from 'react';\n\ntype AnyEventListener = (...args: any[]) => any;\n\n/**\n * Type helper that infers the event name from the emitter's events map.\n */\ntype InferEventName<TEventsMap> =\n  TEventsMap extends Record<infer TEventName extends keyof TEventsMap, AnyEventListener>\n    ? TEventName\n    : never;\n\n/**\n * Type helper that infers the event listener from the emitter's events map.\n */\ntype InferEventListener<TEventsMap, TEventName extends keyof TEventsMap> =\n  TEventsMap extends Record<TEventName, infer TEventListener extends AnyEventListener>\n    ? TEventListener\n    : never;\n\n/**\n * Type helper that infers the first parameter of the event listener.\n */\ntype InferEventParameter<\n  TEventListener extends AnyEventListener,\n  TInitialValue,\n> = TInitialValue extends Parameters<TEventListener>[0]\n  ? Parameters<TEventListener>[0]\n  : Parameters<TEventListener>[0] | TInitialValue | null;\n\n/**\n * React hook that listens to events emitted by the given object. The returned value is an event parameter\n * that gets updated whenever a new event is dispatched.\n * @param eventEmitter An object that emits events. For example, a native module or shared object or an instance of [`EventEmitter`](#eventemitter).\n * @param eventName Name of the event to listen to.\n * @param initialValue An event parameter to use until the event is called for the first time.\n * @returns A parameter of the event listener.\n * @example\n * ```tsx\n * import { useEvent } from 'expo';\n * import { VideoPlayer } from 'expo-video';\n *\n * export function PlayerStatus({ videoPlayer }: { videoPlayer: VideoPlayer }) {\n *   const { status } = useEvent(videoPlayer, 'statusChange', { status: videoPlayer.status });\n *\n *   return <Text>{`Player status: ${status}`}</Text>;\n * }\n * ```\n */\nexport function useEvent<\n  TEventsMap extends Record<string, AnyEventListener>,\n  TEventName extends InferEventName<TEventsMap>,\n  TEventListener extends InferEventListener<TEventsMap, TEventName>,\n  TInitialValue extends Parameters<TEventListener>[0] | null,\n>(\n  eventEmitter: EventEmitter<TEventsMap>,\n  eventName: TEventName,\n  initialValue: TInitialValue | null = null\n): InferEventParameter<TEventListener, TInitialValue> {\n  const [event, setEvent] = useState<Parameters<TEventListener>[0] | TInitialValue | null>(\n    initialValue\n  );\n  const listener = (event: Parameters<TEventListener>[0]) => setEvent(event);\n\n  useEventListener(eventEmitter, eventName, listener as InferEventListener<TEventsMap, TEventName>);\n\n  return event as InferEventParameter<TEventListener, TInitialValue>;\n}\n\n/**\n * React hook that listens to events emitted by the given object and calls the listener function whenever a new event is dispatched.\n * The event listener is automatically added during the first render and removed when the component unmounts.\n * @param eventEmitter An object that emits events. For example, a native module or shared object or an instance of [`EventEmitter`](#eventemitter).\n * @param eventName Name of the event to listen to.\n * @param listener A function to call when the event is dispatched.\n * @example\n * ```tsx\n * import { useEventListener } from 'expo';\n * import { useVideoPlayer, VideoView } from 'expo-video';\n *\n * export function VideoPlayerView() {\n *   const player = useVideoPlayer(videoSource);\n *\n *   useEventListener(player, 'playingChange', ({ isPlaying }) => {\n *     console.log('Player is playing:', isPlaying);\n *   });\n *\n *   return <VideoView player={player} />;\n * }\n * ```\n */\nexport function useEventListener<\n  TEventsMap extends Record<string, AnyEventListener>,\n  TEventName extends InferEventName<TEventsMap>,\n  TEventListener extends InferEventListener<TEventsMap, TEventName>,\n>(eventEmitter: EventEmitter<TEventsMap>, eventName: TEventName, listener: TEventListener): void {\n  // Always use the most recent version of the listener inside the effect,\n  // without memoization so the listeners don't have to be swapped with every render.\n  const listenerRef = useRef<TEventListener>(listener);\n  listenerRef.current = listener;\n\n  useEffect(() => {\n    const callback = (...args: any[]) => listenerRef.current(...args);\n    const subscription = eventEmitter.addListener<TEventName>(\n      eventName,\n      callback as TEventsMap[TEventName]\n    );\n\n    return () => subscription.remove();\n  }, [eventEmitter, eventName, listenerRef]);\n}\n"],"mappings":";;;;;;;AACA,IAAAA,MAAA,GAAAC,OAAA;AAiDO,SAASC,QAAQA,CAMtBC,YAAsC,EACtCC,SAAqB,EAE+B;EAAA,IADpDC,YAAkC,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;EAEzC,IAAAG,SAAA,GAA0B,IAAAC,eAAQ,EAChCL,YACF,CAAC;IAAAM,UAAA,OAAAC,eAAA,CAAAC,OAAA,EAAAJ,SAAA;IAFMK,KAAK,GAAAH,UAAA;IAAEI,QAAQ,GAAAJ,UAAA;EAGtB,IAAMK,QAAQ,GAAG,SAAXA,QAAQA,CAAIF,KAAoC;IAAA,OAAKC,QAAQ,CAACD,KAAK,CAAC;EAAA;EAE1EG,gBAAgB,CAACd,YAAY,EAAEC,SAAS,EAAEY,QAAsD,CAAC;EAEjG,OAAOF,KAAK;AACd;AAwBO,SAASG,gBAAgBA,CAI9Bd,YAAsC,EAAEC,SAAqB,EAAEY,QAAwB,EAAQ;EAG/F,IAAME,WAAW,GAAG,IAAAC,aAAM,EAAiBH,QAAQ,CAAC;EACpDE,WAAW,CAACE,OAAO,GAAGJ,QAAQ;EAE9B,IAAAK,gBAAS,EAAC,YAAM;IACd,IAAMC,QAAQ,GAAG,SAAXA,QAAQA,CAAA;MAAA,OAAuBJ,WAAW,CAACE,OAAO,CAAAG,KAAA,CAAnBL,WAAW,EAAAZ,SAAgB,CAAC;IAAA;IACjE,IAAMkB,YAAY,GAAGrB,YAAY,CAACsB,WAAW,CAC3CrB,SAAS,EACTkB,QACF,CAAC;IAED,OAAO;MAAA,OAAME,YAAY,CAACE,MAAM,CAAC,CAAC;IAAA;EACpC,CAAC,EAAE,CAACvB,YAAY,EAAEC,SAAS,EAAEc,WAAW,CAAC,CAAC;AAC5C","ignoreList":[]}