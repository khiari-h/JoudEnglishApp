70b38ca09742a4da6449aea5c33afe20
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.storeData = exports.storageService = exports.resetStorage = exports.removeFromStorage = exports.removeData = exports.readFromStorage = exports.isStorageAvailable = exports.getStorageInfo = exports.getMultipleData = exports.getData = exports.clearAllData = void 0;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var _timeConstants = require("./timeConstants.js");
var _timeUtils = require("./timeUtils.js");
var isStorageAvailable = exports.isStorageAvailable = function () {
  var _ref = (0, _asyncToGenerator2.default)(function* () {
    try {
      var test = '__storage_test__';
      yield _asyncStorage.default.setItem(test, test);
      yield _asyncStorage.default.removeItem(test);
      return true;
    } catch (e) {
      console.warn('AsyncStorage not available:', e.message);
      return false;
    }
  });
  return function isStorageAvailable() {
    return _ref.apply(this, arguments);
  };
}();
var storeData = exports.storeData = function () {
  var _ref2 = (0, _asyncToGenerator2.default)(function* (key, value) {
    try {
      if (value === undefined || value === null) {
        yield _asyncStorage.default.removeItem(key);
        return true;
      }
      var jsonValue = JSON.stringify(value);
      yield _asyncStorage.default.setItem(key, jsonValue);
      return true;
    } catch (error) {
      console.error('Error storing data:', error);
      return false;
    }
  });
  return function storeData(_x, _x2) {
    return _ref2.apply(this, arguments);
  };
}();
var getData = exports.getData = function () {
  var _ref3 = (0, _asyncToGenerator2.default)(function* (key) {
    try {
      var jsonValue = yield _asyncStorage.default.getItem(key);
      return jsonValue != null ? JSON.parse(jsonValue) : null;
    } catch (error) {
      console.error('Error getting data:', error);
      return null;
    }
  });
  return function getData(_x3) {
    return _ref3.apply(this, arguments);
  };
}();
var removeData = exports.removeData = function () {
  var _ref4 = (0, _asyncToGenerator2.default)(function* (key) {
    try {
      yield _asyncStorage.default.removeItem(key);
      return true;
    } catch (error) {
      console.error('Error removing data:', error);
      return false;
    }
  });
  return function removeData(_x4) {
    return _ref4.apply(this, arguments);
  };
}();
var getMultipleData = exports.getMultipleData = function () {
  var _ref5 = (0, _asyncToGenerator2.default)(function* (keys) {
    try {
      var items = yield _asyncStorage.default.multiGet(keys);
      return items.reduce(function (result, _ref6) {
        var _ref7 = (0, _slicedToArray2.default)(_ref6, 2),
          key = _ref7[0],
          value = _ref7[1];
        result[key] = value != null ? JSON.parse(value) : null;
        return result;
      }, {});
    } catch (error) {
      console.error('Error getting multiple data:', error);
      return {};
    }
  });
  return function getMultipleData(_x5) {
    return _ref5.apply(this, arguments);
  };
}();
var clearAllData = exports.clearAllData = function () {
  var _ref8 = (0, _asyncToGenerator2.default)(function* () {
    try {
      yield _asyncStorage.default.clear();
      return true;
    } catch (error) {
      console.error('Error clearing all data:', error);
      return false;
    }
  });
  return function clearAllData() {
    return _ref8.apply(this, arguments);
  };
}();
var validateStorageStructure = function validateStorageStructure(data) {
  if (!data || typeof data !== 'object') return false;
  var hasVersion = typeof data.version === 'string';
  var hasData = typeof data.data === 'object' && data.data !== null;
  var hasTimestamp = typeof data.lastModified === 'number';
  return hasVersion && hasData && hasTimestamp;
};
var migrateOldData = function migrateOldData(oldData) {
  if (validateStorageStructure(oldData)) {
    return oldData;
  }
  var migratedData = Object.assign({}, _timeConstants.DEFAULT_STATS);
  if (oldData && typeof oldData === 'object') {
    if (oldData.vocabulary_classic || oldData.vocabulary_fast) {
      var classicTime = oldData.vocabulary_classic || 0;
      var fastTime = oldData.vocabulary_fast || 0;
      migratedData.vocabulary = classicTime + fastTime;
    }
    Object.keys(_timeConstants.DEFAULT_STATS).forEach(function (exerciseType) {
      if (exerciseType !== 'vocabulary' && oldData[exerciseType]) {
        migratedData[exerciseType] = oldData[exerciseType];
      }
    });
  }
  return {
    version: _timeConstants.STORAGE_CONFIG.VERSION,
    data: (0, _timeUtils.sanitizeTimeStats)(migratedData),
    lastModified: Date.now()
  };
};
var writeToStorage = function () {
  var _ref9 = (0, _asyncToGenerator2.default)(function* (key, data) {
    yield _asyncStorage.default.setItem(key, JSON.stringify(data));
  });
  return function writeToStorage(_x6, _x7) {
    return _ref9.apply(this, arguments);
  };
}();
var _readFromStorage = exports.readFromStorage = function () {
  var _ref0 = (0, _asyncToGenerator2.default)(function* () {
    var key = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _timeConstants.STORAGE_CONFIG.KEY;
    var available = yield isStorageAvailable();
    if (!available) {
      return null;
    }
    try {
      var rawData = yield _asyncStorage.default.getItem(key);
      if (!rawData) {
        return null;
      }
      var parsedData = JSON.parse(rawData);
      var migratedData = migrateOldData(parsedData);
      if (!validateStorageStructure(parsedData)) {
        yield writeToStorage(key, migratedData.data);
      }
      return migratedData;
    } catch (error) {
      console.error(`Error reading from storage (${key}):`, error);
      if (key !== _timeConstants.STORAGE_CONFIG.BACKUP_KEY) {
        var backup = yield _readFromStorage(_timeConstants.STORAGE_CONFIG.BACKUP_KEY);
        if (backup) {
          console.info('Restored from backup');
          return backup;
        }
      }
      return null;
    }
  });
  return function readFromStorage() {
    return _ref0.apply(this, arguments);
  };
}();
var removeFromStorage = exports.removeFromStorage = function () {
  var _ref1 = (0, _asyncToGenerator2.default)(function* () {
    var key = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _timeConstants.STORAGE_CONFIG.KEY;
    var available = yield isStorageAvailable();
    if (!available) {
      return false;
    }
    try {
      yield _asyncStorage.default.removeItem(key);
      return true;
    } catch (error) {
      console.error(`Error removing from storage (${key}):`, error);
      return false;
    }
  });
  return function removeFromStorage() {
    return _ref1.apply(this, arguments);
  };
}();
var resetStorage = exports.resetStorage = function resetStorage() {
  return writeToStorage(_timeConstants.STORAGE_CONFIG.KEY, _timeConstants.DEFAULT_STATS);
};
var getStorageInfo = exports.getStorageInfo = function () {
  var _ref10 = (0, _asyncToGenerator2.default)(function* () {
    var available = yield isStorageAvailable();
    if (!available) {
      return {
        available: false
      };
    }
    var getLastModified = function getLastModified(data) {
      return data != null && data.lastModified ? new Date(data.lastModified) : null;
    };
    try {
      var data = yield _readFromStorage();
      var backupData = yield _asyncStorage.default.getItem(_timeConstants.STORAGE_CONFIG.BACKUP_KEY);
      var hasBackup = Boolean(backupData);
      var mainData = yield _asyncStorage.default.getItem(_timeConstants.STORAGE_CONFIG.KEY);
      return {
        available: true,
        hasData: Boolean(data),
        hasBackup: hasBackup,
        version: (data == null ? void 0 : data.version) || 'unknown',
        lastModified: getLastModified(data),
        dataSize: (mainData == null ? void 0 : mainData.length) || 0
      };
    } catch (error) {
      return {
        available: true,
        error: error.message
      };
    }
  });
  return function getStorageInfo() {
    return _ref10.apply(this, arguments);
  };
}();
var storageService = exports.storageService = {
  keys: {
    USER_PROGRESS: 'userProgress',
    USER_SETTINGS: 'userSettings',
    LAST_ACTIVITY: 'lastActivity',
    CURRENT_LEVEL: 'currentLevel',
    STREAK_DATA: 'streakData',
    COMPLETED_EXERCISES: 'completedExercises'
  },
  saveProgress: function saveProgress(progressData) {
    return storeData(storageService.keys.USER_PROGRESS, progressData);
  },
  getProgress: function getProgress() {
    return getData(storageService.keys.USER_PROGRESS);
  },
  saveSettings: function saveSettings(settings) {
    return storeData(storageService.keys.USER_SETTINGS, settings);
  },
  getSettings: function getSettings() {
    return getData(storageService.keys.USER_SETTINGS);
  },
  markExerciseCompleted: function () {
    var _markExerciseCompleted = (0, _asyncToGenerator2.default)(function* (exerciseId, level, score) {
      try {
        var completedExercises = (yield getData(storageService.keys.COMPLETED_EXERCISES)) || {};
        completedExercises[exerciseId] = {
          level: level,
          score: score,
          completedAt: new Date().toISOString()
        };
        yield storeData(storageService.keys.COMPLETED_EXERCISES, completedExercises);
        return true;
      } catch (error) {
        console.error('Error marking exercise completed:', error);
        return false;
      }
    });
    function markExerciseCompleted(_x8, _x9, _x0) {
      return _markExerciseCompleted.apply(this, arguments);
    }
    return markExerciseCompleted;
  }(),
  isExerciseCompleted: function () {
    var _isExerciseCompleted = (0, _asyncToGenerator2.default)(function* (exerciseId) {
      try {
        var completedExercises = (yield getData(storageService.keys.COMPLETED_EXERCISES)) || {};
        return Boolean(completedExercises[exerciseId]);
      } catch (error) {
        console.error('Error checking if exercise completed:', error);
        return false;
      }
    });
    function isExerciseCompleted(_x1) {
      return _isExerciseCompleted.apply(this, arguments);
    }
    return isExerciseCompleted;
  }(),
  updateStreak: function () {
    var _updateStreak = (0, _asyncToGenerator2.default)(function* () {
      try {
        var streakData = (yield getData(storageService.keys.STREAK_DATA)) || {
          currentStreak: 0,
          lastLoginDate: null,
          maxStreak: 0
        };
        var now = new Date();
        var today = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
        if (!streakData.lastLoginDate) {
          streakData.currentStreak = 1;
          streakData.maxStreak = 1;
          streakData.lastLoginDate = today;
        } else {
          var lastLogin = new Date(streakData.lastLoginDate).getTime();
          var oneDayMs = 24 * 60 * 60 * 1000;
          if (today - lastLogin === oneDayMs) {
            streakData.currentStreak += 1;
            streakData.maxStreak = Math.max(streakData.maxStreak, streakData.currentStreak);
            streakData.lastLoginDate = today;
          } else if (today === lastLogin) {} else {
            streakData.currentStreak = 1;
            streakData.lastLoginDate = today;
          }
        }
        yield storeData(storageService.keys.STREAK_DATA, streakData);
        return streakData;
      } catch (error) {
        console.error('Error updating streak:', error);
        return null;
      }
    });
    function updateStreak() {
      return _updateStreak.apply(this, arguments);
    }
    return updateStreak;
  }(),
  getStreak: function () {
    var _getStreak = (0, _asyncToGenerator2.default)(function* () {
      try {
        var streakData = (yield getData(storageService.keys.STREAK_DATA)) || {
          currentStreak: 0,
          lastLoginDate: null,
          maxStreak: 0
        };
        return streakData;
      } catch (error) {
        console.error('Error getting streak data:', error);
        return {
          currentStreak: 0,
          lastLoginDate: null,
          maxStreak: 0
        };
      }
    });
    function getStreak() {
      return _getStreak.apply(this, arguments);
    }
    return getStreak;
  }(),
  resetAllData: function resetAllData() {
    return clearAllData();
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXN5bmNTdG9yYWdlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfdGltZUNvbnN0YW50cyIsIl90aW1lVXRpbHMiLCJpc1N0b3JhZ2VBdmFpbGFibGUiLCJleHBvcnRzIiwiX3JlZiIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJ0ZXN0IiwiQXN5bmNTdG9yYWdlIiwic2V0SXRlbSIsInJlbW92ZUl0ZW0iLCJlIiwiY29uc29sZSIsIndhcm4iLCJtZXNzYWdlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJzdG9yZURhdGEiLCJfcmVmMiIsImtleSIsInZhbHVlIiwidW5kZWZpbmVkIiwianNvblZhbHVlIiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yIiwiX3giLCJfeDIiLCJnZXREYXRhIiwiX3JlZjMiLCJnZXRJdGVtIiwicGFyc2UiLCJfeDMiLCJyZW1vdmVEYXRhIiwiX3JlZjQiLCJfeDQiLCJnZXRNdWx0aXBsZURhdGEiLCJfcmVmNSIsImtleXMiLCJpdGVtcyIsIm11bHRpR2V0IiwicmVkdWNlIiwicmVzdWx0IiwiX3JlZjYiLCJfcmVmNyIsIl9zbGljZWRUb0FycmF5MiIsIl94NSIsImNsZWFyQWxsRGF0YSIsIl9yZWY4IiwiY2xlYXIiLCJ2YWxpZGF0ZVN0b3JhZ2VTdHJ1Y3R1cmUiLCJkYXRhIiwiaGFzVmVyc2lvbiIsInZlcnNpb24iLCJoYXNEYXRhIiwiaGFzVGltZXN0YW1wIiwibGFzdE1vZGlmaWVkIiwibWlncmF0ZU9sZERhdGEiLCJvbGREYXRhIiwibWlncmF0ZWREYXRhIiwiT2JqZWN0IiwiYXNzaWduIiwiREVGQVVMVF9TVEFUUyIsInZvY2FidWxhcnlfY2xhc3NpYyIsInZvY2FidWxhcnlfZmFzdCIsImNsYXNzaWNUaW1lIiwiZmFzdFRpbWUiLCJ2b2NhYnVsYXJ5IiwiZm9yRWFjaCIsImV4ZXJjaXNlVHlwZSIsIlNUT1JBR0VfQ09ORklHIiwiVkVSU0lPTiIsInNhbml0aXplVGltZVN0YXRzIiwiRGF0ZSIsIm5vdyIsIndyaXRlVG9TdG9yYWdlIiwiX3JlZjkiLCJfeDYiLCJfeDciLCJyZWFkRnJvbVN0b3JhZ2UiLCJfcmVmMCIsImxlbmd0aCIsIktFWSIsImF2YWlsYWJsZSIsInJhd0RhdGEiLCJwYXJzZWREYXRhIiwiQkFDS1VQX0tFWSIsImJhY2t1cCIsImluZm8iLCJyZW1vdmVGcm9tU3RvcmFnZSIsIl9yZWYxIiwicmVzZXRTdG9yYWdlIiwiZ2V0U3RvcmFnZUluZm8iLCJfcmVmMTAiLCJnZXRMYXN0TW9kaWZpZWQiLCJiYWNrdXBEYXRhIiwiaGFzQmFja3VwIiwiQm9vbGVhbiIsIm1haW5EYXRhIiwiZGF0YVNpemUiLCJzdG9yYWdlU2VydmljZSIsIlVTRVJfUFJPR1JFU1MiLCJVU0VSX1NFVFRJTkdTIiwiTEFTVF9BQ1RJVklUWSIsIkNVUlJFTlRfTEVWRUwiLCJTVFJFQUtfREFUQSIsIkNPTVBMRVRFRF9FWEVSQ0lTRVMiLCJzYXZlUHJvZ3Jlc3MiLCJwcm9ncmVzc0RhdGEiLCJnZXRQcm9ncmVzcyIsInNhdmVTZXR0aW5ncyIsInNldHRpbmdzIiwiZ2V0U2V0dGluZ3MiLCJtYXJrRXhlcmNpc2VDb21wbGV0ZWQiLCJfbWFya0V4ZXJjaXNlQ29tcGxldGVkIiwiZXhlcmNpc2VJZCIsImxldmVsIiwic2NvcmUiLCJjb21wbGV0ZWRFeGVyY2lzZXMiLCJjb21wbGV0ZWRBdCIsInRvSVNPU3RyaW5nIiwiX3g4IiwiX3g5IiwiX3gwIiwiaXNFeGVyY2lzZUNvbXBsZXRlZCIsIl9pc0V4ZXJjaXNlQ29tcGxldGVkIiwiX3gxIiwidXBkYXRlU3RyZWFrIiwiX3VwZGF0ZVN0cmVhayIsInN0cmVha0RhdGEiLCJjdXJyZW50U3RyZWFrIiwibGFzdExvZ2luRGF0ZSIsIm1heFN0cmVhayIsInRvZGF5IiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJnZXRUaW1lIiwibGFzdExvZ2luIiwib25lRGF5TXMiLCJNYXRoIiwibWF4IiwiZ2V0U3RyZWFrIiwiX2dldFN0cmVhayIsInJlc2V0QWxsRGF0YSJdLCJzb3VyY2VzIjpbInN0b3JhZ2VVdGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdXRpbHMvc3RvcmFnZVV0aWxzLmpzXHJcbi8qKlxyXG4gKiBVdGlsaXRhaXJlcyB1bmlmacOpcyBwb3VyIGxhIGdlc3Rpb24gZHUgc3RvY2thZ2UgQXN5bmNTdG9yYWdlXHJcbiAqIENvbWJpbmUgbG9naXF1ZSBtw6l0aWVyICsgdXRpbGl0YWlyZXMgZ8OpbsOpcmlxdWVzXHJcbiAqL1xyXG5cclxuaW1wb3J0IEFzeW5jU3RvcmFnZSBmcm9tICdAcmVhY3QtbmF0aXZlLWFzeW5jLXN0b3JhZ2UvYXN5bmMtc3RvcmFnZSc7XHJcbmltcG9ydCB7IFNUT1JBR0VfQ09ORklHLCBERUZBVUxUX1NUQVRTIH0gZnJvbSAnLi90aW1lQ29uc3RhbnRzLmpzJztcclxuaW1wb3J0IHsgc2FuaXRpemVUaW1lU3RhdHMgfSBmcm9tICcuL3RpbWVVdGlscy5qcyc7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09IFVUSUxJVEFJUkVTIEfDiU7DiVJJUVVFUyA9PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogVsOpcmlmaWUgc2kgQXN5bmNTdG9yYWdlIGVzdCBkaXNwb25pYmxlXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSBUcnVlIHNpIEFzeW5jU3RvcmFnZSBlc3QgZGlzcG9uaWJsZVxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGlzU3RvcmFnZUF2YWlsYWJsZSA9IGFzeW5jICgpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdGVzdCA9ICdfX3N0b3JhZ2VfdGVzdF9fJztcclxuICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKHRlc3QsIHRlc3QpO1xyXG4gICAgYXdhaXQgQXN5bmNTdG9yYWdlLnJlbW92ZUl0ZW0odGVzdCk7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGNhdGNoIChlKSB7XHJcbiAgICBjb25zb2xlLndhcm4oJ0FzeW5jU3RvcmFnZSBub3QgYXZhaWxhYmxlOicsIGUubWVzc2FnZSk7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFN0b2NrZXIgZGVzIGRvbm7DqWVzIGfDqW7DqXJpcXVlc1xyXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gQ2zDqSBkZSBzdG9ja2FnZVxyXG4gKiBAcGFyYW0ge2FueX0gdmFsdWUgLSBWYWxldXIgw6Agc3RvY2tlciAoc2VyYSBjb252ZXJ0aWUgZW4gSlNPTilcclxuICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IC0gdHJ1ZSBzaSBzdWNjw6hzLCBmYWxzZSBzaSBlcnJldXJcclxuICovXHJcbmV4cG9ydCBjb25zdCBzdG9yZURhdGEgPSBhc3luYyAoa2V5LCB2YWx1ZSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBTaSBsYSB2YWxldXIgZXN0IG51bGwvdW5kZWZpbmVkLCBvbiBzdXBwcmltZSBsYSBjbMOpIHBvdXIgw6l2aXRlciBsJ2VycmV1ciBBc3luY1N0b3JhZ2VcclxuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGpzb25WYWx1ZSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcclxuICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKGtleSwganNvblZhbHVlKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzdG9yaW5nIGRhdGE6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBSw6ljdXDDqXJlciBkZXMgZG9ubsOpZXMgZ8OpbsOpcmlxdWVzXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSBDbMOpIGRlIHN0b2NrYWdlXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59IC0gRG9ubsOpZXMgcsOpY3Vww6lyw6llcyBvdSBudWxsIHNpIG5vbiB0cm91dsOpL2VycmV1clxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGdldERhdGEgPSBhc3luYyAoa2V5KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGpzb25WYWx1ZSA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICByZXR1cm4ganNvblZhbHVlICE9IG51bGwgPyBKU09OLnBhcnNlKGpzb25WYWx1ZSkgOiBudWxsO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGRhdGE6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFN1cHByaW1lciBkZXMgZG9ubsOpZXNcclxuICogQHBhcmFtIHtzdHJpbmd9IGtleSAtIENsw6kgZGUgc3RvY2thZ2VcclxuICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IC0gdHJ1ZSBzaSBzdWNjw6hzLCBmYWxzZSBzaSBlcnJldXJcclxuICovXHJcbmV4cG9ydCBjb25zdCByZW1vdmVEYXRhID0gYXN5bmMgKGtleSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBBc3luY1N0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIGRhdGE6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBSw6ljdXDDqXJlciBwbHVzaWV1cnMgZG9ubsOpZXMgZGVwdWlzIEFzeW5jU3RvcmFnZVxyXG4gKiBAcGFyYW0ge0FycmF5PHN0cmluZz59IGtleXMgLSBUYWJsZWF1IGRlIGNsw6lzXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdD59IC0gT2JqZXQgYXZlYyBsZXMgY2zDqXMgZXQgbGVzIHZhbGV1cnNcclxuICovXHJcbmV4cG9ydCBjb25zdCBnZXRNdWx0aXBsZURhdGEgPSBhc3luYyAoa2V5cykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IEFzeW5jU3RvcmFnZS5tdWx0aUdldChrZXlzKTtcclxuICAgIHJldHVybiBpdGVtcy5yZWR1Y2UoKHJlc3VsdCwgW2tleSwgdmFsdWVdKSA9PiB7XHJcbiAgICAgIHJlc3VsdFtrZXldID0gdmFsdWUgIT0gbnVsbCA/IEpTT04ucGFyc2UodmFsdWUpIDogbnVsbDtcclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sIHt9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBtdWx0aXBsZSBkYXRhOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7fTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogRWZmYWNlciB0b3V0ZXMgbGVzIGRvbm7DqWVzIGRlIGwnYXBwbGljYXRpb25cclxuICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IC0gdHJ1ZSBzaSBzdWNjw6hzLCBmYWxzZSBzaSBlcnJldXJcclxuICovXHJcbmV4cG9ydCBjb25zdCBjbGVhckFsbERhdGEgPSBhc3luYyAoKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5jbGVhcigpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNsZWFyaW5nIGFsbCBkYXRhOicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn07XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09IExPR0lRVUUgTcOJVElFUiBTUMOJQ0lGSVFVRSA9PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogVmFsaWRlIGxhIHN0cnVjdHVyZSBkZXMgZG9ubsOpZXMgc3RvY2vDqWVzXHJcbiAqL1xyXG5jb25zdCB2YWxpZGF0ZVN0b3JhZ2VTdHJ1Y3R1cmUgPSAoZGF0YSkgPT4ge1xyXG4gIGlmICghZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHJldHVybiBmYWxzZTtcclxuICBcclxuICBjb25zdCBoYXNWZXJzaW9uID0gdHlwZW9mIGRhdGEudmVyc2lvbiA9PT0gJ3N0cmluZyc7XHJcbiAgY29uc3QgaGFzRGF0YSA9IHR5cGVvZiBkYXRhLmRhdGEgPT09ICdvYmplY3QnICYmIGRhdGEuZGF0YSAhPT0gbnVsbDtcclxuICBjb25zdCBoYXNUaW1lc3RhbXAgPSB0eXBlb2YgZGF0YS5sYXN0TW9kaWZpZWQgPT09ICdudW1iZXInO1xyXG4gIFxyXG4gIHJldHVybiBoYXNWZXJzaW9uICYmIGhhc0RhdGEgJiYgaGFzVGltZXN0YW1wO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIE1pZ3JlIGxlcyBhbmNpZW5uZXMgZG9ubsOpZXMgdmVycyBsZSBub3V2ZWF1IGZvcm1hdFxyXG4gKi9cclxuY29uc3QgbWlncmF0ZU9sZERhdGEgPSAob2xkRGF0YSkgPT4ge1xyXG4gIGlmICh2YWxpZGF0ZVN0b3JhZ2VTdHJ1Y3R1cmUob2xkRGF0YSkpIHtcclxuICAgIHJldHVybiBvbGREYXRhO1xyXG4gIH1cclxuICBcclxuICBjb25zdCBtaWdyYXRlZERhdGEgPSB7IC4uLkRFRkFVTFRfU1RBVFMgfTtcclxuICBcclxuICBpZiAob2xkRGF0YSAmJiB0eXBlb2Ygb2xkRGF0YSA9PT0gJ29iamVjdCcpIHtcclxuICAgIGlmIChvbGREYXRhLnZvY2FidWxhcnlfY2xhc3NpYyB8fCBvbGREYXRhLnZvY2FidWxhcnlfZmFzdCkge1xyXG4gICAgICBjb25zdCBjbGFzc2ljVGltZSA9IG9sZERhdGEudm9jYWJ1bGFyeV9jbGFzc2ljIHx8IDA7XHJcbiAgICAgIGNvbnN0IGZhc3RUaW1lID0gb2xkRGF0YS52b2NhYnVsYXJ5X2Zhc3QgfHwgMDtcclxuICAgICAgbWlncmF0ZWREYXRhLnZvY2FidWxhcnkgPSBjbGFzc2ljVGltZSArIGZhc3RUaW1lO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBPYmplY3Qua2V5cyhERUZBVUxUX1NUQVRTKS5mb3JFYWNoKGV4ZXJjaXNlVHlwZSA9PiB7XHJcbiAgICAgIGlmIChleGVyY2lzZVR5cGUgIT09ICd2b2NhYnVsYXJ5JyAmJiBvbGREYXRhW2V4ZXJjaXNlVHlwZV0pIHtcclxuICAgICAgICBtaWdyYXRlZERhdGFbZXhlcmNpc2VUeXBlXSA9IG9sZERhdGFbZXhlcmNpc2VUeXBlXTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB7XHJcbiAgICB2ZXJzaW9uOiBTVE9SQUdFX0NPTkZJRy5WRVJTSU9OLFxyXG4gICAgZGF0YTogc2FuaXRpemVUaW1lU3RhdHMobWlncmF0ZWREYXRhKSxcclxuICAgIGxhc3RNb2RpZmllZDogRGF0ZS5ub3coKVxyXG4gIH07XHJcbn07XHJcblxyXG4vKipcclxuICogw4ljcml0IGxlcyBkb25uw6llcyBhdmVjIHZhbGlkYXRpb25cclxuICovXHJcbmNvbnN0IHdyaXRlVG9TdG9yYWdlID0gYXN5bmMgKGtleSwgZGF0YSkgPT4ge1xyXG4gIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIExpdCBsZXMgZG9ubsOpZXMgYXZlYyB2YWxpZGF0aW9uIGV0IG1pZ3JhdGlvblxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHJlYWRGcm9tU3RvcmFnZSA9IGFzeW5jIChrZXkgPSBTVE9SQUdFX0NPTkZJRy5LRVkpID0+IHtcclxuICBjb25zdCBhdmFpbGFibGUgPSBhd2FpdCBpc1N0b3JhZ2VBdmFpbGFibGUoKTtcclxuICBpZiAoIWF2YWlsYWJsZSkge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByYXdEYXRhID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgIGlmICghcmF3RGF0YSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgcGFyc2VkRGF0YSA9IEpTT04ucGFyc2UocmF3RGF0YSk7XHJcbiAgICBjb25zdCBtaWdyYXRlZERhdGEgPSBtaWdyYXRlT2xkRGF0YShwYXJzZWREYXRhKTtcclxuICAgIFxyXG4gICAgaWYgKCF2YWxpZGF0ZVN0b3JhZ2VTdHJ1Y3R1cmUocGFyc2VkRGF0YSkpIHtcclxuICAgICAgYXdhaXQgd3JpdGVUb1N0b3JhZ2Uoa2V5LCBtaWdyYXRlZERhdGEuZGF0YSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBtaWdyYXRlZERhdGE7XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgcmVhZGluZyBmcm9tIHN0b3JhZ2UgKCR7a2V5fSk6YCwgZXJyb3IpO1xyXG4gICAgXHJcbiAgICBpZiAoa2V5ICE9PSBTVE9SQUdFX0NPTkZJRy5CQUNLVVBfS0VZKSB7XHJcbiAgICAgIGNvbnN0IGJhY2t1cCA9IGF3YWl0IHJlYWRGcm9tU3RvcmFnZShTVE9SQUdFX0NPTkZJRy5CQUNLVVBfS0VZKTtcclxuICAgICAgaWYgKGJhY2t1cCkge1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbygnUmVzdG9yZWQgZnJvbSBiYWNrdXAnKTtcclxuICAgICAgICByZXR1cm4gYmFja3VwO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBTdXBwcmltZSBsZXMgZG9ubsOpZXMgZHUgQXN5bmNTdG9yYWdlXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgcmVtb3ZlRnJvbVN0b3JhZ2UgPSBhc3luYyAoa2V5ID0gU1RPUkFHRV9DT05GSUcuS0VZKSA9PiB7XHJcbiAgY29uc3QgYXZhaWxhYmxlID0gYXdhaXQgaXNTdG9yYWdlQXZhaWxhYmxlKCk7XHJcbiAgaWYgKCFhdmFpbGFibGUpIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgcmVtb3ZpbmcgZnJvbSBzdG9yYWdlICgke2tleX0pOmAsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogUmVtZXQgbGVzIGRvbm7DqWVzIMOgIHrDqXJvXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgcmVzZXRTdG9yYWdlID0gKCkgPT4ge1xyXG4gIHJldHVybiB3cml0ZVRvU3RvcmFnZShTVE9SQUdFX0NPTkZJRy5LRVksIERFRkFVTFRfU1RBVFMpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIE9idGllbnQgbGVzIHN0YXRpc3RpcXVlcyBkZSBzdG9ja2FnZSBwb3VyIGRlYnVnXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgZ2V0U3RvcmFnZUluZm8gPSBhc3luYyAoKSA9PiB7XHJcbiAgY29uc3QgYXZhaWxhYmxlID0gYXdhaXQgaXNTdG9yYWdlQXZhaWxhYmxlKCk7XHJcbiAgaWYgKCFhdmFpbGFibGUpIHtcclxuICAgIHJldHVybiB7IGF2YWlsYWJsZTogZmFsc2UgfTtcclxuICB9XHJcbiAgXHJcbiAgLy8g4pyFIEV4dHJhY3Rpb24gZGUgbGEgbG9naXF1ZSBjb25kaXRpb25uZWxsZSBwb3VyIGFtw6lsaW9yZXIgbGEgbGlzaWJpbGl0w6lcclxuICBjb25zdCBnZXRMYXN0TW9kaWZpZWQgPSAoZGF0YSkgPT4ge1xyXG4gICAgcmV0dXJuIGRhdGE/Lmxhc3RNb2RpZmllZCA/IG5ldyBEYXRlKGRhdGEubGFzdE1vZGlmaWVkKSA6IG51bGw7XHJcbiAgfTtcclxuICBcclxuICB0cnkge1xyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlYWRGcm9tU3RvcmFnZSgpO1xyXG4gICAgY29uc3QgYmFja3VwRGF0YSA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKFNUT1JBR0VfQ09ORklHLkJBQ0tVUF9LRVkpO1xyXG4gICAgY29uc3QgaGFzQmFja3VwID0gQm9vbGVhbihiYWNrdXBEYXRhKTtcclxuICAgIGNvbnN0IG1haW5EYXRhID0gYXdhaXQgQXN5bmNTdG9yYWdlLmdldEl0ZW0oU1RPUkFHRV9DT05GSUcuS0VZKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYXZhaWxhYmxlOiB0cnVlLFxyXG4gICAgICBoYXNEYXRhOiBCb29sZWFuKGRhdGEpLFxyXG4gICAgICBoYXNCYWNrdXAsXHJcbiAgICAgIHZlcnNpb246IGRhdGE/LnZlcnNpb24gfHwgJ3Vua25vd24nLFxyXG4gICAgICBsYXN0TW9kaWZpZWQ6IGdldExhc3RNb2RpZmllZChkYXRhKSxcclxuICAgICAgZGF0YVNpemU6IG1haW5EYXRhPy5sZW5ndGggfHwgMFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYXZhaWxhYmxlOiB0cnVlLFxyXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxyXG4gICAgfTtcclxuICB9XHJcbn07XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09IFNFUlZJQ0UgTcOJVElFUiBQT1VSIEwnQVBQID09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBTZXJ2aWNlIGRlIHN0b2NrYWdlIHNww6ljaWZpcXVlIHBvdXIgbCdhcHBsaWNhdGlvblxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IHN0b3JhZ2VTZXJ2aWNlID0ge1xyXG4gIC8vIENsw6lzIGRlIHN0b2NrYWdlXHJcbiAga2V5czoge1xyXG4gICAgVVNFUl9QUk9HUkVTUzogJ3VzZXJQcm9ncmVzcycsXHJcbiAgICBVU0VSX1NFVFRJTkdTOiAndXNlclNldHRpbmdzJyxcclxuICAgIExBU1RfQUNUSVZJVFk6ICdsYXN0QWN0aXZpdHknLFxyXG4gICAgQ1VSUkVOVF9MRVZFTDogJ2N1cnJlbnRMZXZlbCcsXHJcbiAgICBTVFJFQUtfREFUQTogJ3N0cmVha0RhdGEnLFxyXG4gICAgQ09NUExFVEVEX0VYRVJDSVNFUzogJ2NvbXBsZXRlZEV4ZXJjaXNlcycsXHJcbiAgfSxcclxuXHJcbiAgLy8gU2F1dmVnYXJkZXIgbGEgcHJvZ3Jlc3Npb25cclxuICBzYXZlUHJvZ3Jlc3M6IChwcm9ncmVzc0RhdGEpID0+IHtcclxuICAgIHJldHVybiBzdG9yZURhdGEoc3RvcmFnZVNlcnZpY2Uua2V5cy5VU0VSX1BST0dSRVNTLCBwcm9ncmVzc0RhdGEpO1xyXG4gIH0sXHJcblxyXG4gIC8vIFLDqWN1cMOpcmVyIGxhIHByb2dyZXNzaW9uXHJcbiAgZ2V0UHJvZ3Jlc3M6ICgpID0+IHtcclxuICAgIHJldHVybiBnZXREYXRhKHN0b3JhZ2VTZXJ2aWNlLmtleXMuVVNFUl9QUk9HUkVTUyk7XHJcbiAgfSxcclxuXHJcbiAgLy8gU2F1dmVnYXJkZXIgbGVzIHBhcmFtw6h0cmVzXHJcbiAgc2F2ZVNldHRpbmdzOiAoc2V0dGluZ3MpID0+IHtcclxuICAgIHJldHVybiBzdG9yZURhdGEoc3RvcmFnZVNlcnZpY2Uua2V5cy5VU0VSX1NFVFRJTkdTLCBzZXR0aW5ncyk7XHJcbiAgfSxcclxuXHJcbiAgLy8gUsOpY3Vww6lyZXIgbGVzIHBhcmFtw6h0cmVzXHJcbiAgZ2V0U2V0dGluZ3M6ICgpID0+IHtcclxuICAgIHJldHVybiBnZXREYXRhKHN0b3JhZ2VTZXJ2aWNlLmtleXMuVVNFUl9TRVRUSU5HUyk7XHJcbiAgfSxcclxuXHJcbiAgLy8gTWFycXVlciB1biBleGVyY2ljZSBjb21tZSBjb21wbMOpdMOpXHJcbiAgbWFya0V4ZXJjaXNlQ29tcGxldGVkOiBhc3luYyAoZXhlcmNpc2VJZCwgbGV2ZWwsIHNjb3JlKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb21wbGV0ZWRFeGVyY2lzZXMgPSBhd2FpdCBnZXREYXRhKHN0b3JhZ2VTZXJ2aWNlLmtleXMuQ09NUExFVEVEX0VYRVJDSVNFUykgfHwge307XHJcblxyXG4gICAgICBjb21wbGV0ZWRFeGVyY2lzZXNbZXhlcmNpc2VJZF0gPSB7XHJcbiAgICAgICAgbGV2ZWwsXHJcbiAgICAgICAgc2NvcmUsXHJcbiAgICAgICAgY29tcGxldGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGF3YWl0IHN0b3JlRGF0YShzdG9yYWdlU2VydmljZS5rZXlzLkNPTVBMRVRFRF9FWEVSQ0lTRVMsIGNvbXBsZXRlZEV4ZXJjaXNlcyk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbWFya2luZyBleGVyY2lzZSBjb21wbGV0ZWQ6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgLy8gVsOpcmlmaWVyIHNpIHVuIGV4ZXJjaWNlIGEgw6l0w6kgY29tcGzDqXTDqVxyXG4gIGlzRXhlcmNpc2VDb21wbGV0ZWQ6IGFzeW5jIChleGVyY2lzZUlkKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb21wbGV0ZWRFeGVyY2lzZXMgPSBhd2FpdCBnZXREYXRhKHN0b3JhZ2VTZXJ2aWNlLmtleXMuQ09NUExFVEVEX0VYRVJDSVNFUykgfHwge307XHJcbiAgICAgIHJldHVybiBCb29sZWFuKGNvbXBsZXRlZEV4ZXJjaXNlc1tleGVyY2lzZUlkXSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjaGVja2luZyBpZiBleGVyY2lzZSBjb21wbGV0ZWQ6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgLy8gTWV0dHJlIMOgIGpvdXIgbGEgc3RyZWFrXHJcbiAgdXBkYXRlU3RyZWFrOiBhc3luYyAoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzdHJlYWtEYXRhID0gYXdhaXQgZ2V0RGF0YShzdG9yYWdlU2VydmljZS5rZXlzLlNUUkVBS19EQVRBKSB8fCB7XHJcbiAgICAgICAgY3VycmVudFN0cmVhazogMCxcclxuICAgICAgICBsYXN0TG9naW5EYXRlOiBudWxsLFxyXG4gICAgICAgIG1heFN0cmVhazogMCxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUobm93LmdldEZ1bGxZZWFyKCksIG5vdy5nZXRNb250aCgpLCBub3cuZ2V0RGF0ZSgpKS5nZXRUaW1lKCk7XHJcblxyXG4gICAgICBpZiAoIXN0cmVha0RhdGEubGFzdExvZ2luRGF0ZSkge1xyXG4gICAgICAgIHN0cmVha0RhdGEuY3VycmVudFN0cmVhayA9IDE7XHJcbiAgICAgICAgc3RyZWFrRGF0YS5tYXhTdHJlYWsgPSAxO1xyXG4gICAgICAgIHN0cmVha0RhdGEubGFzdExvZ2luRGF0ZSA9IHRvZGF5O1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IGxhc3RMb2dpbiA9IG5ldyBEYXRlKHN0cmVha0RhdGEubGFzdExvZ2luRGF0ZSkuZ2V0VGltZSgpO1xyXG4gICAgICAgIGNvbnN0IG9uZURheU1zID0gMjQgKiA2MCAqIDYwICogMTAwMDtcclxuXHJcbiAgICAgICAgaWYgKHRvZGF5IC0gbGFzdExvZ2luID09PSBvbmVEYXlNcykge1xyXG4gICAgICAgICAgc3RyZWFrRGF0YS5jdXJyZW50U3RyZWFrICs9IDE7XHJcbiAgICAgICAgICBzdHJlYWtEYXRhLm1heFN0cmVhayA9IE1hdGgubWF4KHN0cmVha0RhdGEubWF4U3RyZWFrLCBzdHJlYWtEYXRhLmN1cnJlbnRTdHJlYWspO1xyXG4gICAgICAgICAgc3RyZWFrRGF0YS5sYXN0TG9naW5EYXRlID0gdG9kYXk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0b2RheSA9PT0gbGFzdExvZ2luKSB7XHJcbiAgICAgICAgICAvLyBOZSByaWVuIGZhaXJlXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHN0cmVha0RhdGEuY3VycmVudFN0cmVhayA9IDE7XHJcbiAgICAgICAgICBzdHJlYWtEYXRhLmxhc3RMb2dpbkRhdGUgPSB0b2RheTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGF3YWl0IHN0b3JlRGF0YShzdG9yYWdlU2VydmljZS5rZXlzLlNUUkVBS19EQVRBLCBzdHJlYWtEYXRhKTtcclxuICAgICAgcmV0dXJuIHN0cmVha0RhdGE7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBzdHJlYWs6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICAvLyBSw6ljdXDDqXJlciBsZXMgZG9ubsOpZXMgZGUgc3RyZWFrXHJcbiAgZ2V0U3RyZWFrOiBhc3luYyAoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzdHJlYWtEYXRhID0gYXdhaXQgZ2V0RGF0YShzdG9yYWdlU2VydmljZS5rZXlzLlNUUkVBS19EQVRBKSB8fCB7XHJcbiAgICAgICAgY3VycmVudFN0cmVhazogMCxcclxuICAgICAgICBsYXN0TG9naW5EYXRlOiBudWxsLFxyXG4gICAgICAgIG1heFN0cmVhazogMCxcclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIHN0cmVha0RhdGE7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHN0cmVhayBkYXRhOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBjdXJyZW50U3RyZWFrOiAwLFxyXG4gICAgICAgIGxhc3RMb2dpbkRhdGU6IG51bGwsXHJcbiAgICAgICAgbWF4U3RyZWFrOiAwLFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIC8vIFLDqWluaXRpYWxpc2VyIHRvdXRlcyBsZXMgZG9ubsOpZXNcclxuICByZXNldEFsbERhdGE6ICgpID0+IHtcclxuICAgIHJldHVybiBjbGVhckFsbERhdGEoKTtcclxuICB9LFxyXG59OyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQU1BLElBQUFBLGFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLGNBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLFVBQUEsR0FBQUYsT0FBQTtBQVFPLElBQU1HLGtCQUFrQixHQUFBQyxPQUFBLENBQUFELGtCQUFBO0VBQUEsSUFBQUUsSUFBQSxPQUFBQyxrQkFBQSxDQUFBQyxPQUFBLEVBQUcsYUFBWTtJQUM1QyxJQUFJO01BQ0YsSUFBTUMsSUFBSSxHQUFHLGtCQUFrQjtNQUMvQixNQUFNQyxxQkFBWSxDQUFDQyxPQUFPLENBQUNGLElBQUksRUFBRUEsSUFBSSxDQUFDO01BQ3RDLE1BQU1DLHFCQUFZLENBQUNFLFVBQVUsQ0FBQ0gsSUFBSSxDQUFDO01BQ25DLE9BQU8sSUFBSTtJQUNiLENBQUMsQ0FBQyxPQUFPSSxDQUFDLEVBQUU7TUFDVkMsT0FBTyxDQUFDQyxJQUFJLENBQUMsNkJBQTZCLEVBQUVGLENBQUMsQ0FBQ0csT0FBTyxDQUFDO01BQ3RELE9BQU8sS0FBSztJQUNkO0VBQ0YsQ0FBQztFQUFBLGdCQVZZWixrQkFBa0JBLENBQUE7SUFBQSxPQUFBRSxJQUFBLENBQUFXLEtBQUEsT0FBQUMsU0FBQTtFQUFBO0FBQUEsR0FVOUI7QUFRTSxJQUFNQyxTQUFTLEdBQUFkLE9BQUEsQ0FBQWMsU0FBQTtFQUFBLElBQUFDLEtBQUEsT0FBQWIsa0JBQUEs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