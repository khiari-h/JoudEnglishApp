499052a4edb49b08bd9461ed45dcbb47
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.addChangeListener = addChangeListener;
exports.getColorScheme = getColorScheme;
exports.setColorScheme = setColorScheme;
var _NativeEventEmitter = _interopRequireDefault(require("../EventEmitter/NativeEventEmitter"));
var _EventEmitter = _interopRequireDefault(require("../vendor/emitter/EventEmitter"));
var _DebugEnvironment = require("./DebugEnvironment");
var _invariant = _interopRequireDefault(require("invariant"));
var lazyState;
function getState() {
  if (lazyState != null) {
    return lazyState;
  }
  var eventEmitter = new _EventEmitter.default();
  var NativeAppearance = require('./NativeAppearance').default;
  if (NativeAppearance == null) {
    lazyState = {
      NativeAppearance: null,
      appearance: null,
      eventEmitter: eventEmitter
    };
  } else {
    var state = {
      NativeAppearance: NativeAppearance,
      appearance: null,
      eventEmitter: eventEmitter
    };
    new _NativeEventEmitter.default(NativeAppearance).addListener('appearanceChanged', function (newAppearance) {
      state.appearance = {
        colorScheme: toColorScheme(newAppearance.colorScheme)
      };
      eventEmitter.emit('change', state.appearance);
    });
    lazyState = state;
  }
  return lazyState;
}
function getColorScheme() {
  if (__DEV__) {
    if (_DebugEnvironment.isAsyncDebugging) {
      return 'light';
    }
  }
  var colorScheme = null;
  var state = getState();
  var NativeAppearance = state.NativeAppearance;
  if (NativeAppearance != null) {
    if (state.appearance == null) {
      state.appearance = {
        colorScheme: toColorScheme(NativeAppearance.getColorScheme())
      };
    }
    colorScheme = state.appearance.colorScheme;
  }
  return colorScheme;
}
function setColorScheme(colorScheme) {
  var state = getState();
  var NativeAppearance = state.NativeAppearance;
  if (NativeAppearance != null) {
    NativeAppearance.setColorScheme(colorScheme != null ? colorScheme : 'unspecified');
    state.appearance = {
      colorScheme: toColorScheme(NativeAppearance.getColorScheme())
    };
  }
}
function addChangeListener(listener) {
  var _getState = getState(),
    eventEmitter = _getState.eventEmitter;
  return eventEmitter.addListener('change', listener);
}
function toColorScheme(colorScheme) {
  (0, _invariant.default)(colorScheme === 'dark' || colorScheme === 'light' || colorScheme == null, "Unrecognized color scheme. Did you mean 'dark', 'light' or null?");
  return colorScheme;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfTmF0aXZlRXZlbnRFbWl0dGVyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfRXZlbnRFbWl0dGVyIiwiX0RlYnVnRW52aXJvbm1lbnQiLCJfaW52YXJpYW50IiwibGF6eVN0YXRlIiwiZ2V0U3RhdGUiLCJldmVudEVtaXR0ZXIiLCJFdmVudEVtaXR0ZXIiLCJOYXRpdmVBcHBlYXJhbmNlIiwiZGVmYXVsdCIsImFwcGVhcmFuY2UiLCJzdGF0ZSIsIk5hdGl2ZUV2ZW50RW1pdHRlciIsImFkZExpc3RlbmVyIiwibmV3QXBwZWFyYW5jZSIsImNvbG9yU2NoZW1lIiwidG9Db2xvclNjaGVtZSIsImVtaXQiLCJnZXRDb2xvclNjaGVtZSIsIl9fREVWX18iLCJpc0FzeW5jRGVidWdnaW5nIiwic2V0Q29sb3JTY2hlbWUiLCJhZGRDaGFuZ2VMaXN0ZW5lciIsImxpc3RlbmVyIiwiX2dldFN0YXRlIiwiaW52YXJpYW50Il0sInNvdXJjZXMiOlsiQXBwZWFyYW5jZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZvcm1hdFxuICogQGZsb3cgc3RyaWN0LWxvY2FsXG4gKi9cblxuaW1wb3J0IHR5cGUge0V2ZW50U3Vic2NyaXB0aW9ufSBmcm9tICcuLi92ZW5kb3IvZW1pdHRlci9FdmVudEVtaXR0ZXInO1xuaW1wb3J0IHR5cGUge0FwcGVhcmFuY2VQcmVmZXJlbmNlcywgQ29sb3JTY2hlbWVOYW1lfSBmcm9tICcuL05hdGl2ZUFwcGVhcmFuY2UnO1xuaW1wb3J0IHR5cGVvZiBJTmF0aXZlQXBwZWFyYW5jZSBmcm9tICcuL05hdGl2ZUFwcGVhcmFuY2UnO1xuXG5pbXBvcnQgTmF0aXZlRXZlbnRFbWl0dGVyIGZyb20gJy4uL0V2ZW50RW1pdHRlci9OYXRpdmVFdmVudEVtaXR0ZXInO1xuaW1wb3J0IEV2ZW50RW1pdHRlciBmcm9tICcuLi92ZW5kb3IvZW1pdHRlci9FdmVudEVtaXR0ZXInO1xuaW1wb3J0IHtpc0FzeW5jRGVidWdnaW5nfSBmcm9tICcuL0RlYnVnRW52aXJvbm1lbnQnO1xuaW1wb3J0IGludmFyaWFudCBmcm9tICdpbnZhcmlhbnQnO1xuXG50eXBlIEFwcGVhcmFuY2UgPSB7XG4gIGNvbG9yU2NoZW1lOiA/Q29sb3JTY2hlbWVOYW1lLFxufTtcblxubGV0IGxhenlTdGF0ZTogP3tcbiAgK05hdGl2ZUFwcGVhcmFuY2U6IElOYXRpdmVBcHBlYXJhbmNlLFxuICAvLyBDYWNoZSB0aGUgY29sb3Igc2NoZW1lIHRvIHJlZHVjZSB0aGUgY29zdCBvZiByZWFkaW5nIGl0IGJldHdlZW4gY2hhbmdlcy5cbiAgLy8gTk9URTogSWYgYE5hdGl2ZUFwcGVhcmFuY2VgIGlzIG51bGwsIHRoaXMgd2lsbCBhbHdheXMgYmUgbnVsbC5cbiAgYXBwZWFyYW5jZTogP0FwcGVhcmFuY2UsXG4gIC8vIE5PVEU6IFRoaXMgaXMgbm9uLW51bGxhYmxlIHRvIG1ha2UgaXQgZWFzaWVyIGZvciBgb25DaGFuZ2VkTGlzdGVuZXJgIHRvXG4gIC8vIHJldHVybiBhIG5vbi1udWxsYWJsZSBgRXZlbnRTdWJzY3JpcHRpb25gIHZhbHVlLiBUaGlzIGlzIG5vdCB0aGUgY29tbW9uXG4gIC8vIHBhdGgsIHNvIHdlIGRvIG5vdCBoYXZlIHRvIG92ZXItb3B0aW1pemUgaXQuXG4gICtldmVudEVtaXR0ZXI6IEV2ZW50RW1pdHRlcjx7Y2hhbmdlOiBbQXBwZWFyYW5jZV19Pixcbn07XG5cbi8qKlxuICogRW5zdXJlcyB0aGF0IGFsbCBzdGF0ZSBhbmQgbGlzdGVuZXJzIGFyZSBsYXppbHkgaW5pdGlhbGl6ZWQgY29ycmVjdGx5LlxuICovXG5mdW5jdGlvbiBnZXRTdGF0ZSgpOiAkTm9uTWF5YmVUeXBlPHR5cGVvZiBsYXp5U3RhdGU+IHtcbiAgaWYgKGxhenlTdGF0ZSAhPSBudWxsKSB7XG4gICAgcmV0dXJuIGxhenlTdGF0ZTtcbiAgfVxuICBjb25zdCBldmVudEVtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyPHtjaGFuZ2U6IFtBcHBlYXJhbmNlXX0+KCk7XG4gIC8vIE5PVEU6IEF2b2lkIGluaXRpYWxpemluZyBgTmF0aXZlQXBwZWFyYW5jZWAgdW50aWwgaXQgaXMgYWN0dWFsbHkgdXNlZC5cbiAgY29uc3QgTmF0aXZlQXBwZWFyYW5jZSA9IHJlcXVpcmUoJy4vTmF0aXZlQXBwZWFyYW5jZScpLmRlZmF1bHQ7XG4gIGlmIChOYXRpdmVBcHBlYXJhbmNlID09IG51bGwpIHtcbiAgICAvLyBBc3NpZ24gYG51bGxgIHRvIGF2b2lkIHJlLWluaXRpYWxpemluZyBvbiBzdWJzZXF1ZW50IGludm9jYXRpb25zLlxuICAgIGxhenlTdGF0ZSA9IHtcbiAgICAgIE5hdGl2ZUFwcGVhcmFuY2U6IG51bGwsXG4gICAgICBhcHBlYXJhbmNlOiBudWxsLFxuICAgICAgZXZlbnRFbWl0dGVyLFxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgY29uc3Qgc3RhdGU6ICROb25NYXliZVR5cGU8dHlwZW9mIGxhenlTdGF0ZT4gPSB7XG4gICAgICBOYXRpdmVBcHBlYXJhbmNlLFxuICAgICAgYXBwZWFyYW5jZTogbnVsbCxcbiAgICAgIGV2ZW50RW1pdHRlcixcbiAgICB9O1xuICAgIG5ldyBOYXRpdmVFdmVudEVtaXR0ZXI8e1xuICAgICAgYXBwZWFyYW5jZUNoYW5nZWQ6IFtBcHBlYXJhbmNlUHJlZmVyZW5jZXNdLFxuICAgIH0+KE5hdGl2ZUFwcGVhcmFuY2UpLmFkZExpc3RlbmVyKCdhcHBlYXJhbmNlQ2hhbmdlZCcsIG5ld0FwcGVhcmFuY2UgPT4ge1xuICAgICAgc3RhdGUuYXBwZWFyYW5jZSA9IHtcbiAgICAgICAgY29sb3JTY2hlbWU6IHRvQ29sb3JTY2hlbWUobmV3QXBwZWFyYW5jZS5jb2xvclNjaGVtZSksXG4gICAgICB9O1xuICAgICAgZXZlbnRFbWl0dGVyLmVtaXQoJ2NoYW5nZScsIHN0YXRlLmFwcGVhcmFuY2UpO1xuICAgIH0pO1xuICAgIGxhenlTdGF0ZSA9IHN0YXRlO1xuICB9XG4gIHJldHVybiBsYXp5U3RhdGU7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgY3VycmVudCBjb2xvciBzY2hlbWUgcHJlZmVyZW5jZS4gVGhpcyB2YWx1ZSBtYXkgY2hhbmdlLCBzbyB0aGVcbiAqIHZhbHVlIHNob3VsZCBub3QgYmUgY2FjaGVkIHdpdGhvdXQgZWl0aGVyIGxpc3RlbmluZyB0byBjaGFuZ2VzIG9yIHVzaW5nXG4gKiB0aGUgYHVzZUNvbG9yU2NoZW1lYCBob29rLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29sb3JTY2hlbWUoKTogP0NvbG9yU2NoZW1lTmFtZSB7XG4gIGlmIChfX0RFVl9fKSB7XG4gICAgaWYgKGlzQXN5bmNEZWJ1Z2dpbmcpIHtcbiAgICAgIC8vIEhhcmQgY29kZSBsaWdodCB0aGVtZSB3aGVuIHVzaW5nIHRoZSBhc3luYyBkZWJ1Z2dlciBhc1xuICAgICAgLy8gc3luYyBjYWxscyBhcmVuJ3Qgc3VwcG9ydGVkXG4gICAgICByZXR1cm4gJ2xpZ2h0JztcbiAgICB9XG4gIH1cbiAgbGV0IGNvbG9yU2NoZW1lID0gbnVsbDtcbiAgY29uc3Qgc3RhdGUgPSBnZXRTdGF0ZSgpO1xuICBjb25zdCB7TmF0aXZlQXBwZWFyYW5jZX0gPSBzdGF0ZTtcbiAgaWYgKE5hdGl2ZUFwcGVhcmFuY2UgIT0gbnVsbCkge1xuICAgIGlmIChzdGF0ZS5hcHBlYXJhbmNlID09IG51bGwpIHtcbiAgICAgIC8vIExhemlseSBpbml0aWFsaXplIGBzdGF0ZS5hcHBlYXJhbmNlYC4gVGhpcyBzaG91bGQgb25seVxuICAgICAgLy8gaGFwcGVuIG9uY2UgYmVjYXVzZSB3ZSBuZXZlciByZWFzc2lnbiBhIG51bGwgdmFsdWUgdG8gaXQuXG4gICAgICBzdGF0ZS5hcHBlYXJhbmNlID0ge1xuICAgICAgICBjb2xvclNjaGVtZTogdG9Db2xvclNjaGVtZShOYXRpdmVBcHBlYXJhbmNlLmdldENvbG9yU2NoZW1lKCkpLFxuICAgICAgfTtcbiAgICB9XG4gICAgY29sb3JTY2hlbWUgPSBzdGF0ZS5hcHBlYXJhbmNlLmNvbG9yU2NoZW1lO1xuICB9XG4gIHJldHVybiBjb2xvclNjaGVtZTtcbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSBjdXJyZW50IGNvbG9yIHNjaGVtZSB0byB0aGUgc3VwcGxpZWQgdmFsdWUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRDb2xvclNjaGVtZShjb2xvclNjaGVtZTogP0NvbG9yU2NoZW1lTmFtZSk6IHZvaWQge1xuICBjb25zdCBzdGF0ZSA9IGdldFN0YXRlKCk7XG4gIGNvbnN0IHtOYXRpdmVBcHBlYXJhbmNlfSA9IHN0YXRlO1xuICBpZiAoTmF0aXZlQXBwZWFyYW5jZSAhPSBudWxsKSB7XG4gICAgTmF0aXZlQXBwZWFyYW5jZS5zZXRDb2xvclNjaGVtZShjb2xvclNjaGVtZSA/PyAndW5zcGVjaWZpZWQnKTtcbiAgICBzdGF0ZS5hcHBlYXJhbmNlID0ge1xuICAgICAgY29sb3JTY2hlbWU6IHRvQ29sb3JTY2hlbWUoTmF0aXZlQXBwZWFyYW5jZS5nZXRDb2xvclNjaGVtZSgpKSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogQWRkIGFuIGV2ZW50IGhhbmRsZXIgdGhhdCBpcyBmaXJlZCB3aGVuIGFwcGVhcmFuY2UgcHJlZmVyZW5jZXMgY2hhbmdlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkQ2hhbmdlTGlzdGVuZXIoXG4gIGxpc3RlbmVyOiAoe2NvbG9yU2NoZW1lOiA/Q29sb3JTY2hlbWVOYW1lfSkgPT4gdm9pZCxcbik6IEV2ZW50U3Vic2NyaXB0aW9uIHtcbiAgY29uc3Qge2V2ZW50RW1pdHRlcn0gPSBnZXRTdGF0ZSgpO1xuICByZXR1cm4gZXZlbnRFbWl0dGVyLmFkZExpc3RlbmVyKCdjaGFuZ2UnLCBsaXN0ZW5lcik7XG59XG5cbi8qKlxuICogVE9ETzogKGhyYW1vcykgVDUyOTE5NjUyIFVzZSA/Q29sb3JTY2hlbWVOYW1lIG9uY2UgY29kZWdlbiBzdXBwb3J0cyB1bmlvblxuICovXG5mdW5jdGlvbiB0b0NvbG9yU2NoZW1lKGNvbG9yU2NoZW1lOiA/c3RyaW5nKTogP0NvbG9yU2NoZW1lTmFtZSB7XG4gIGludmFyaWFudChcbiAgICBjb2xvclNjaGVtZSA9PT0gJ2RhcmsnIHx8IGNvbG9yU2NoZW1lID09PSAnbGlnaHQnIHx8IGNvbG9yU2NoZW1lID09IG51bGwsXG4gICAgXCJVbnJlY29nbml6ZWQgY29sb3Igc2NoZW1lLiBEaWQgeW91IG1lYW4gJ2RhcmsnLCAnbGlnaHQnIG9yIG51bGw/XCIsXG4gICk7XG4gIHJldHVybiBjb2xvclNjaGVtZTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQWNBLElBQUFBLG1CQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxhQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxpQkFBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsVUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBTUEsSUFBSUksU0FTSDtBQUtELFNBQVNDLFFBQVFBLENBQUEsRUFBb0M7RUFDbkQsSUFBSUQsU0FBUyxJQUFJLElBQUksRUFBRTtJQUNyQixPQUFPQSxTQUFTO0VBQ2xCO0VBQ0EsSUFBTUUsWUFBWSxHQUFHLElBQUlDLHFCQUFZLENBQXlCLENBQUM7RUFFL0QsSUFBTUMsZ0JBQWdCLEdBQUdSLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDUyxPQUFPO0VBQzlELElBQUlELGdCQUFnQixJQUFJLElBQUksRUFBRTtJQUU1QkosU0FBUyxHQUFHO01BQ1ZJLGdCQUFnQixFQUFFLElBQUk7TUFDdEJFLFVBQVUsRUFBRSxJQUFJO01BQ2hCSixZQUFZLEVBQVpBO0lBQ0YsQ0FBQztFQUNILENBQUMsTUFBTTtJQUNMLElBQU1L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