{"version":3,"names":["_getJestObj","mock","__esModule","default","jest","fn","Object","assign","requireActual","useNavigation","goBack","router","push","props","mockGrammarNavigation","_require","require","View","_jsxRuntime","jsx","testID","_interopRequireDefault","_asyncToGenerator2","_react","_reactNative","_grammar","_require2","mockUseGrammar","describe","mockRoute","params","level","beforeEach","clearAllMocks","it","mockReturnValue","loaded","grammarData","render","route","expect","screen","getByTestId","toBeTruthy","title","exercises","type","question","ruleIndex","exerciseIndex","currentRule","content","currentExercise","options","answer","completedExercises","showDetailedProgress","canCheckAnswer","isFirstExercise","isLastExercise","showFeedback","attempts","getAllByText","length","toBeGreaterThan","findByText","changeRule","fireEvent","press","getByText","toHaveBeenCalledWith","submitAnswer","lastCallProps","calls","onCheckAnswer","toHaveBeenCalled"],"sources":["GrammarExercise.test.js"],"sourcesContent":["import React from 'react';\nimport { render, fireEvent, screen } from '@testing-library/react-native';\nimport GrammarExercise from '../../../../src/screens/exercises/grammar';\n\n// Mock des dépendances\njest.mock('../../../../src/screens/exercises/grammar/hooks/useGrammar', () => ({\n  __esModule: true,\n  default: jest.fn(),\n}));\n\njest.mock('@react-navigation/native', () => ({\n  ...jest.requireActual('@react-navigation/native'),\n  useNavigation: () => ({\n    goBack: jest.fn(),\n  }),\n}));\n\njest.mock('expo-router', () => ({\n  router: {\n    push: jest.fn(),\n  },\n}));\n\n// Mock ciblé de GrammarNavigation pour espionner les props\nconst mockGrammarNavigation = jest.fn();\njest.mock('../../../../src/screens/exercises/grammar/GrammarNavigation', () => (props) => {\n  // On stocke les props pour pouvoir les inspecter dans le test\n  mockGrammarNavigation(props);\n  // On rend un composant simple avec le testID pour le retrouver\n  const { View } = require('react-native');\n  return <View testID=\"mock-grammar-navigation\" />;\n});\n\n\nconst mockUseGrammar = require('../../../../src/screens/exercises/grammar/hooks/useGrammar').default;\n\ndescribe('GrammarExercise', () => {\n  const mockRoute = {\n    params: {\n      level: 'A1',\n    },\n  };\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it('should render loading state initially', () => {\n    mockUseGrammar.mockReturnValue({\n      loaded: false,\n      grammarData: [],\n    });\n\n    render(<GrammarExercise route={mockRoute} />);\n    expect(screen.getByTestId('activity-indicator')).toBeTruthy();\n  });\n\n  it('should render the main components when loaded', async () => {\n    mockUseGrammar.mockReturnValue({\n      loaded: true,\n      grammarData: [{ title: 'Le verbe \\'être\\' (to be)', exercises: [{ type: 'fillInTheBlank', question: 'I ___ a student.' }] }],\n      ruleIndex: 0,\n      exerciseIndex: 0,\n      currentRule: { title: 'Le verbe \\'être\\' (to be)', content: 'Content 1' },\n      currentExercise: { type: 'fillInTheBlank', question: 'I ___ a student.', options: ['am', 'is', 'are'], answer: 'am' },\n      completedExercises: {},\n      showDetailedProgress: false,\n      canCheckAnswer: true,\n      isFirstExercise: true,\n      isLastExercise: false,\n      showFeedback: false,\n      attempts: 0,\n    });\n\n    render(<GrammarExercise route={mockRoute} />);\n\n    expect(screen.getAllByText('Le verbe \\'être\\' (to be)').length).toBeGreaterThan(0);\n    const question = await screen.findByText('I ___ a student.');\n    expect(question).toBeTruthy();\n  });\n\n  it('should call changeRule when a rule is selected', () => {\n    const changeRule = jest.fn();\n    mockUseGrammar.mockReturnValue({\n      loaded: true,\n      grammarData: [{ title: 'Le verbe \\'être\\' (to be)' }, { title: 'Le présent simple' }],\n      ruleIndex: 0,\n      completedExercises: {},\n      changeRule,\n      currentExercise: { type: 'fillInTheBlank', question: 'Question', options: ['a','b']}\n    });\n\n    render(<GrammarExercise route={mockRoute} />);\n    fireEvent.press(screen.getByText('Le présent simple'));\n    expect(changeRule).toHaveBeenCalledWith(1);\n  });\n\n  it('should call submitAnswer when check answer is triggered', () => {\n    const submitAnswer = jest.fn();\n    mockUseGrammar.mockReturnValue({\n      loaded: true,\n      grammarData: [{ title: 'Le verbe \\'être\\' (to be)' }],\n      currentExercise: { type: 'fillInTheBlank', question: 'I ___ a student.', options: ['am', 'is', 'are'], answer: 'am' },\n      canCheckAnswer: true,\n      completedExercises: {},\n      submitAnswer,\n      showFeedback: false,\n      // ...tous les autres états nécessaires pour le rendu\n      ruleIndex: 0,\n      exerciseIndex: 0,\n      currentRule: { title: 'Le verbe \\'être\\' (to be)', content: 'Content 1' },\n    });\n\n    render(<GrammarExercise route={mockRoute} />);\n    \n    // On récupère la dernière version des props passées à notre mock\n    const lastCallProps = mockGrammarNavigation.mock.calls[mockGrammarNavigation.mock.calls.length - 1][0];\n    \n    // On appelle la fonction directement\n    lastCallProps.onCheckAnswer();\n\n    expect(submitAnswer).toHaveBeenCalled();\n  });\n});\n"],"mappings":"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","ignoreList":[]}