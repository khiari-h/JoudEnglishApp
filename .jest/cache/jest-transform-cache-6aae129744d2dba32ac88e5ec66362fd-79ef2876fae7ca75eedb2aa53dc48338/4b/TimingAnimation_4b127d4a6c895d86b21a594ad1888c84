1268cb7ff71b7515e99aa256d5ef912a
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _readOnlyError2 = _interopRequireDefault(require("@babel/runtime/helpers/readOnlyError"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));
var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));
var _get2 = _interopRequireDefault(require("@babel/runtime/helpers/get"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _NativeAnimatedHelper = _interopRequireDefault(require("../../../src/private/animated/NativeAnimatedHelper"));
var _AnimatedColor = _interopRequireDefault(require("../nodes/AnimatedColor"));
var _Animation2 = _interopRequireDefault(require("./Animation"));
function _callSuper(t, o, e) { return o = (0, _getPrototypeOf2.default)(o), (0, _possibleConstructorReturn2.default)(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], (0, _getPrototypeOf2.default)(t).constructor) : o.apply(t, e)); }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _superPropGet(t, o, e, r) { var p = (0, _get2.default)((0, _getPrototypeOf2.default)(1 & r ? t.prototype : t), o, e); return 2 & r && "function" == typeof p ? function (t) { return p.apply(e, t); } : p; }
var _easeInOut;
function easeInOut() {
  if (!_easeInOut) {
    var Easing = require('../Easing').default;
    _easeInOut = Easing.inOut(Easing.ease);
  }
  return _easeInOut;
}
var TimingAnimation = exports.default = function (_Animation) {
  function TimingAnimation(config) {
    var _config$easing, _config$duration, _config$delay, _config$iterations, _config$isInteraction;
    var _this;
    (0, _classCallCheck2.default)(this, TimingAnimation);
    _this = _callSuper(this, TimingAnimation);
    _this._toValue = config.toValue;
    _this._easing = (_config$easing = config.easing) != null ? _config$easing : easeInOut();
    _this._duration = (_config$duration = config.duration) != null ? _config$duration : 500;
    _this._delay = (_config$delay = config.delay) != null ? _config$delay : 0;
    _this.__iterations = (_config$iterations = config.iterations) != null ? _config$iterations : 1;
    _this._useNativeDriver = _NativeAnimatedHelper.default.shouldUseNativeDriver(config);
    _this._platformConfig = config.platformConfig;
    _this.__isInteraction = (_config$isInteraction = config.isInteraction) != null ? _config$isInteraction : !_this._useNativeDriver;
    _this.__isLooping = config.isLooping;
    return _this;
  }
  (0, _inherits2.default)(TimingAnimation, _Animation);
  return (0, _createClass2.default)(TimingAnimation, [{
    key: "__getNativeAnimationConfig",
    value: function __getNativeAnimationConfig() {
      var frameDuration = 1000.0 / 60.0;
      var frames = [];
      var numFrames = Math.round(this._duration / frameDuration);
      for (var frame = 0; frame < numFrames; frame++) {
        frames.push(this._easing(frame / numFrames));
      }
      frames.push(this._easing(1));
      return {
        type: 'frames',
        frames: frames,
        toValue: this._toValue,
        iterations: this.__iterations,
        platformConfig: this._platformConfig
      };
    }
  }, {
    key: "start",
    value: function start(fromValue, onUpdate, onEnd, previousAnimation, animatedValue) {
      var _this2 = this;
      this.__active = true;
      this._fromValue = fromValue;
      this._onUpdate = onUpdate;
      this.__onEnd = onEnd;
      var start = function start() {
        if (!_this2._useNativeDriver && animatedValue.__isNative === true) {
          throw new Error('Attempting to run JS driven animation on animated node ' + 'that has been moved to "native" earlier by starting an ' + 'animation with `useNativeDriver: true`');
        }
        if (_this2._duration === 0 && !_this2._useNativeDriver) {
          _this2._onUpdate(_this2._toValue);
          _this2.__debouncedOnEnd({
            finished: true
          });
        } else {
          _this2._startTime = Date.now();
          if (_this2._useNativeDriver) {
            _this2.__startNativeAnimation(animatedValue);
          } else {
            _this2._animationFrame = requestAnimationFrame(_this2.onUpdate.bind(_this2));
          }
        }
      };
      if (this._delay) {
        this._timeout = setTimeout(start, this._delay);
      } else {
        start();
      }
    }
  }, {
    key: "onUpdate",
    value: function onUpdate() {
      var now = Date.now();
      if (now >= this._startTime + this._duration) {
        if (this._duration === 0) {
          this._onUpdate(this._toValue);
        } else {
          this._onUpdate(this._fromValue + this._easing(1) * (this._toValue - this._fromValue));
        }
        this.__debouncedOnEnd({
          finished: true
        });
        return;
      }
      this._onUpdate(this._fromValue + this._easing((now - this._startTime) / this._duration) * (this._toValue - this._fromValue));
      if (this.__active) {
        this._animationFrame = requestAnimationFrame(this.onUpdate.bind(this));
      }
    }
  }, {
    key: "stop",
    value: function stop() {
      _superPropGet(TimingAnimation, "stop", this, 3)([]);
      this.__active = false;
      clearTimeout(this._timeout);
      global.cancelAnimationFrame(this._animationFrame);
      this.__debouncedOnEnd({
        finished: false
      });
    }
  }]);
}(_Animation2.default);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiZGVmYXVsdCIsIl9yZWFkT25seUVycm9yMiIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yIiwiX2dldFByb3RvdHlwZU9mMiIsIl9nZXQyIiwiX2luaGVyaXRzMiIsIl9OYXRpdmVBbmltYXRlZEhlbHBlciIsIl9BbmltYXRlZENvbG9yIiwiX0FuaW1hdGlvbjIiLCJfY2FsbFN1cGVyIiwidCIsIm8iLCJlIiwiX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCIsIlJlZmxlY3QiLCJjb25zdHJ1Y3QiLCJjb25zdHJ1Y3RvciIsImFwcGx5IiwiQm9vbGVhbiIsInByb3RvdHlwZSIsInZhbHVlT2YiLCJjYWxsIiwiX3N1cGVyUHJvcEdldCIsInIiLCJwIiwiX2Vhc2VJbk91dCIsImVhc2VJbk91dCIsIkVhc2luZyIsImluT3V0IiwiZWFzZSIsIlRpbWluZ0FuaW1hdGlvbiIsIl9BbmltYXRpb24iLCJjb25maWciLCJfY29uZmlnJGVhc2luZyIsIl9jb25maWckZHVyYXRpb24iLCJfY29uZmlnJGRlbGF5IiwiX2NvbmZpZyRpdGVyYXRpb25zIiwiX2NvbmZpZyRpc0ludGVyYWN0aW9uIiwiX3RoaXMiLCJfdG9WYWx1ZSIsInRvVmFsdWUiLCJfZWFzaW5nIiwiZWFzaW5nIiwiX2R1cmF0aW9uIiwiZHVyYXRpb24iLCJfZGVsYXkiLCJkZWxheSIsIl9faXRlcmF0aW9ucyIsIml0ZXJhdGlvbnMiLCJfdXNlTmF0aXZlRHJpdmVyIiwiTmF0aXZlQW5pbWF0ZWRIZWxwZXIiLCJzaG91bGRVc2VOYXRpdmVEcml2ZXIiLCJfcGxhdGZvcm1Db25maWciLCJwbGF0Zm9ybUNvbmZpZyIsIl9faXNJbnRlcmFjdGlvbiIsImlzSW50ZXJhY3Rpb24iLCJfX2lzTG9vcGluZyIsImlzTG9vcGluZyIsImtleSIsIl9fZ2V0TmF0aXZlQW5pbWF0aW9uQ29uZmlnIiwiZnJhbWVEdXJhdGlvbiIsImZyYW1lcyIsIm51bUZyYW1lcyIsIk1hdGgiLCJyb3VuZCIsImZyYW1lIiwicHVzaCIsInR5cGUiLCJzdGFydCIsImZyb21WYWx1ZSIsIm9uVXBkYXRlIiwib25FbmQiLCJwcmV2aW91c0FuaW1hdGlvbiIsImFuaW1hdGVkVmFsdWUiLCJfdGhpczIiLCJfX2FjdGl2ZSIsIl9mcm9tVmFsdWUiLCJfb25VcGRhdGUiLCJfX29uRW5kIiwiX19pc05hdGl2ZSIsIkVycm9yIiwiX19kZWJvdW5jZWRPbkVuZCIsImZpbmlzaGVkIiwiX3N0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJfX3N0YXJ0TmF0aXZlQW5pbWF0aW9uIiwiX2FuaW1hdGlvbkZyYW1lIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYmluZCIsIl90aW1lb3V0Iiwic2V0VGltZW91dCIsInN0b3AiLCJjbGVhclRpbWVvdXQiLCJnbG9iYWwiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsIkFuaW1hdGlvbiJdLCJzb3VyY2VzIjpbIlRpbWluZ0FuaW1hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3dcbiAqIEBmb3JtYXRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB0eXBlIHtQbGF0Zm9ybUNvbmZpZ30gZnJvbSAnLi4vQW5pbWF0ZWRQbGF0Zm9ybUNvbmZpZyc7XG5pbXBvcnQgdHlwZSB7UmdiYVZhbHVlfSBmcm9tICcuLi9ub2Rlcy9BbmltYXRlZENvbG9yJztcbmltcG9ydCB0eXBlIEFuaW1hdGVkSW50ZXJwb2xhdGlvbiBmcm9tICcuLi9ub2Rlcy9BbmltYXRlZEludGVycG9sYXRpb24nO1xuaW1wb3J0IHR5cGUgQW5pbWF0ZWRWYWx1ZSBmcm9tICcuLi9ub2Rlcy9BbmltYXRlZFZhbHVlJztcbmltcG9ydCB0eXBlIEFuaW1hdGVkVmFsdWVYWSBmcm9tICcuLi9ub2Rlcy9BbmltYXRlZFZhbHVlWFknO1xuaW1wb3J0IHR5cGUge0FuaW1hdGlvbkNvbmZpZywgRW5kQ2FsbGJhY2t9IGZyb20gJy4vQW5pbWF0aW9uJztcblxuaW1wb3J0IE5hdGl2ZUFuaW1hdGVkSGVscGVyIGZyb20gJy4uLy4uLy4uL3NyYy9wcml2YXRlL2FuaW1hdGVkL05hdGl2ZUFuaW1hdGVkSGVscGVyJztcbmltcG9ydCBBbmltYXRlZENvbG9yIGZyb20gJy4uL25vZGVzL0FuaW1hdGVkQ29sb3InO1xuaW1wb3J0IEFuaW1hdGlvbiBmcm9tICcuL0FuaW1hdGlvbic7XG5cbmV4cG9ydCB0eXBlIFRpbWluZ0FuaW1hdGlvbkNvbmZpZyA9ICRSZWFkT25seTx7XG4gIC4uLkFuaW1hdGlvbkNvbmZpZyxcbiAgdG9WYWx1ZTpcbiAgICB8IG51bWJlclxuICAgIHwgQW5pbWF0ZWRWYWx1ZVxuICAgIHwge1xuICAgICAgICB4OiBudW1iZXIsXG4gICAgICAgIHk6IG51bWJlcixcbiAgICAgICAgLi4uXG4gICAgICB9XG4gICAgfCBBbmltYXRlZFZhbHVlWFlcbiAgICB8IFJnYmFWYWx1ZVxuICAgIHwgQW5pbWF0ZWRDb2xvclxuICAgIHwgQW5pbWF0ZWRJbnRlcnBvbGF0aW9uPG51bWJlcj4sXG4gIGVhc2luZz86ICh2YWx1ZTogbnVtYmVyKSA9PiBudW1iZXIsXG4gIGR1cmF0aW9uPzogbnVtYmVyLFxuICBkZWxheT86IG51bWJlcixcbn0+O1xuXG5leHBvcnQgdHlwZSBUaW1pbmdBbmltYXRpb25Db25maWdTaW5nbGUgPSAkUmVhZE9ubHk8e1xuICAuLi5BbmltYXRpb25Db25maWcsXG4gIHRvVmFsdWU6IG51bWJlcixcbiAgZWFzaW5nPzogKHZhbHVlOiBudW1iZXIpID0+IG51bWJlcixcbiAgZHVyYXRpb24/OiBudW1iZXIsXG4gIGRlbGF5PzogbnVtYmVyLFxufT47XG5cbmxldCBfZWFzZUluT3V0O1xuZnVuY3Rpb24gZWFzZUluT3V0KCkge1xuICBpZiAoIV9lYXNlSW5PdXQpIHtcbiAgICBjb25zdCBFYXNpbmcgPSByZXF1aXJlKCcuLi9FYXNpbmcnKS5kZWZhdWx0O1xuICAgIF9lYXNlSW5PdXQgPSBFYXNpbmcuaW5PdXQoRWFzaW5nLmVhc2UpO1xuICB9XG4gIHJldHVybiBfZWFzZUluT3V0O1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUaW1pbmdBbmltYXRpb24gZXh0ZW5kcyBBbmltYXRpb24ge1xuICBfc3RhcnRUaW1lOiBudW1iZXI7XG4gIF9mcm9tVmFsdWU6IG51bWJlcjtcbiAgX3RvVmFsdWU6IG51bWJlcjtcbiAgX2R1cmF0aW9uOiBudW1iZXI7XG4gIF9kZWxheTogbnVtYmVyO1xuICBfZWFzaW5nOiAodmFsdWU6IG51bWJlcikgPT4gbnVtYmVyO1xuICBfb25VcGRhdGU6ICh2YWx1ZTogbnVtYmVyKSA9PiB2b2lkO1xuICBfYW5pbWF0aW9uRnJhbWU6IGFueTtcbiAgX3RpbWVvdXQ6IGFueTtcbiAgX3VzZU5hdGl2ZURyaXZlcjogYm9vbGVhbjtcbiAgX3BsYXRmb3JtQ29uZmlnOiA/UGxhdGZvcm1Db25maWc7XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBUaW1pbmdBbmltYXRpb25Db25maWdTaW5nbGUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX3RvVmFsdWUgPSBjb25maWcudG9WYWx1ZTtcbiAgICB0aGlzLl9lYXNpbmcgPSBjb25maWcuZWFzaW5nID8/IGVhc2VJbk91dCgpO1xuICAgIHRoaXMuX2R1cmF0aW9uID0gY29uZmlnLmR1cmF0aW9uID8/IDUwMDtcbiAgICB0aGlzLl9kZWxheSA9IGNvbmZpZy5kZWxheSA/PyAwO1xuICAgIHRoaXMuX19pdGVyYXRpb25zID0gY29uZmlnLml0ZXJhdGlvbnMgPz8gMTtcbiAgICB0aGlzLl91c2VOYXRpdmVEcml2ZXIgPSBOYXRpdmVBbmltYXRlZEhlbHBlci5zaG91bGRVc2VOYXRpdmVEcml2ZXIoY29uZmlnKTtcbiAgICB0aGlzLl9wbGF0Zm9ybUNvbmZpZyA9IGNvbmZpZy5wbGF0Zm9ybUNvbmZpZztcbiAgICB0aGlzLl9faXNJbnRlcmFjdGlvbiA9IGNvbmZpZy5pc0ludGVyYWN0aW9uID8/ICF0aGlzLl91c2VOYXRpdmVEcml2ZXI7XG4gICAgdGhpcy5fX2lzTG9vcGluZyA9IGNvbmZpZy5pc0xvb3Bpbmc7XG4gIH1cblxuICBfX2dldE5hdGl2ZUFuaW1hdGlvbkNvbmZpZygpOiBhbnkge1xuICAgIGNvbnN0IGZyYW1lRHVyYXRpb24gPSAxMDAwLjAgLyA2MC4wO1xuICAgIGNvbnN0IGZyYW1lcyA9IFtdO1xuICAgIGNvbnN0IG51bUZyYW1lcyA9IE1hdGgucm91bmQodGhpcy5fZHVyYXRpb24gLyBmcmFtZUR1cmF0aW9uKTtcbiAgICBmb3IgKGxldCBmcmFtZSA9IDA7IGZyYW1lIDwgbnVtRnJhbWVzOyBmcmFtZSsrKSB7XG4gICAgICBmcmFtZXMucHVzaCh0aGlzLl9lYXNpbmcoZnJhbWUgLyBudW1GcmFtZXMpKTtcbiAgICB9XG4gICAgZnJhbWVzLnB1c2godGhpcy5fZWFzaW5nKDEpKTtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ2ZyYW1lcycsXG4gICAgICBmcmFtZXMsXG4gICAgICB0b1ZhbHVlOiB0aGlzLl90b1ZhbHVlLFxuICAgICAgaXRlcmF0aW9uczogdGhpcy5fX2l0ZXJhdGlvbnMsXG4gICAgICBwbGF0Zm9ybUNvbmZpZzogdGhpcy5fcGxhdGZvcm1Db25maWcsXG4gICAgfTtcbiAgfVxuXG4gIHN0YXJ0KFxuICAgIGZyb21WYWx1ZTogbnVtYmVyLFxuICAgIG9uVXBkYXRlOiAodmFsdWU6IG51bWJlcikgPT4gdm9pZCxcbiAgICBvbkVuZDogP0VuZENhbGxiYWNrLFxuICAgIHByZXZpb3VzQW5pbWF0aW9uOiA/QW5pbWF0aW9uLFxuICAgIGFuaW1hdGVkVmFsdWU6IEFuaW1hdGVkVmFsdWUsXG4gICk6IHZvaWQge1xuICAgIHRoaXMuX19hY3RpdmUgPSB0cnVlO1xuICAgIHRoaXMuX2Zyb21WYWx1ZSA9IGZyb21WYWx1ZTtcbiAgICB0aGlzLl9vblVwZGF0ZSA9IG9uVXBkYXRlO1xuICAgIHRoaXMuX19vbkVuZCA9IG9uRW5kO1xuXG4gICAgY29uc3Qgc3RhcnQgPSAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuX3VzZU5hdGl2ZURyaXZlciAmJiBhbmltYXRlZFZhbHVlLl9faXNOYXRpdmUgPT09IHRydWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICdBdHRlbXB0aW5nIHRvIHJ1biBKUyBkcml2ZW4gYW5pbWF0aW9uIG9uIGFuaW1hdGVkIG5vZGUgJyArXG4gICAgICAgICAgICAndGhhdCBoYXMgYmVlbiBtb3ZlZCB0byBcIm5hdGl2ZVwiIGVhcmxpZXIgYnkgc3RhcnRpbmcgYW4gJyArXG4gICAgICAgICAgICAnYW5pbWF0aW9uIHdpdGggYHVzZU5hdGl2ZURyaXZlcjogdHJ1ZWAnLFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICAvLyBBbmltYXRpb25zIHRoYXQgc29tZXRpbWVzIGhhdmUgMCBkdXJhdGlvbiBhbmQgc29tZXRpbWVzIGRvIG5vdFxuICAgICAgLy8gc3RpbGwgbmVlZCB0byB1c2UgdGhlIG5hdGl2ZSBkcml2ZXIgd2hlbiBkdXJhdGlvbiBpcyAwIHNvIGFzIHRvXG4gICAgICAvLyBub3QgY2F1c2UgaW50ZXJtaXhlZCBKUyBhbmQgbmF0aXZlIGFuaW1hdGlvbnMuXG4gICAgICBpZiAodGhpcy5fZHVyYXRpb24gPT09IDAgJiYgIXRoaXMuX3VzZU5hdGl2ZURyaXZlcikge1xuICAgICAgICB0aGlzLl9vblVwZGF0ZSh0aGlzLl90b1ZhbHVlKTtcbiAgICAgICAgdGhpcy5fX2RlYm91bmNlZE9uRW5kKHtmaW5pc2hlZDogdHJ1ZX0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgaWYgKHRoaXMuX3VzZU5hdGl2ZURyaXZlcikge1xuICAgICAgICAgIHRoaXMuX19zdGFydE5hdGl2ZUFuaW1hdGlvbihhbmltYXRlZFZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLl9hbmltYXRpb25GcmFtZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShcbiAgICAgICAgICAgIC8vICRGbG93Rml4TWVbbWV0aG9kLXVuYmluZGluZ10gYWRkZWQgd2hlbiBpbXByb3ZpbmcgdHlwaW5nIGZvciB0aGlzIHBhcmFtZXRlcnNcbiAgICAgICAgICAgIHRoaXMub25VcGRhdGUuYmluZCh0aGlzKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICBpZiAodGhpcy5fZGVsYXkpIHtcbiAgICAgIHRoaXMuX3RpbWVvdXQgPSBzZXRUaW1lb3V0KHN0YXJ0LCB0aGlzLl9kZWxheSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXJ0KCk7XG4gICAgfVxuICB9XG5cbiAgb25VcGRhdGUoKTogdm9pZCB7XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBpZiAobm93ID49IHRoaXMuX3N0YXJ0VGltZSArIHRoaXMuX2R1cmF0aW9uKSB7XG4gICAgICBpZiAodGhpcy5fZHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgdGhpcy5fb25VcGRhdGUodGhpcy5fdG9WYWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9vblVwZGF0ZShcbiAgICAgICAgICB0aGlzLl9mcm9tVmFsdWUgKyB0aGlzLl9lYXNpbmcoMSkgKiAodGhpcy5fdG9WYWx1ZSAtIHRoaXMuX2Zyb21WYWx1ZSksXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aGlzLl9fZGVib3VuY2VkT25FbmQoe2ZpbmlzaGVkOiB0cnVlfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fb25VcGRhdGUoXG4gICAgICB0aGlzLl9mcm9tVmFsdWUgK1xuICAgICAgICB0aGlzLl9lYXNpbmcoKG5vdyAtIHRoaXMuX3N0YXJ0VGltZSkgLyB0aGlzLl9kdXJhdGlvbikgKlxuICAgICAgICAgICh0aGlzLl90b1ZhbHVlIC0gdGhpcy5fZnJvbVZhbHVlKSxcbiAgICApO1xuICAgIGlmICh0aGlzLl9fYWN0aXZlKSB7XG4gICAgICAvLyAkRmxvd0ZpeE1lW21ldGhvZC11bmJpbmRpbmddIGFkZGVkIHdoZW4gaW1wcm92aW5nIHR5cGluZyBmb3IgdGhpcyBwYXJhbWV0ZXJzXG4gICAgICB0aGlzLl9hbmltYXRpb25GcmFtZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLm9uVXBkYXRlLmJpbmQodGhpcykpO1xuICAgIH1cbiAgfVxuXG4gIHN0b3AoKTogdm9pZCB7XG4gICAgc3VwZXIuc3RvcCgpO1xuICAgIHRoaXMuX19hY3RpdmUgPSBmYWxzZTtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dCk7XG4gICAgZ2xvYmFsLmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuX2FuaW1hdGlvbkZyYW1lKTtcbiAgICB0aGlzLl9fZGVib3VuY2VkT25FbmQoe2ZpbmlzaGVkOiBmYWxzZX0pO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQVVBLFlBQVk7O0FBQUMsSUFBQUEsc0JBQUEsR0FBQUMsT0FBQTtBQUFBQyxNQUFBLENBQUFDLGNBQUEsQ0FBQUMsT0FBQTtFQUFBQyxLQUFBO0FBQUE7QUFBQUQsT0FBQSxDQUFBRSxPQUFBO0FBQUEsSUFBQUMsZUFBQSxHQUFBUCxzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUFBQU8sZ0JBQUEsR0FBQVIsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFRLGFBQUEsR0FBQVQsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFTLDJCQUFBLEdBQUFWLHNCQUFBLENBQUFDLE9BQUE7QUFBQSxJ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